"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"])}(),angular.module("app").run(["$templateCache",function(t){t.put("drCell/drCell.html",'<div class="cell" ng-class="c.returnCellClass()">\n\t<div class="cell__fig"></div>\n</div>\n'),t.put("drField/drField.html","<ul class=\"cell-list\"ng-style=\"{'width': cf.size*60 + 'px', 'height': cf.size*60 + 'px'}\">\n\t<li class=\"cell-list__item\"\n\t\tng-repeat=\"(idx, cell) in cf.cells track by cell.id\"\n\t\tng-style=\"{'left': cell.col*60 + 'px', 'top': cell.row*60 + 'px'}\"\n\t\tng-click=\"cf.cellCLick($event, cell, idx)\">\n\n\t\t<dr-cell type=\"{{cell.type}}\" state=\"{{cell.state}}\"></dr-cell>\n\n\t</li>\n</ul>")}]),function(){function t(t,e,l,i,r,n,a){this.$scope=t,this.$http=e,this.$state=l,this.drFieldService=a,this.points=a.points,this.drFiledFactory=n,this.cellState="square",this.init()}angular.module("app").controller("mainCtrl",t),t.prototype.init=function(){},t.prototype.newGame=function(t,e){t.preventDefault(),t.stopPropagation(),this.drFiledFactory.size=e,this.drFieldService.createNewArr(e),this.drFieldService.reset()},t.$inject=["$scope","$http","$state","$stateParams","$timeout","drFiledFactory","drFieldService"]}();var _createClass=function(){function t(t,e){for(var l=0;l<e.length;l++){var i=e[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,l,i){return l&&t(e.prototype,l),i&&t(e,i),e}}();!function(){angular.module("app").directive("drCell",["$templateCache",function(e){function l(t,e,l,i){}return{link:l,restrict:"AEC",scope:{},template:e.get("drCell/drCell.html"),controller:t,controllerAs:"c",bindToController:{type:"@?",state:"@?"}}}]);var t=function(){function t(e,l){_classCallCheck(this,t)}return _createClass(t,[{key:"returnCellClass",value:function(){var t="cell_type-"+(this.type||"square"),e="cell_state-"+(this.state||"default");return[t,e]}}]),t}();t.$inject=["$scope","$timeout"]}();var _createClass=function(){function t(t,e){for(var l=0;l<e.length;l++){var i=e[l];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,l,i){return l&&t(e.prototype,l),i&&t(e,i),e}}();!function(){angular.module("app").directive("drField",["$templateCache",function(e){function l(t,e,l,i){}return{link:l,restrict:"AEC",scope:{},template:e.get("drField/drField.html"),controller:t,controllerAs:"cf",bindToController:{cellClick:"=?",size:"=?",ctx:"=?"}}}]);var t=function(){function t(e,l,i,r){_classCallCheck(this,t),this.drFieldService=e,this.drFiledFactory=l,this.size&&(this.drFiledFactory.size=this.size),this.$scope=i,this.$timeout=r,this.init()}return _createClass(t,[{key:"init",value:function(){this.cells=this.drFieldService.createNewArr(this.size)}},{key:"cellCLick",value:function(t,e,l){if(t.preventDefault(),t.stopPropagation(),"default"===e.state){for(var i=0;i<this.cells.length;i+=1)this.cells[i].state="default";this.activeCell=e,this.activeCell.state="active",this.activeCellIdx=l,this.drFieldService.markClosestCell(l,"passive")}else if("passive"===e.state){this.drFieldService.replaceElements(this.activeCellIdx,l);for(var r=0;r<this.cells.length;r+=1)this.cells[r].state="default";this.$timeout(function(){},200)}else"active"===e.state&&(e.state="default",this.activeCell=void 0,this.activeCellIdx=void 0,this.drFieldService.markClosestCell(l,"default"))}}]),t}();t.$inject=["drFieldService","drFiledFactory","$scope","$timeout"]}(),function(){angular.module("app").service("drFieldService",["drFiledFactory","$timeout",function(t,e){function l(t){var e=Math.floor(Math.random()*t.length);return t[e]}function i(e){for(var i=angular.copy(t.types),r=0;r<e.length;r+=1)for(var n=0;n<i.length;n+=1)e[r]===i[n]&&i.splice(n,1);return l(i)}function r(){for(var t=0;t<v.length;t+=1)v[t].col=t%d.size,v[t].row=Math.floor(t/d.size)}function n(e){var r=a(e),n=r.length?i(r):l(t.types);return n}function a(t){var e=d.size,l=[],i=v.length%e;i>1&&v[v.length-2].type===v[v.length-1].type&&l.push(v[v.length-1].type);var r=Math.floor(v.length/e);return r>1&&v[v.length-e].type===v[v.length-2*e].type&&l.push(v[v.length-e].type),t-Math.floor(t/e)*e>1&&v[t-1]&&v[t-2]&&v[t-1].type===v[t-2].type&&l.push(v[t-1].type),Math.ceil(t/e)*e-t>1&&v[t+1]&&v[t+2]&&v[t+1].type===v[t+2].type&&l.push(v[t+1].type),Math.ceil(t/e)>2&&v[t-e]&&v[t-2*e]&&v[t-e].type===v[t-2*e].type&&l.push(v[t-e].type),e-Math.ceil(t/e)>2&&v[t+e]&&v[t+2*e]&&v[t+e].type===v[t+2*e].type&&l.push(v[t+e].type),t-Math.floor(t/e)*e>0&&Math.ceil(t/e)*e-t>0&&v[t-1]&&v[t+1]&&v[t-1].type===v[t+1].type&&l.push(v[t-1].type),Math.ceil(t/e)>1&&e-Math.ceil(t/e)>1&&v[t-e]&&v[t+e]&&v[t-e].type===v[t+e].type&&l.push(v[t-e].type),l}function s(t){for(var e=d.size,l=0;l<v.length;l+=e){for(var i=[l],r=v[l].type,n=1;n<e;n+=1)if("empty"!==v[l+n].type&&r===v[l+n].type)i.push(l+n);else{if(i.length>2)break;i.length=0,i.push(l+n),r=v[l+n].type}i.length>2&&t.push({length:i.length,type:r,idxArr:angular.copy(i)}),i.length=0}}function o(t){for(var e=d.size,l=0;l<e;l+=1){for(var i=[l],r=v[l].type,n=1;n<e;n+=1)if("empty"!==v[l+n*e].type&&r===v[l+n*e].type)i.push(l+n*e);else{if(i.length>2)break;i.length=0,i.push(l+n*e),r=v[l+n*e].type}i.length>2&&t.push({length:i.length,type:r,idxArr:angular.copy(i)}),i.length=0}}function c(){for(var t=0;t<v.length;t+=1)"empty"===v[t].type&&(v[t].type=n(t))}function p(){var t=[];return s(t),o(t),!!t.length&&(u(t),d.deleteElements(t),d.moveTopEl(),v.sort(f),void p())}function u(e){d.points.lastDel.length=0;for(var l=0;l<e.length;l+=1){var i=e[l].type,r=t.pointsMap[i]*e[l].length;d.points.lastPoints=r,d.points.allPoints+=r,d.points.lastDel.push(e[l].length+" "+i)}}function h(e,l){for(var i=t.size,r=Math.floor(e/i),n=0,a=e;n<l;n+=1)v[a].row-=r,a+=i;for(var s=0,o=e;s<r;s+=1)o-=i,v[o].row+=l}function f(t,e){return t.row!==e.row?t.row-e.row:t.row===e.row?t.col-e.col:void 0}var d=this;this.matrixModel=[];var v=this.matrixModel;this.points={lastDel:[],lastPoints:0,allPoints:0},this.reset=function(){this.points.lastDel.length=0,this.points.lastPoints=0,this.points.allPoints=0},this.createNewArr=function(e){v.length=0,this.size=e||t.size;for(var l=0;l<e*e;l++){var i=n();v.push({id:l,type:i,state:"default"})}return r(),v},this.markClosestCell=function(t,e){var l=d.size;v[t-l]&&(v[t-l].state=e),v[t+l]&&(v[t+l].state=e),v[t-1]&&(v[t-1].state=e),v[t+1]&&(v[t+1].state=e)},this.replaceElements=function(t,e){var l={col1:v[t].col,row1:v[t].row,col2:v[e].col,row2:v[e].row};v[t].col=l.col2,v[t].row=l.row2,v[e].col=l.col1,v[e].row=l.row1,v.sort(f),p(),c(),p()},this.deleteElements=function(t){for(var e=0;e<t.length;e+=1){for(var l=t[e],i=0;i<l.idxArr.length;i+=1)v[l.idxArr[i]].type="empty";for(var r=0;r<v.length;r+=1)v[r].state="default"}},this.moveTopEl=function(){for(var e,l=t.size,i=0,r=0,n=0;r<v.length;r+=1){r>0&&r%l===0&&(e=void 0,n=0,i++);var a=r%l*l+i;"empty"===v[a].type&&(e||(e=a),n++),r>0&&(r+1)%l===0&&n>0&&h(e,n)}}}])}(),function(){angular.module("app").factory("drFiledFactory",function(){var t=["square","circle","triangle"],e=["default","active","passive","note"],l={square:10,triangle:20,circle:30},i=9;return{types:t,states:e,size:i,pointsMap:l}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsIiRzdGF0ZSIsIiRzdGF0ZVBhcmFtcyIsIiR0aW1lb3V0IiwiZHJGaWxlZEZhY3RvcnkiLCJkckZpZWxkU2VydmljZSIsInRoaXMiLCJwb2ludHMiLCJjZWxsU3RhdGUiLCJpbml0IiwiY29udHJvbGxlciIsInByb3RvdHlwZSIsIm5ld0dhbWUiLCJlIiwic2l6ZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiY3JlYXRlTmV3QXJyIiwicmVzZXQiLCIkaW5qZWN0IiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsImRpcmVjdGl2ZSIsImRyQ2VsbExpbmsiLCIkZWxlbWVudCIsIiRhdHRycyIsImxpbmsiLCJyZXN0cmljdCIsInNjb3BlIiwidGVtcGxhdGUiLCJnZXQiLCJkckNlbGxDdHJsIiwiY29udHJvbGxlckFzIiwiYmluZFRvQ29udHJvbGxlciIsInR5cGUiLCJzdGF0ZSIsInZhbHVlIiwiZHJGaWVsZExpbmsiLCJkckZpZWxkQ3RybCIsImNlbGxDbGljayIsImN0eCIsImNlbGxzIiwiY2VsbCIsImlkeCIsImFjdGl2ZUNlbGwiLCJhY3RpdmVDZWxsSWR4IiwibWFya0Nsb3Nlc3RDZWxsIiwicmVwbGFjZUVsZW1lbnRzIiwiX2kiLCJ1bmRlZmluZWQiLCJzZXJ2aWNlIiwicmV0dXJuUmFuZEVsZW1lbnQiLCJhcnIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyZXR1cm5Bbm90aGVyVHlwZSIsInJlcGVhdFR5cGVzIiwibmV3QXJyIiwiY29weSIsInR5cGVzIiwiaiIsInNwbGljZSIsInNldENvb3Jkc1RvRWxlbWVudHMiLCJfbW0iLCJjb2wiLCJfc2VsZiIsInJvdyIsInJldHVyblR5cGVGb3JOZXdFbGVtZW50IiwiY2hlY2tEdXBlIiwicyIsInJlc3VsdCIsImNvbElkeCIsInB1c2giLCJyb3dJZHgiLCJjZWlsIiwiY291bnRSZXBlYXRJblJvdyIsImRlbElkeEFyciIsImN1cnJlbnRUeXBlIiwiaWR4QXJyIiwiY291bnRSZXBlYXRJbkNvbCIsImdlbmVyYXRlTmV3RWwiLCJyZWN1ckRlbGV0ZUVsIiwiY2FsY3VsYXRlUG9pbnRzSW5mbyIsImRlbGV0ZUVsZW1lbnRzIiwibW92ZVRvcEVsIiwic29ydCIsInNvcnRBcnJCeVJvd0NvbCIsImxhc3REZWwiLCJwb2ludHNNYXAiLCJsYXN0UG9pbnRzIiwiYWxsUG9pbnRzIiwibW92ZUVsZW1lbnRzIiwiZW1wdHlTdGFydElkeCIsImVtcHR5Q291bnQiLCJjb3VudE9mTW92YWJsZUVsIiwiYyIsIl9jIiwiYSIsImIiLCJtYXRyaXhNb2RlbCIsImlkIiwiaWR4MSIsImlkeDIiLCJ0ZW1wIiwiY29sMSIsInJvdzEiLCJjb2wyIiwicm93MiIsImRlbEFyciIsImxpbmUiLCJfaiIsImNvdW50IiwiZmFjdG9yeSIsInN0YXRlcyIsInNxdWFyZSIsInRyaWFuZ2xlIiwiY2lyY2xlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQWdEQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FpRGhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHNDQS9GaEgsV0FDQ0MsUUFBUUMsT0FBTyxPQUFRLFlBQWEsYUFBYyxhQUFjLGlCQUlqRUQsUUFBUUMs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LCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nQW5pbWF0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnLCAndWkucm91dGVyJ10pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZHJDZWxsL2RyQ2VsbC5odG1sJywgJzxkaXYgY2xhc3M9XCJjZWxsXCIgbmctY2xhc3M9XCJjLnJldHVybkNlbGxDbGFzcygpXCI+XFxuXFx0PGRpdiBjbGFzcz1cImNlbGxfX2ZpZ1wiPjwvZGl2PlxcbjwvZGl2PlxcbicpO1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2RyRmllbGQvZHJGaWVsZC5odG1sJywgJzx1bCBjbGFzcz1cImNlbGwtbGlzdFwibmctc3R5bGU9XCJ7XFwnd2lkdGhcXCc6IGNmLnNpemUqNjAgKyBcXCdweFxcJywgXFwnaGVpZ2h0XFwnOiBjZi5zaXplKjYwICsgXFwncHhcXCd9XCI+XFxuXFx0PGxpIGNsYXNzPVwiY2VsbC1saXN0X19pdGVtXCJcXG5cXHRcXHRuZy1yZXBlYXQ9XCIoaWR4LCBjZWxsKSBpbiBjZi5jZWxscyB0cmFjayBieSBjZWxsLmlkXCJcXG5cXHRcXHRuZy1zdHlsZT1cIntcXCdsZWZ0XFwnOiBjZWxsLmNvbCo2MCArIFxcJ3B4XFwnLCBcXCd0b3BcXCc6IGNlbGwucm93KjYwICsgXFwncHhcXCd9XCJcXG5cXHRcXHRuZy1jbGljaz1cImNmLmNlbGxDTGljaygkZXZlbnQsIGNlbGwsIGlkeClcIj5cXG5cXG5cXHRcXHQ8ZHItY2VsbCB0eXBlPVwie3tjZWxsLnR5cGV9fVwiIHN0YXRlPVwie3tjZWxsLnN0YXRlfX1cIj48L2RyLWNlbGw+XFxuXFxuXFx0PC9saT5cXG48L3VsPicpO1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgbWFpbkN0cmwpO1xuXG5cdGZ1bmN0aW9uIG1haW5DdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkdGltZW91dCwgZHJGaWxlZEZhY3RvcnksIGRyRmllbGRTZXJ2aWNlKSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuXG5cdFx0dGhpcy5kckZpZWxkU2VydmljZSA9IGRyRmllbGRTZXJ2aWNlO1xuXHRcdHRoaXMucG9pbnRzID0gZHJGaWVsZFNlcnZpY2UucG9pbnRzO1xuXHRcdHRoaXMuZHJGaWxlZEZhY3RvcnkgPSBkckZpbGVkRmFjdG9yeTtcblxuXHRcdHRoaXMuY2VsbFN0YXRlID0gJ3NxdWFyZSc7XG5cblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdG1haW5DdHJsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge307XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLm5ld0dhbWUgPSBmdW5jdGlvbiAoZSwgc2l6ZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdHRoaXMuZHJGaWxlZEZhY3Rvcnkuc2l6ZSA9IHNpemU7XG5cdFx0dGhpcy5kckZpZWxkU2VydmljZS5jcmVhdGVOZXdBcnIoc2l6ZSk7XG5cdFx0dGhpcy5kckZpZWxkU2VydmljZS5yZXNldCgpO1xuXHR9O1xuXG5cdG1haW5DdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaHR0cCcsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyR0aW1lb3V0JywgJ2RyRmlsZWRGYWN0b3J5JywgJ2RyRmllbGRTZXJ2aWNlJ107XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZGlyZWN0aXZlKCdkckNlbGwnLCBbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG5cdFx0ZnVuY3Rpb24gZHJDZWxsTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyQ2VsbExpbmssXG5cdFx0XHRyZXN0cmljdDogJ0FFQycsXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZTogJHRlbXBsYXRlQ2FjaGUuZ2V0KCdkckNlbGwvZHJDZWxsLmh0bWwnKSxcblx0XHRcdGNvbnRyb2xsZXI6IGRyQ2VsbEN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdjJyxcblx0XHRcdGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0XHRcdFx0dHlwZTogJ0A/Jyxcblx0XHRcdFx0c3RhdGU6ICdAPydcblx0XHRcdH1cblx0XHR9O1xuXHR9XSk7XG5cblx0dmFyIGRyQ2VsbEN0cmwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJDZWxsQ3RybCgkc2NvcGUsICR0aW1lb3V0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgZHJDZWxsQ3RybCk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCY0YHQv9C+0LvRjNC30YPQtdC8INC90LAg0LLRjNGO0YXQtSwg0LLQvtC30LLRgNCw0YnQsNC10YIgY3NzLdC60LvQsNGB0YHRiyDQtNC70Y8g0YLQuNC/0LAg0Lgg0YHQvtGB0YLQvtGP0L3QuNGPINGP0YfQtdC50LrQuFxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKGRyQ2VsbEN0cmwsIFt7XG5cdFx0XHRrZXk6ICdyZXR1cm5DZWxsQ2xhc3MnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHJldHVybkNlbGxDbGFzcygpIHtcblx0XHRcdFx0dmFyIHR5cGUgPSAnY2VsbF90eXBlLScgKyAodGhpcy50eXBlIHx8ICdzcXVhcmUnKTtcblx0XHRcdFx0dmFyIHN0YXRlID0gJ2NlbGxfc3RhdGUtJyArICh0aGlzLnN0YXRlIHx8ICdkZWZhdWx0Jyk7XG5cblx0XHRcdFx0cmV0dXJuIFt0eXBlLCBzdGF0ZV07XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIGRyQ2VsbEN0cmw7XG5cdH0oKTtcblxuXHRkckNlbGxDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckdGltZW91dCddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnZHJGaWVsZCcsIFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcblx0XHRmdW5jdGlvbiBkckZpZWxkTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyRmllbGRMaW5rLFxuXHRcdFx0cmVzdHJpY3Q6ICdBRUMnLFxuXHRcdFx0c2NvcGU6IHt9LFxuXHRcdFx0dGVtcGxhdGU6ICR0ZW1wbGF0ZUNhY2hlLmdldCgnZHJGaWVsZC9kckZpZWxkLmh0bWwnKSxcblx0XHRcdGNvbnRyb2xsZXI6IGRyRmllbGRDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnY2YnLFxuXHRcdFx0YmluZFRvQ29udHJvbGxlcjoge1xuXHRcdFx0XHRjZWxsQ2xpY2s6ICc9PycsXG5cdFx0XHRcdHNpemU6ICc9PycsXG5cdFx0XHRcdGN0eDogJz0/J1xuXHRcdFx0fVxuXHRcdH07XG5cdH1dKTtcblxuXHR2YXIgZHJGaWVsZEN0cmwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJGaWVsZEN0cmwoZHJGaWVsZFNlcnZpY2UsIGRyRmlsZWRGYWN0b3J5LCAkc2NvcGUsICR0aW1lb3V0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgZHJGaWVsZEN0cmwpO1xuXG5cdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlID0gZHJGaWVsZFNlcnZpY2U7XG5cdFx0XHR0aGlzLmRyRmlsZWRGYWN0b3J5ID0gZHJGaWxlZEZhY3Rvcnk7XG5cdFx0XHRpZiAodGhpcy5zaXplKSB0aGlzLmRyRmlsZWRGYWN0b3J5LnNpemUgPSB0aGlzLnNpemU7XG5cdFx0XHR0aGlzLiRzY29wZSA9ICRzY29wZTtcblx0XHRcdHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcblxuXHRcdFx0dGhpcy5pbml0KCk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCf0YDQuCDQuNC90YbQuNCw0LvQuNC30LDRhtC40Lgg0YHQvtC30LTQsNC10Lwg0LzQsNGB0YHQuNCyXG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoZHJGaWVsZEN0cmwsIFt7XG5cdFx0XHRrZXk6ICdpbml0Jyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuXHRcdFx0XHR0aGlzLmNlbGxzID0gdGhpcy5kckZpZWxkU2VydmljZS5jcmVhdGVOZXdBcnIodGhpcy5zaXplKTtcblx0XHRcdH1cblxuXHRcdFx0LyoqXG4gICAgKiDQmtC70LjQuiDQv9C+INGP0YfQtdC50LrQtVxuICAgICogPT0g0YHQvtCx0YvRgtC40LUsINGP0YfQtdC50LrQsCwg0LjQvdC00LXQutGBINCyINC80LDRgdGB0LjQstC1ID09XG4gICAgKi9cblxuXHRcdH0sIHtcblx0XHRcdGtleTogJ2NlbGxDTGljaycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gY2VsbENMaWNrKGUsIGNlbGwsIGlkeCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdFx0aWYgKGNlbGwuc3RhdGUgPT09ICdkZWZhdWx0Jykge1xuXHRcdFx0XHRcdC8vINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1INGBINC00LXRhNC+0LvRgtC90YvQvCDRgdGC0LDRgtGD0YHQvtC8LiDQlNC10LvQsNC10Lwg0LXRkSDQsNC60YLQuNCy0L3QvtC5INC4INCy0YvQtNC10LvRj9C10Lwg0L/QsNGB0YHQuNCy0L7QvCDQsdC70LjQttCw0LnRiNC40LUg0Y/Rh9C10LnQutC4XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNlbGxzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNlbGxzW2ldLnN0YXRlID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRcdH10aGlzLmFjdGl2ZUNlbGwgPSBjZWxsO1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbC5zdGF0ZSA9ICdhY3RpdmUnO1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbElkeCA9IGlkeDtcblx0XHRcdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlLm1hcmtDbG9zZXN0Q2VsbChpZHgsICdwYXNzaXZlJyk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoY2VsbC5zdGF0ZSA9PT0gJ3Bhc3NpdmUnKSB7XG5cdFx0XHRcdFx0Ly8g0JrQu9C40Log0L/QviDRj9GH0LXQudC60LUg0YEg0L/QsNGB0YHQuNCy0L3Ri9C8INGB0YLQsNGC0YPRgdC+0Lxcblx0XHRcdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlLnJlcGxhY2VFbGVtZW50cyh0aGlzLmFjdGl2ZUNlbGxJZHgsIGlkeCk7XG5cdFx0XHRcdFx0Zm9yICh2YXIgX2kgPSAwOyBfaSA8IHRoaXMuY2VsbHMubGVuZ3RoOyBfaSArPSAxKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNlbGxzW19pXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHR9dGhpcy4kdGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLmRyRmllbGRTZXJ2aWNlXG5cdFx0XHRcdFx0XHQvLyBUT0RPOiDQv9C+INGC0LDQudC80LDRg9GC0YMg0YDQtdCw0LvQuNC30L7QstCw0YLRjCDRgdC70YPQtNC10Y7RidC10LUg0L/QvtCy0LXQtNC10L3QuNC1OiDQv9C10YDQtdGJ0LXQvdC90YvQuSDQsNC60YLQuNCy0L3Ri9C5INGN0LvQtdC80LXQvdGCINC+0YHRgtCw0ZHRgtGB0Y8g0LDQutGC0LjQstC90YvQvCDQvdCwINC90L7QstC+0Lwg0LzQtdGB0YLQtVxuXHRcdFx0XHRcdFx0Ly8gVE9ETzog0LLRi9C00LXQu9C40YLRjCDQvdC+0LLRi9C1INC/0LDRgdGB0LjQstC90YvQtSDRjdC70LXQvNC10L3RgtGLXG5cdFx0XHRcdFx0fSwgMjAwKTtcblx0XHRcdFx0fSBlbHNlIGlmIChjZWxsLnN0YXRlID09PSAnYWN0aXZlJykge1xuXHRcdFx0XHRcdC8vINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1INGBINCw0LrRgtC40LLQvdGL0Lwg0YHRgtCw0YLRg9GB0L7QvC4g0KHQvdC40LzQsNC10Lwg0LDQutGC0LjQstC90L7RgdGC0Ywg0YEg0L3QtdGRINC4INCx0LvQuNC20LDQudGI0LjRhVxuXHRcdFx0XHRcdGNlbGwuc3RhdGUgPSAnZGVmYXVsdCc7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbElkeCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlLm1hcmtDbG9zZXN0Q2VsbChpZHgsICdkZWZhdWx0Jyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gZHJGaWVsZEN0cmw7XG5cdH0oKTtcblxuXHRkckZpZWxkQ3RybC4kaW5qZWN0ID0gWydkckZpZWxkU2VydmljZScsICdkckZpbGVkRmFjdG9yeScsICckc2NvcGUnLCAnJHRpbWVvdXQnXTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5zZXJ2aWNlKCdkckZpZWxkU2VydmljZScsIFsnZHJGaWxlZEZhY3RvcnknLCAnJHRpbWVvdXQnLCBmdW5jdGlvbiAoZHJGaWxlZEZhY3RvcnksICR0aW1lb3V0KSB7XG5cdFx0LyoqXG4gICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gcHJpdmF0ZSBtZXRob2RzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAqL1xuXHRcdHZhciBfc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy5tYXRyaXhNb2RlbCA9IFtdO1xuXHRcdHZhciBfbW0gPSB0aGlzLm1hdHJpeE1vZGVsO1xuXHRcdHRoaXMucG9pbnRzID0ge1xuXHRcdFx0bGFzdERlbDogW10sXG5cdFx0XHRsYXN0UG9pbnRzOiAwLFxuXHRcdFx0YWxsUG9pbnRzOiAwXG5cdFx0fTtcblxuXHRcdHRoaXMucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR0aGlzLnBvaW50cy5sYXN0RGVsLmxlbmd0aCA9IDA7XG5cdFx0XHR0aGlzLnBvaW50cy5sYXN0UG9pbnRzID0gMDtcblx0XHRcdHRoaXMucG9pbnRzLmFsbFBvaW50cyA9IDA7XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQktC+0LfQstGA0LDRidCw0LXQvCDRgNCw0L3QtNC+0LzQvdGL0Lkg0Y3Qu9C10LzQtdC90YIg0LzQsNGB0YHQuNCy0LBcbiAgICovXG5cdFx0ZnVuY3Rpb24gcmV0dXJuUmFuZEVsZW1lbnQoYXJyKSB7XG5cdFx0XHR2YXIgaWR4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXJyLmxlbmd0aCk7XG5cdFx0XHRyZXR1cm4gYXJyW2lkeF07XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCS0L7Qt9Cy0YDQsNGJ0LDQtdC8INGA0LDQvdC00L7QvNC90YvQuSDRjdC70LXQvNC10L3RgiDQvNCw0YHRgdC40LLQsCwg0LjRgdC60LvRjtGH0LDRjyDQv9C10YDQtdC00LDQvdC90YvQuSDQsiDRhNGD0L3QutGG0LjRjlxuICAgKi9cblx0XHRmdW5jdGlvbiByZXR1cm5Bbm90aGVyVHlwZShyZXBlYXRUeXBlcykge1xuXHRcdFx0dmFyIG5ld0FyciA9IGFuZ3VsYXIuY29weShkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcmVwZWF0VHlwZXMubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBuZXdBcnIubGVuZ3RoOyBqICs9IDEpIHtcblx0XHRcdFx0XHRpZiAocmVwZWF0VHlwZXNbaV0gPT09IG5ld0FycltqXSkgbmV3QXJyLnNwbGljZShqLCAxKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcmV0dXJuUmFuZEVsZW1lbnQobmV3QXJyKTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0KTRg9C90LrRhtC40Y8g0L/RgNC+0YHRgtCw0LLQu9GP0LXRgiDRjdC70LXQvNC10L3RgtGL0Lwg0LzQsNGB0YHQuNCy0LAg0LrQvtC+0YDQtNC40L3QsNGC0YsgKNC/0L7Qu9GPIFwiY29sXCIsIFwicm93XCIpINCyINC30LDQstC40YHQuNC80L7RgdGC0Lgg0L7RglxuICAgKiDQstGC0L7RgNC+0LPQviDQv9Cw0YDQsNC80LXRgtGA0LAgc2l6ZSAo0YjQuNGA0LjQvdCwINC80LDRgdGB0LjQstCwKVxuICAgKi9cblx0XHRmdW5jdGlvbiBzZXRDb29yZHNUb0VsZW1lbnRzKCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfbW0ubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0X21tW2ldLmNvbCA9IGkgJSBfc2VsZi5zaXplO1xuXHRcdFx0XHRfbW1baV0ucm93ID0gTWF0aC5mbG9vcihpIC8gX3NlbGYuc2l6ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCk0YPQvdC60YbQuNGPINC/0YDQuNC90LjQvNCw0LXRgiDQvNCw0YHRgdC40LIsINCyINC60L7RgtC+0YDRi9C5INC00L7QsdCw0LLQu9GP0LXRgiDQvdC+0LLRi9C5INGN0LvQtdC80LXQvdGCLlxuICAgKiDQn9GA0Lgg0LTQvtCx0LDQstC70LXQvdC40Lgg0LLRi9C/0L7Qu9C90Y/QtdGCINC00LLQtSDQv9GA0L7QstC10YDQutC4OlxuICAgKiAtINC10YHQu9C4INGC0LjQv9GLINC00LLRg9GFINC/0YDQtdC00YvQtNGD0YnQuNGFINC+0LHRitC10LrRgiDRgNCw0LLQvdGLINGC0LXQutGD0YnQtdC80YMg0YHQs9C10L3QtdGA0LjRgNC+0LLQsNC90L3QvtC80YMg0YLQuNC/0YMsINGC0L4g0LPQtdC90LXRgNC40YDRg9C10Lwg0L3QvtCy0YvQuVxuICAgKiAtINC10YHQu9C4INGC0LjQv9GLINC00LLRg9GFINC+0LHRitC10LrRgtC+0LIg0L3QsNC0INGC0LXQutGD0LfQuNC8INGA0LDQstC90Ysg0YLQtdC60YPRidC10LzRgyDRgdCz0LXQvdC10YDQuNGA0L7QstCw0L3QvdC+0LzRgyDRgtC40L/Rgywg0YLQviDQs9C10L3QtdGA0LjRgNGD0LXQvCDQvdC+0LLRi9C5XG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJldHVyblR5cGVGb3JOZXdFbGVtZW50KGlkeCkge1xuXHRcdFx0Ly8g0J/RgNC+0LLQtdGA0LrQuCDQvdCwINCz0L7RgNC40LfQvtC90YLQsNC70YzQvdGL0LUg0Lgg0LLQtdGA0YLQuNC60LDQu9GM0L3Ri9C1INGB0L7QstC/0LDQtNC10L3QuNGPINC/0YDQuCDQs9C10L3QtdGA0LDRhtC40Lhcblx0XHRcdHZhciByZXBlYXRUeXBlcyA9IGNoZWNrRHVwZShpZHgpO1xuXG5cdFx0XHR2YXIgdHlwZSA9IHJlcGVhdFR5cGVzLmxlbmd0aCA/IHJldHVybkFub3RoZXJUeXBlKHJlcGVhdFR5cGVzKSA6IHJldHVyblJhbmRFbGVtZW50KGRyRmlsZWRGYWN0b3J5LnR5cGVzKTtcblxuXHRcdFx0cmV0dXJuIHR5cGU7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCf0YDQvtCy0LXRgNC60LAg0L3QsCDQv9C+0LLRgtC+0YDQtdC90LjQtVxuICAgKi9cblx0XHRmdW5jdGlvbiBjaGVja0R1cGUoaWR4KSB7XG5cdFx0XHR2YXIgcyA9IF9zZWxmLnNpemU7XG5cdFx0XHR2YXIgcmVzdWx0ID0gW107XG5cblx0XHRcdHZhciBjb2xJZHggPSBfbW0ubGVuZ3RoICUgcztcblx0XHRcdGlmIChjb2xJZHggPiAxKSB7XG5cdFx0XHRcdGlmIChfbW1bX21tLmxlbmd0aCAtIDJdLnR5cGUgPT09IF9tbVtfbW0ubGVuZ3RoIC0gMV0udHlwZSkge1xuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKF9tbVtfbW0ubGVuZ3RoIC0gMV0udHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dmFyIHJvd0lkeCA9IE1hdGguZmxvb3IoX21tLmxlbmd0aCAvIHMpO1xuXHRcdFx0aWYgKHJvd0lkeCA+IDEpIHtcblx0XHRcdFx0aWYgKF9tbVtfbW0ubGVuZ3RoIC0gc10udHlwZSA9PT0gX21tW19tbS5sZW5ndGggLSBzICogMl0udHlwZSkge1xuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKF9tbVtfbW0ubGVuZ3RoIC0gc10udHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8g0JXRgdC70Lgg0LzQuNC90LjQvNGD0Lwg0YLRgNC10YLQuNC5INGN0LvQtdC80LXQvdGCINCyINGB0YLRgNC+0LrQtVxuXHRcdFx0aWYgKGlkeCAtIE1hdGguZmxvb3IoaWR4IC8gcykgKiBzID4gMSkge1xuXHRcdFx0XHQvL9CV0YHQu9C4INC/0YDQtdC00YvQtNGD0YnQuNC1INC00LLQsCDRjdC70LXQvNC10L3RgtCwINCyINGB0YLRgNC+0LrQtSDRgdGD0YnQtdGB0YLQstGD0Y7RgiDQuCDQuNGFINGC0LjQv9GLINGB0L7QstC/0LDQtNCw0Y7Rgiwg0YLQviDQuNGB0LrQu9GO0YfQsNC10Lwg0YLQuNC/XG5cdFx0XHRcdGlmIChfbW1baWR4IC0gMV0gJiYgX21tW2lkeCAtIDJdICYmIF9tbVtpZHggLSAxXS50eXBlID09PSBfbW1baWR4IC0gMl0udHlwZSkgcmVzdWx0LnB1c2goX21tW2lkeCAtIDFdLnR5cGUpO1xuXHRcdFx0fVxuXHRcdFx0Ly8g0JXRgdC70Lgg0LfQsCDQvdC40Lwg0LXRgdGC0Ywg0LzQuNC90LjQvNGD0Lwg0LTQstCwINGN0LvQtdC80LXQvdGC0LAg0LIg0YHRgtGA0L7QutC1XG5cdFx0XHRpZiAoTWF0aC5jZWlsKGlkeCAvIHMpICogcyAtIGlkeCA+IDEpIHtcblx0XHRcdFx0Ly/QldGB0LvQuCDRgdC70LXQtNGD0Y7RidC40LUg0LTQstCwINGN0LvQtdC80LXQvdGC0LAg0LIg0YHRgtGA0L7QutC1INGB0YPRidC10YHRgtCy0YPRjtGCINC4INC40YUg0YLQuNC/0Ysg0YHQvtCy0L/QsNC00LDRjtGCLCDRgtC+INC40YHQutC70Y7Rh9Cw0LXQvCDRgtC40L9cblx0XHRcdFx0aWYgKF9tbVtpZHggKyAxXSAmJiBfbW1baWR4ICsgMl0gJiYgX21tW2lkeCArIDFdLnR5cGUgPT09IF9tbVtpZHggKyAyXS50eXBlKSByZXN1bHQucHVzaChfbW1baWR4ICsgMV0udHlwZSk7XG5cdFx0XHR9XG5cdFx0XHQvLyDQldGB0LvQuCDRgdCy0LXRgNGF0YMg0L3QsNC0INC90LjQvCDQtdGB0YLRjCDQvNC40L3QuNC80YPQvCDQtNCy0LAg0Y3Qu9C10LzQtdC90YLQsCDQsiDRgdGC0L7Qu9Cx0YbQtVxuXHRcdFx0aWYgKE1hdGguY2VpbChpZHggLyBzKSA+IDIpIHtcblx0XHRcdFx0Ly/QldGB0LvQuCDQtNCy0LAg0Y3Qu9C10LzQtdC90YLQsCDRgdCy0LXRgNGF0YMg0LIg0YHRgtC+0LvQsdGG0LUg0YHRg9GJ0LXRgdGC0LLRg9GO0YIg0Lgg0LjRhSDRgtC40L/RiyDRgdC+0LLQv9Cw0LTQsNGO0YIsINGC0L4g0LjRgdC60LvRjtGH0LDQtdC8INGC0LjQv1xuXHRcdFx0XHRpZiAoX21tW2lkeCAtIHNdICYmIF9tbVtpZHggLSBzICogMl0gJiYgX21tW2lkeCAtIHNdLnR5cGUgPT09IF9tbVtpZHggLSBzICogMl0udHlwZSkgcmVzdWx0LnB1c2goX21tW2lkeCAtIHNdLnR5cGUpO1xuXHRcdFx0fVxuXHRcdFx0Ly8g0JXRgdC70Lgg0YHQvdC40LfRgyDQv9C+0LQg0L3QuNC8INC10YHRgtGMINC80LjQvdC40LzRg9C8INC00LLQsCDRjdC70LXQvNC10L3RgtCwINCyINGB0YLQvtC70LHRhtC1XG5cdFx0XHRpZiAocyAtIE1hdGguY2VpbChpZHggLyBzKSA+IDIpIHtcblx0XHRcdFx0Ly/QldGB0LvQuCDQtNCy0LAg0Y3Qu9C10LzQtdC90YLQsCDRgdC90LjQt9GDINCyINGB0YLQvtC70LHRhtC1INGB0YPRidC10YHRgtCy0YPRjtGCINC4INC40YUg0YLQuNC/0Ysg0YHQvtCy0L/QsNC00LDRjtGCLCDRgtC+INC40YHQutC70Y7Rh9Cw0LXQvCDRgtC40L9cblx0XHRcdFx0aWYgKF9tbVtpZHggKyBzXSAmJiBfbW1baWR4ICsgcyAqIDJdICYmIF9tbVtpZHggKyBzXS50eXBlID09PSBfbW1baWR4ICsgcyAqIDJdLnR5cGUpIHJlc3VsdC5wdXNoKF9tbVtpZHggKyBzXS50eXBlKTtcblx0XHRcdH1cblx0XHRcdC8vINCV0YHQu9C4INC80LjQvdC40LzRg9C8INCy0YLQvtGA0L7QuSDQuCDQvNC40L3QuNC80YPQvCDQv9GA0LXQtNC/0L7RgdC70LXQtNC90LjQuSDRjdC70LXQvNC10L3RglxuXHRcdFx0aWYgKGlkeCAtIE1hdGguZmxvb3IoaWR4IC8gcykgKiBzID4gMCAmJiBNYXRoLmNlaWwoaWR4IC8gcykgKiBzIC0gaWR4ID4gMCkge1xuXHRcdFx0XHQvLyDQldGB0LvQuCDRgtC40L/RiyDRjdC70LXQvNC10L3RgtC+0LIg0L/QtdGA0LXQtCDQvdC40Lwg0Lgg0LfQsCDQvdC40Lwg0YHQvtCy0L/QsNC00LDRjtGCXG5cdFx0XHRcdGlmIChfbW1baWR4IC0gMV0gJiYgX21tW2lkeCArIDFdICYmIF9tbVtpZHggLSAxXS50eXBlID09PSBfbW1baWR4ICsgMV0udHlwZSkgcmVzdWx0LnB1c2goX21tW2lkeCAtIDFdLnR5cGUpO1xuXHRcdFx0fVxuXHRcdFx0Ly8g0JXRgdC70Lgg0L3QsNC0INC90LjQvCDQuCDQv9C+0LQg0L3QuNC8INC10YHRgtGMINGN0LvQtdC80LXQvdGC0Ytcblx0XHRcdGlmIChNYXRoLmNlaWwoaWR4IC8gcykgPiAxICYmIHMgLSBNYXRoLmNlaWwoaWR4IC8gcykgPiAxKSB7XG5cdFx0XHRcdC8vINCV0YHQu9C4INGC0LjQv9GLINGN0LvQtdC80LXQvdGC0L7QsiDQv9C+0LQg0L3QuNC8INC4INC90LDQtCDQvdC40Lwg0YHQvtCy0L/QsNC00LDRjtGCXG5cdFx0XHRcdGlmIChfbW1baWR4IC0gc10gJiYgX21tW2lkeCArIHNdICYmIF9tbVtpZHggLSBzXS50eXBlID09PSBfbW1baWR4ICsgc10udHlwZSkgcmVzdWx0LnB1c2goX21tW2lkeCAtIHNdLnR5cGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0L7QstC10YDRj9C10YIg0L3QsCDQs9C+0YDQuNC30L7QvdGC0LDQu9GM0L3Ri9C1INGB0L7QstC/0LDQtNC10L3QuNGPXG4gICAqL1xuXHRcdGZ1bmN0aW9uIGNvdW50UmVwZWF0SW5Sb3cocmVzdWx0KSB7XG5cdFx0XHR2YXIgc2l6ZSA9IF9zZWxmLnNpemU7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgX21tLmxlbmd0aDsgaSArPSBzaXplKSB7XG5cdFx0XHRcdHZhciBkZWxJZHhBcnIgPSBbaV0sXG5cdFx0XHRcdCAgICBjdXJyZW50VHlwZSA9IF9tbVtpXS50eXBlO1xuXG5cdFx0XHRcdG5leHQ6IGZvciAodmFyIGogPSAxOyBqIDwgc2l6ZTsgaiArPSAxKSB7XG5cdFx0XHRcdFx0aWYgKF9tbVtpICsgal0udHlwZSA9PT0gJ2VtcHR5JyB8fCBjdXJyZW50VHlwZSAhPT0gX21tW2kgKyBqXS50eXBlKSB7XG5cdFx0XHRcdFx0XHRpZiAoZGVsSWR4QXJyLmxlbmd0aCA+IDIpIGJyZWFrO1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLmxlbmd0aCA9IDA7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIucHVzaChpICsgaik7XG5cdFx0XHRcdFx0XHRjdXJyZW50VHlwZSA9IF9tbVtpICsgal0udHlwZTtcblx0XHRcdFx0XHRcdGNvbnRpbnVlIG5leHQ7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGRlbElkeEFyci5wdXNoKGkgKyBqKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGRlbElkeEFyci5sZW5ndGggPiAyKSB7XG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0XHRcdFx0bGVuZ3RoOiBkZWxJZHhBcnIubGVuZ3RoLFxuXHRcdFx0XHRcdFx0dHlwZTogY3VycmVudFR5cGUsXG5cdFx0XHRcdFx0XHRpZHhBcnI6IGFuZ3VsYXIuY29weShkZWxJZHhBcnIpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZGVsSWR4QXJyLmxlbmd0aCA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCk0YPQvdC60YbQuNGPINC/0YDQvtCy0LXRgNGP0LXRgiDQvdCwINCy0LXRgNGC0LjQutCw0LvRjNC90YvQtSDRgdC+0LLQv9Cw0LTQtdC90LjRj1xuICAgKi9cblx0XHRmdW5jdGlvbiBjb3VudFJlcGVhdEluQ29sKHJlc3VsdCkge1xuXHRcdFx0dmFyIHNpemUgPSBfc2VsZi5zaXplO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkgKz0gMSkge1xuXHRcdFx0XHR2YXIgZGVsSWR4QXJyID0gW2ldLFxuXHRcdFx0XHQgICAgY3VycmVudFR5cGUgPSBfbW1baV0udHlwZTtcblxuXHRcdFx0XHRuZXh0OiBmb3IgKHZhciBqID0gMTsgaiA8IHNpemU7IGogKz0gMSkge1xuXHRcdFx0XHRcdGlmIChfbW1baSArIGogKiBzaXplXS50eXBlID09PSAnZW1wdHknIHx8IGN1cnJlbnRUeXBlICE9PSBfbW1baSArIGogKiBzaXplXS50eXBlKSB7XG5cdFx0XHRcdFx0XHRpZiAoZGVsSWR4QXJyLmxlbmd0aCA+IDIpIGJyZWFrO1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLmxlbmd0aCA9IDA7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIucHVzaChpICsgaiAqIHNpemUpO1xuXHRcdFx0XHRcdFx0Y3VycmVudFR5cGUgPSBfbW1baSArIGogKiBzaXplXS50eXBlO1xuXHRcdFx0XHRcdFx0Y29udGludWUgbmV4dDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLnB1c2goaSArIGogKiBzaXplKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGRlbElkeEFyci5sZW5ndGggPiAyKSB7XG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0XHRcdFx0bGVuZ3RoOiBkZWxJZHhBcnIubGVuZ3RoLFxuXHRcdFx0XHRcdFx0dHlwZTogY3VycmVudFR5cGUsXG5cdFx0XHRcdFx0XHRpZHhBcnI6IGFuZ3VsYXIuY29weShkZWxJZHhBcnIpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZGVsSWR4QXJyLmxlbmd0aCA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gcHVibGljIG1ldGhvZHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICovXG5cblx0XHQvKipcbiAgICog0JzQtdGC0L7QtCDRgdC10YDQstC40YHQsCDQstC+0LfQstGA0LDRidCw0LXRgiDQvdC+0LLRi9C5INC80LDRgdGB0LjQsiDQtNC70LjQvdC+0Lkgc2l6ZSpzaXplXG4gICAqL1xuXHRcdHRoaXMuY3JlYXRlTmV3QXJyID0gZnVuY3Rpb24gKHNpemUpIHtcblx0XHRcdF9tbS5sZW5ndGggPSAwO1xuXHRcdFx0dGhpcy5zaXplID0gc2l6ZSB8fCBkckZpbGVkRmFjdG9yeS5zaXplO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNpemUgKiBzaXplOyBpKyspIHtcblx0XHRcdFx0dmFyIHR5cGUgPSByZXR1cm5UeXBlRm9yTmV3RWxlbWVudCgpO1xuXHRcdFx0XHRfbW0ucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IGksXG5cdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRzdGF0ZTogJ2RlZmF1bHQnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRzZXRDb29yZHNUb0VsZW1lbnRzKCk7XG5cblx0XHRcdHJldHVybiBfbW07XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQl9Cw0LTQsNC10Lwg0YHQvtGB0YLQvtGP0L3QuNC1INCx0LvQuNC20LDQudGI0LjQvCDRjdC70LXQvNC10L3RgtCw0Lwg0L7RgiDQstGL0LTQtdC70LXQvdC90L7Qs9C+XG4gICAqL1xuXHRcdHRoaXMubWFya0Nsb3Nlc3RDZWxsID0gZnVuY3Rpb24gKGlkeCwgc3RhdGUpIHtcblx0XHRcdHZhciBzaXplID0gX3NlbGYuc2l6ZTtcblxuXHRcdFx0aWYgKF9tbVtpZHggLSBzaXplXSkgX21tW2lkeCAtIHNpemVdLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRpZiAoX21tW2lkeCArIHNpemVdKSBfbW1baWR4ICsgc2l6ZV0uc3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChfbW1baWR4IC0gMV0pIF9tbVtpZHggLSAxXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKF9tbVtpZHggKyAxXSkgX21tW2lkeCArIDFdLnN0YXRlID0gc3RhdGU7XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQnNC10L3Rj9C10Lwg0LzQtdGB0YLQsNC80Lgg0Y/Rh9C10LnQutC4LiDQkNC70LPQvtGA0LjRgtC8OlxuICAgKiAtINGB0L3QsNGH0LDQu9CwINC80LXQvdGP0LXQvCDQv9Cw0YDQsNC80LXQvdGC0YDRiyBjb2wvcm93ICjQtNC70Y8g0LDQvdC40LzQsNGG0LgpLlxuICAgKiAtINC/0L7RgdC70LUg0L/QviDRgtCw0LnQvNCw0YPRgtGDINC80LXQvdGP0LXQvCDQtNCw0L3QvdGL0LUg0L7QsdGK0LXQutGC0L7QsiDQsiDRgdCw0LzQvtC8INC80LDRgdGB0LjQstC1ICjRhNC40LPRg9GA0YMpXG4gICAqL1xuXHRcdHRoaXMucmVwbGFjZUVsZW1lbnRzID0gZnVuY3Rpb24gKGlkeDEsIGlkeDIpIHtcblx0XHRcdHZhciB0ZW1wID0ge1xuXHRcdFx0XHRjb2wxOiBfbW1baWR4MV0uY29sLFxuXHRcdFx0XHRyb3cxOiBfbW1baWR4MV0ucm93LFxuXHRcdFx0XHRjb2wyOiBfbW1baWR4Ml0uY29sLFxuXHRcdFx0XHRyb3cyOiBfbW1baWR4Ml0ucm93XG5cdFx0XHR9O1xuXG5cdFx0XHRfbW1baWR4MV0uY29sID0gdGVtcC5jb2wyO1xuXHRcdFx0X21tW2lkeDFdLnJvdyA9IHRlbXAucm93MjtcblxuXHRcdFx0X21tW2lkeDJdLmNvbCA9IHRlbXAuY29sMTtcblx0XHRcdF9tbVtpZHgyXS5yb3cgPSB0ZW1wLnJvdzE7XG5cblx0XHRcdF9tbS5zb3J0KHNvcnRBcnJCeVJvd0NvbCk7XG5cblx0XHRcdHJlY3VyRGVsZXRlRWwoKTtcblxuXHRcdFx0Z2VuZXJhdGVOZXdFbCgpO1xuXG5cdFx0XHRyZWN1ckRlbGV0ZUVsKCk7IC8vINCy0YDQtdC80LXQvdC90YvQuSDRhdCw0Lpcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCT0LXQvdC10YDQuNGA0YPQtdC8INC90L7QstGL0LUg0Y3Qu9C10LzQtdC90YLRi1xuICAgKi9cblx0XHRmdW5jdGlvbiBnZW5lcmF0ZU5ld0VsKCkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfbW0ubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0aWYgKF9tbVtpXS50eXBlID09PSAnZW1wdHknKSBfbW1baV0udHlwZSA9IHJldHVyblR5cGVGb3JOZXdFbGVtZW50KGkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQn9GA0L7QstC10YDRj9C10Lwg0L3QsCDQvtCx0YrQtdC60YLRiyDQvtC00LjQvdCw0LrQvtCy0L7Qs9C+INGC0LjQv9CwINCyINGB0YLRgNC+0LrQsNGFXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJlY3VyRGVsZXRlRWwoKSB7XG5cdFx0XHR2YXIgcmVzdWx0ID0gW107XG5cblx0XHRcdGNvdW50UmVwZWF0SW5Sb3cocmVzdWx0KTtcblx0XHRcdGNvdW50UmVwZWF0SW5Db2wocmVzdWx0KTtcblxuXHRcdFx0aWYgKCFyZXN1bHQubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0XHRcdGNhbGN1bGF0ZVBvaW50c0luZm8ocmVzdWx0KTtcblxuXHRcdFx0X3NlbGYuZGVsZXRlRWxlbWVudHMocmVzdWx0KTtcblxuXHRcdFx0X3NlbGYubW92ZVRvcEVsKCk7XG5cblx0XHRcdF9tbS5zb3J0KHNvcnRBcnJCeVJvd0NvbCk7XG5cblx0XHRcdHJlY3VyRGVsZXRlRWwoKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjYWxjdWxhdGVQb2ludHNJbmZvKHJlc3VsdCkge1xuXHRcdFx0X3NlbGYucG9pbnRzLmxhc3REZWwubGVuZ3RoID0gMDtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdHZhciB0eXBlID0gcmVzdWx0W2ldLnR5cGU7XG5cdFx0XHRcdHZhciBwb2ludHMgPSBkckZpbGVkRmFjdG9yeS5wb2ludHNNYXBbdHlwZV0gKiByZXN1bHRbaV0ubGVuZ3RoO1xuXHRcdFx0XHRfc2VsZi5wb2ludHMubGFzdFBvaW50cyA9IHBvaW50cztcblx0XHRcdFx0X3NlbGYucG9pbnRzLmFsbFBvaW50cyArPSBwb2ludHM7XG5cdFx0XHRcdF9zZWxmLnBvaW50cy5sYXN0RGVsLnB1c2gocmVzdWx0W2ldLmxlbmd0aCArICcgJyArIHR5cGUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQo9C00LDQu9GP0LXQvCDQvtCx0YrQtdC60YLRiyDQvtC00LjQvdCw0LrQvtCy0L7Qs9C+INGC0LjQv9CwLCDQtdGB0LvQuCDQuNGFINCx0L7Qu9GM0YjQtSDRgtGA0ZHRhSDQsiDRgdGC0YDQvtC60LUg0LjQu9C4INCyINC60L7Qu9C+0L3QutC1XG4gICAqL1xuXHRcdHRoaXMuZGVsZXRlRWxlbWVudHMgPSBmdW5jdGlvbiAoZGVsQXJyKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRlbEFyci5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHR2YXIgbGluZSA9IGRlbEFycltpXTtcblxuXHRcdFx0XHQvLyDRg9C00LDQu9GP0LXQvNGL0Lwg0Y/Rh9C10LnQutCw0Lwg0L/RgNC40YHQstCw0LjQstCw0LXQvCDRgtC40L8gXCJlbXB0eVwiXG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbGluZS5pZHhBcnIubGVuZ3RoOyBqICs9IDEpIHtcblx0XHRcdFx0XHRfbW1bbGluZS5pZHhBcnJbal1dLnR5cGUgPSAnZW1wdHknO1xuXHRcdFx0XHR9IC8vINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INC40Lwg0YHRgtCw0YLRg9GBIFwiZGVmYXVsdFwiXG5cdFx0XHRcdGZvciAodmFyIF9qID0gMDsgX2ogPCBfbW0ubGVuZ3RoOyBfaiArPSAxKSB7XG5cdFx0XHRcdFx0X21tW19qXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvKipcbiAgICog0JXRgdC70Lgg0L3QsNC0INC/0YPRgdGC0YvQvNC4INC80LXRgdGC0LDQvNC4INC+0YHRgtCw0LvQuNGB0Ywg0YTQuNCz0YPRgNGLIC0g0L7Qv9GD0YHQutCw0LXQvCDQuNGFXG4gICAqL1xuXHRcdHRoaXMubW92ZVRvcEVsID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8g0JzQsNGB0YHQuNCyLCDQutC+0YLQvtGA0YvQuSDRhdGA0LDQvdC40YIg0LjQvdC00LXQutGB0Ysg0YEg0L/Rg9GB0YLRi9C80Lgg0Y3Qu9C10LzQtdC90YLQsNC80Lhcblx0XHRcdHZhciBzaXplID0gZHJGaWxlZEZhY3Rvcnkuc2l6ZTtcblxuXHRcdFx0bmV4dDogZm9yICh2YXIgY291bnQgPSAwLCBpID0gMCwgZW1wdHlDb3VudCA9IDAsIGVtcHR5U3RhcnRJZHg7IGkgPCBfbW0ubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0aWYgKGkgPiAwICYmIGkgJSBzaXplID09PSAwKSB7XG5cdFx0XHRcdFx0ZW1wdHlTdGFydElkeCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRlbXB0eUNvdW50ID0gMDtcblx0XHRcdFx0XHRjb3VudCsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIHJvd0lkeCA9IGkgJSBzaXplICogc2l6ZSArIGNvdW50O1xuXG5cdFx0XHRcdGlmIChfbW1bcm93SWR4XS50eXBlID09PSAnZW1wdHknKSB7XG5cdFx0XHRcdFx0aWYgKCFlbXB0eVN0YXJ0SWR4KSBlbXB0eVN0YXJ0SWR4ID0gcm93SWR4O1xuXHRcdFx0XHRcdGVtcHR5Q291bnQrKztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vINCf0YDQvtCy0LXRgNC60LAg0L3QsCDQv9C+0YHQu9C10LTQvdC40Lkg0Y3Qu9C10LzQtdC90YIg0LIg0YHRgtC+0LvQsdGG0LVcblx0XHRcdFx0aWYgKGkgPiAwICYmIChpICsgMSkgJSBzaXplID09PSAwICYmIGVtcHR5Q291bnQgPiAwKSB7XG5cdFx0XHRcdFx0bW92ZUVsZW1lbnRzKGVtcHR5U3RhcnRJZHgsIGVtcHR5Q291bnQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdGZ1bmN0aW9uIG1vdmVFbGVtZW50cyhlbXB0eVN0YXJ0SWR4LCBlbXB0eUNvdW50KSB7XG5cdFx0XHR2YXIgc2l6ZSA9IGRyRmlsZWRGYWN0b3J5LnNpemU7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygn0KDQsNCx0L7RgtCw0LXQvCDRgdC+INGB0YLQvtC70LHRhtC+0LwgJywgY291bnQpO1xuXHRcdFx0dmFyIGNvdW50T2ZNb3ZhYmxlRWwgPSBNYXRoLmZsb29yKGVtcHR5U3RhcnRJZHggLyBzaXplKTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKCfQn9C10YDQtdC00LLQuNCz0LDQtdC8ICcsIGNvdW50T2ZNb3ZhYmxlRWwsICcg0LXQu9C10LzQtdC90YLQvtCyINCyINGB0YLQvtCx0LvRhtC1ICcsIGNvdW50KTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIGMgPSBlbXB0eVN0YXJ0SWR4OyBpIDwgZW1wdHlDb3VudDsgaSArPSAxKSB7XG5cdFx0XHRcdF9tbVtjXS5yb3cgLT0gY291bnRPZk1vdmFibGVFbDtcblx0XHRcdFx0YyArPSBzaXplO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICh2YXIgX2kgPSAwLCBfYyA9IGVtcHR5U3RhcnRJZHg7IF9pIDwgY291bnRPZk1vdmFibGVFbDsgX2kgKz0gMSkge1xuXHRcdFx0XHRfYyAtPSBzaXplO1xuXHRcdFx0XHRfbW1bX2NdLnJvdyArPSBlbXB0eUNvdW50O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBjb25zb2xlLmxvZygn0JPQtdC90LXRgNC40YDRg9C10LwgJywgZW1wdHlDb3VudCwgJyDQvdC+0LLRi9GFINGN0LvQtdC80LXQvdGC0L7QsiDQsiDRgdGC0L7QsdC70YbQtSAnLCBjb3VudCk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCh0L7RgNGC0LjRgNC+0LLQutCwINC80LDRgdGB0LjQstCwINC/0L4g0LfQvdCw0YfQtdC90LjRjyBvYmoucm93INC4IG9iai5jb2wg0Y3Qu9C10LzQtdC90YLQvtCyLiDQmNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8g0L/QvtGB0LvQtSDQv9C10YDQtdGB0YLQsNC90L7QstC+0Log0Lgg0YPQtNCw0LvQtdC90LjQuVxuICAgKiAo0LTQu9GPINGB0LjQvdGF0YDQvtC90LjQt9Cw0YbQuNC4INCy0YzRjtGF0Lgg0Lgg0LzQvtC00LXQu9C4LCDRgi7Qui4g0L3QsCDQstGM0Y7RhdC1INC/0YDQuCDQv9C10YDQtdC80LXRidC10L3QuNC4INC80Ysg0L3QtSDQvNC10L3Rj9C70Lgg0LzQvtC00LXQu9GMKVxuICAgKi9cblx0XHRmdW5jdGlvbiBzb3J0QXJyQnlSb3dDb2woYSwgYikge1xuXHRcdFx0aWYgKGEucm93ICE9PSBiLnJvdykge1xuXHRcdFx0XHRyZXR1cm4gYS5yb3cgLSBiLnJvdztcblx0XHRcdH0gZWxzZSBpZiAoYS5yb3cgPT09IGIucm93KSB7XG5cdFx0XHRcdHJldHVybiBhLmNvbCAtIGIuY29sO1xuXHRcdFx0fVxuXHRcdH1cblx0fV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2RyRmlsZWRGYWN0b3J5JywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciB0eXBlcyA9IFsnc3F1YXJlJywgJ2NpcmNsZScsICd0cmlhbmdsZSddO1xuXG5cdFx0dmFyIHN0YXRlcyA9IFsnZGVmYXVsdCcsICdhY3RpdmUnLCAncGFzc2l2ZScsICdub3RlJ107XG5cblx0XHR2YXIgcG9pbnRzTWFwID0ge1xuXHRcdFx0c3F1YXJlOiAxMCxcblx0XHRcdHRyaWFuZ2xlOiAyMCxcblx0XHRcdGNpcmNsZTogMzBcblx0XHR9O1xuXG5cdFx0dmFyIHNpemUgPSA5O1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHR5cGVzOiB0eXBlcyxcblx0XHRcdHN0YXRlczogc3RhdGVzLFxuXHRcdFx0c2l6ZTogc2l6ZSxcblx0XHRcdHBvaW50c01hcDogcG9pbnRzTWFwXG5cdFx0fTtcblx0fSk7XG59KSgpOyJdfQ==
