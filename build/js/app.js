"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"])}(),angular.module("app").run(["$templateCache",function(t){t.put("drCell/drCell.html",'<div class="cell" ng-class="c.returnCellClass()">\n\t<div class="cell__fig"></div>\n</div>\n'),t.put("drField/drField.html","<ul class=\"cell-list\"ng-style=\"{'width': cf.size*60 + 'px', 'height': cf.size*60 + 'px'}\">\n\t<li class=\"cell-list__item\"\n\t\tng-repeat=\"(idx, cell) in cf.cells track by cell.id\"\n\t\tng-style=\"{'left': cell.col*60 + 'px', 'top': cell.row*60 + 'px'}\"\n\t\tng-click=\"cf.cellCLick($event, cell, idx)\">\n\n\t\t<dr-cell type=\"{{cell.type}}\" state=\"{{cell.state}}\"></dr-cell>\n\n\t</li>\n</ul>")}]),function(){function t(t,e,l,r,i,n,a){this.$scope=t,this.$http=e,this.$state=l,this.drFieldService=a,this.points=a.points,this.drFiledFactory=n,this.cellState="square",this.init()}angular.module("app").controller("mainCtrl",t),t.prototype.init=function(){},t.prototype.newGame=function(t,e){t.preventDefault(),t.stopPropagation(),this.drFiledFactory.size=e,this.drFieldService.createNewArr(e),this.drFieldService.reset()},t.$inject=["$scope","$http","$state","$stateParams","$timeout","drFiledFactory","drFieldService"]}();var _createClass=function(){function t(t,e){for(var l=0;l<e.length;l++){var r=e[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,l,r){return l&&t(e.prototype,l),r&&t(e,r),e}}();!function(){angular.module("app").directive("drCell",["$templateCache",function(e){function l(t,e,l,r){}return{link:l,restrict:"AEC",scope:{},template:e.get("drCell/drCell.html"),controller:t,controllerAs:"c",bindToController:{type:"@?",state:"@?"}}}]);var t=function(){function t(e,l){_classCallCheck(this,t)}return _createClass(t,[{key:"returnCellClass",value:function(){var t="cell_type-"+(this.type||"square"),e="cell_state-"+(this.state||"default");return[t,e]}}]),t}();t.$inject=["$scope","$timeout"]}();var _createClass=function(){function t(t,e){for(var l=0;l<e.length;l++){var r=e[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,l,r){return l&&t(e.prototype,l),r&&t(e,r),e}}();!function(){angular.module("app").directive("drField",["$templateCache",function(e){function l(t,e,l,r){}return{link:l,restrict:"AEC",scope:{},template:e.get("drField/drField.html"),controller:t,controllerAs:"cf",bindToController:{cellClick:"=?",size:"=?",ctx:"=?"}}}]);var t=function(){function t(e,l,r,i){_classCallCheck(this,t),this.drFieldService=e,this.drFiledFactory=l,this.size&&(this.drFiledFactory.size=this.size),this.$scope=r,this.$timeout=i,this.init()}return _createClass(t,[{key:"init",value:function(){this.cells=this.drFieldService.createNewArr(this.size)}},{key:"cellCLick",value:function(t,e,l){if(t.preventDefault(),t.stopPropagation(),"default"===e.state){for(var r=0;r<this.cells.length;r+=1)this.cells[r].state="default";this.activeCell=e,this.activeCell.state="active",this.activeCellIdx=l,this.drFieldService.markClosestCell(l,"passive")}else"passive"===e.state?(this.drFieldService.replaceElements(this.activeCellIdx,l),this.$timeout(function(){},200)):"active"===e.state&&(e.state="default",this.activeCell=void 0,this.activeCellIdx=void 0,this.drFieldService.markClosestCell(l,"default"))}}]),t}();t.$inject=["drFieldService","drFiledFactory","$scope","$timeout"]}(),function(){angular.module("app").service("drFieldService",["drFiledFactory","$timeout",function(t,e){function l(t){var e=Math.floor(Math.random()*t.length);return t[e]}function r(e){for(var r=angular.copy(t.types),i=0;i<e.length;i+=1)for(var n=0;n<r.length;n+=1)e[i]===r[n]&&r.splice(n,1);return l(r)}function i(){for(var t=0;t<y.length;t+=1)y[t].col=t%v.size,y[t].row=Math.floor(t/v.size)}function n(e){var i=a(e),n=i.length?r(i):l(t.types);return n}function a(t){var e=v.size,l=[],r=y.length%e;r>1&&y[y.length-2].type===y[y.length-1].type&&l.push(y[y.length-1].type);var i=Math.floor(y.length/e);return i>1&&y[y.length-e].type===y[y.length-2*e].type&&l.push(y[y.length-e].type),t-Math.floor(t/e)*e>1&&y[t-1]&&y[t-2]&&y[t-1].type===y[t-2].type&&l.push(y[t-1].type),Math.ceil(t/e)*e-t>1&&y[t+1]&&y[t+2]&&y[t+1].type===y[t+2].type&&l.push(y[t+1].type),Math.ceil(t/e)>2&&y[t-e]&&y[t-2*e]&&y[t-e].type===y[t-2*e].type&&l.push(y[t-e].type),e-Math.ceil(t/e)>2&&y[t+e]&&y[t+2*e]&&y[t+e].type===y[t+2*e].type&&l.push(y[t+e].type),t-Math.floor(t/e)*e>0&&Math.ceil(t/e)*e-t>0&&y[t-1]&&y[t+1]&&y[t-1].type===y[t+1].type&&l.push(y[t-1].type),Math.ceil(t/e)>1&&e-Math.ceil(t/e)>1&&y[t-e]&&y[t+e]&&y[t-e].type===y[t+e].type&&l.push(y[t-e].type),l}function s(t){for(var e=v.size,l=0;l<y.length;l+=e){for(var r=[l],i=y[l].type,n=1;n<e;n+=1)if("empty"!==y[l+n].type&&i===y[l+n].type)r.push(l+n);else{if(r.length>2)break;r.length=0,r.push(l+n),i=y[l+n].type}r.length>2&&t.push({length:r.length,type:i,idxArr:angular.copy(r)}),r.length=0}}function o(t){for(var e=v.size,l=0;l<e;l+=1){for(var r=[l],i=y[l].type,n=1;n<e;n+=1)if("empty"!==y[l+n*e].type&&i===y[l+n*e].type)r.push(l+n*e);else{if(r.length>2)break;r.length=0,r.push(l+n*e),i=y[l+n*e].type}r.length>2&&t.push({length:r.length,type:i,idxArr:angular.copy(r)}),r.length=0}}function c(){for(var t=0;t<y.length;t+=1)"empty"===y[t].type&&(y[t].type=n(t))}function p(){var t=[];s(t),o(t);for(var l=0;l<y.length;l+=1)y[l].state="default";if(!t.length){for(var r=!1,i=0;i<y.length;i+=1)if("empty"===y[i].type){r=!0;break}return r&&(c(),p()),!1}e(function(){u(t),h(t),e(function(){v.deleteElements(t),v.moveTopEl(),y.sort(d),p()},500)},250)}function u(t){for(var e=0;e<t.length;e+=1)for(var l=t[e],r=0;r<l.idxArr.length;r+=1)y[l.idxArr[r]].state="delete"}function h(e){v.points.lastDel.length=0;for(var l=0;l<e.length;l+=1){var r=e[l].type,i=t.pointsMap[r]*e[l].length;v.points.lastPoints=i,v.points.allPoints+=i,v.points.lastDel.push(e[l].length+" "+r)}}function f(e,l){for(var r=t.size,i=Math.floor(e/r),n=0,a=e;n<l;n+=1)y[a].row-=i,a+=r;for(var s=0,o=e;s<i;s+=1)o-=r,y[o].row+=l}function d(t,e){return t.row!==e.row?t.row-e.row:t.row===e.row?t.col-e.col:void 0}var v=this;this.matrixModel=[];var y=this.matrixModel;this.points={lastDel:[],lastPoints:0,allPoints:0},this.reset=function(){this.points.lastDel.length=0,this.points.lastPoints=0,this.points.allPoints=0},this.createNewArr=function(e){y.length=0,this.size=e||t.size;for(var l=0;l<e*e;l++){var r=n();y.push({id:l,type:r,state:"default"})}return i(),y},this.markClosestCell=function(t,e){var l=v.size;y[t-l]&&(y[t-l].state=e),y[t+l]&&(y[t+l].state=e),y[t-1]&&(y[t-1].state=e),y[t+1]&&(y[t+1].state=e)},this.replaceElements=function(t,e){var l={col1:y[t].col,row1:y[t].row,col2:y[e].col,row2:y[e].row};y[t].col=l.col2,y[t].row=l.row2,y[e].col=l.col1,y[e].row=l.row1,y.sort(d),p()},this.deleteElements=function(t){for(var e=0;e<t.length;e+=1){for(var l=t[e],r=0;r<l.idxArr.length;r+=1)y[l.idxArr[r]].type="empty";for(var i=0;i<y.length;i+=1)y[i].state="default"}},this.moveTopEl=function(){for(var e,l=t.size,r=0,i=0,n=0;i<y.length;i+=1){i>0&&i%l===0&&(e=void 0,n=0,r++);var a=i%l*l+r;"empty"===y[a].type&&(e||(e=a),n++),i>0&&(i+1)%l===0&&n>0&&f(e,n)}}}])}(),function(){angular.module("app").factory("drFiledFactory",function(){var t=["square","circle","triangle"],e=["default","active","passive","note"],l={square:10,triangle:20,circle:30},r=5;return{types:t,states:e,size:r,pointsMap:l}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsIiRzdGF0ZSIsIiRzdGF0ZVBhcmFtcyIsIiR0aW1lb3V0IiwiZHJGaWxlZEZhY3RvcnkiLCJkckZpZWxkU2VydmljZSIsInRoaXMiLCJwb2ludHMiLCJjZWxsU3RhdGUiLCJpbml0IiwiY29udHJvbGxlciIsInByb3RvdHlwZSIsIm5ld0dhbWUiLCJlIiwic2l6ZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiY3JlYXRlTmV3QXJyIiwicmVzZXQiLCIkaW5qZWN0IiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsImRpcmVjdGl2ZSIsImRyQ2VsbExpbmsiLCIkZWxlbWVudCIsIiRhdHRycyIsImxpbmsiLCJyZXN0cmljdCIsInNjb3BlIiwidGVtcGxhdGUiLCJnZXQiLCJkckNlbGxDdHJsIiwiY29udHJvbGxlckFzIiwiYmluZFRvQ29udHJvbGxlciIsInR5cGUiLCJzdGF0ZSIsInZhbHVlIiwiZHJGaWVsZExpbmsiLCJkckZpZWxkQ3RybCIsImNlbGxDbGljayIsImN0eCIsImNlbGxzIiwiY2VsbCIsImlkeCIsImFjdGl2ZUNlbGwiLCJhY3RpdmVDZWxsSWR4IiwibWFya0Nsb3Nlc3RDZWxsIiwicmVwbGFjZUVsZW1lbnRzIiwidW5kZWZpbmVkIiwic2VydmljZSIsInJldHVyblJhbmRFbGVtZW50IiwiYXJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmV0dXJuQW5vdGhlclR5cGUiLCJyZXBlYXRUeXBlcyIsIm5ld0FyciIsImNvcHkiLCJ0eXBlcyIsImoiLCJzcGxpY2UiLCJzZXRDb29yZHNUb0VsZW1lbnRzIiwiX21tIiwiY29sIiwiX3NlbGYiLCJyb3ciLCJyZXR1cm5UeXBlRm9yTmV3RWxlbWVudCIsImNoZWNrRHVwZSIsInMiLCJyZXN1bHQiLCJjb2xJZHgiLCJwdXNoIiwicm93SWR4IiwiY2VpbCIsImNvdW50UmVwZWF0SW5Sb3ciLCJkZWxJZHhBcnIiLCJjdXJyZW50VHlwZSIsImlkeEFyciIsImNvdW50UmVwZWF0SW5Db2wiLCJnZW5lcmF0ZU5ld0VsIiwicmVjdXJEZWxldGVFbCIsIm1hcmtlciIsIm1hcmtEZWxldGVFbCIsImNhbGN1bGF0ZVBvaW50c0luZm8iLCJkZWxldGVFbGVtZW50cyIsIm1vdmVUb3BFbCIsInNvcnQiLCJzb3J0QXJyQnlSb3dDb2wiLCJvYmoiLCJsYXN0RGVsIiwicG9pbnRzTWFwIiwibGFzdFBvaW50cyIsImFsbFBvaW50cyIsIm1vdmVFbGVtZW50cyIsImVtcHR5U3RhcnRJZHgiLCJlbXB0eUNvdW50IiwiY291bnRPZk1vdmFibGVFbCIsImMiLCJfaSIsIl9jIiwiYSIsImIiLCJtYXRyaXhNb2RlbCIsImlkIiwiaWR4MSIsImlkeDIiLCJ0ZW1wIiwiY29sMSIsInJvdzEiLCJjb2wyIiwicm93MiIsImRlbEFyciIsImxpbmUiLCJfaiIsImNvdW50IiwiZmFjdG9yeSIsInN0YXRlcyIsInNxdWFyZSIsInRyaWFuZ2xlIiwiY2lyY2xlIl0sIm1hcHBpbmdzIjoiQUFBQSxZQWdEQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FpRGhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHNDQS9GaEgsV0FDQ0MsUUFBUUMsT0FBTyxPQUFR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SUFHRCxJQUFJMUMsR0FBUzlELEVBQUlWLEVBQU9BLEVBQU9rSCxDQUVOLFdBQXJCcEQsRUFBSVUsR0FBUXZDLE9BQ1Y2RCxJQUFlQSxFQUFnQnRCLEdBQ3BDdUIsS0FJR3JGLEVBQUksSUFBTUEsRUFBSSxHQUFLVixJQUFTLEdBQUsrRixFQUFhLEdBQ2pERixFQUFhQyxFQUFlQyxXQXNDakMsV0FDQ3BILFFBQVFDLE9BQU8sT0FBT3VJLFFBQVEsaUJBQWtCLFdBQy9DLEdBQUl6RCxJQUFTLFNBQVUsU0FBVSxZQUU3QjBELEdBQVUsVUFBVyxTQUFVLFVBQVcsUUFFMUMxQixHQUNIMkIsT0FBUSxHQUNSQyxTQUFVLEdBQ1ZDLE9BQVEsSUFHTHZILEVBQU8sQ0FFWCxRQUNDMEQsTUFBT0EsRUFDUDBELE9BQVFBLEVBQ1JwSCxLQUFNQSxFQUNOMEYsVUFBV0EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ0FuaW1hdGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJywgJ3VpLnJvdXRlciddKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2RyQ2VsbC9kckNlbGwuaHRtbCcsICc8ZGl2IGNsYXNzPVwiY2VsbFwiIG5nLWNsYXNzPVwiYy5yZXR1cm5DZWxsQ2xhc3MoKVwiPlxcblxcdDxkaXYgY2xhc3M9XCJjZWxsX19maWdcIj48L2Rpdj5cXG48L2Rpdj5cXG4nKTtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdkckZpZWxkL2RyRmllbGQuaHRtbCcsICc8dWwgY2xhc3M9XCJjZWxsLWxpc3RcIm5nLXN0eWxlPVwie1xcJ3dpZHRoXFwnOiBjZi5zaXplKjYwICsgXFwncHhcXCcsIFxcJ2hlaWdodFxcJzogY2Yuc2l6ZSo2MCArIFxcJ3B4XFwnfVwiPlxcblxcdDxsaSBjbGFzcz1cImNlbGwtbGlzdF9faXRlbVwiXFxuXFx0XFx0bmctcmVwZWF0PVwiKGlkeCwgY2VsbCkgaW4gY2YuY2VsbHMgdHJhY2sgYnkgY2VsbC5pZFwiXFxuXFx0XFx0bmctc3R5bGU9XCJ7XFwnbGVmdFxcJzogY2VsbC5jb2wqNjAgKyBcXCdweFxcJywgXFwndG9wXFwnOiBjZWxsLnJvdyo2MCArIFxcJ3B4XFwnfVwiXFxuXFx0XFx0bmctY2xpY2s9XCJjZi5jZWxsQ0xpY2soJGV2ZW50LCBjZWxsLCBpZHgpXCI+XFxuXFxuXFx0XFx0PGRyLWNlbGwgdHlwZT1cInt7Y2VsbC50eXBlfX1cIiBzdGF0ZT1cInt7Y2VsbC5zdGF0ZX19XCI+PC9kci1jZWxsPlxcblxcblxcdDwvbGk+XFxuPC91bD4nKTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdtYWluQ3RybCcsIG1haW5DdHJsKTtcblxuXHRmdW5jdGlvbiBtYWluQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHRpbWVvdXQsIGRyRmlsZWRGYWN0b3J5LCBkckZpZWxkU2VydmljZSkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdHRoaXMuJGh0dHAgPSAkaHR0cDtcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcblxuXHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UgPSBkckZpZWxkU2VydmljZTtcblx0XHR0aGlzLnBvaW50cyA9IGRyRmllbGRTZXJ2aWNlLnBvaW50cztcblx0XHR0aGlzLmRyRmlsZWRGYWN0b3J5ID0gZHJGaWxlZEZhY3Rvcnk7XG5cblx0XHR0aGlzLmNlbGxTdGF0ZSA9ICdzcXVhcmUnO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRtYWluQ3RybC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHt9O1xuXG5cdG1haW5DdHJsLnByb3RvdHlwZS5uZXdHYW1lID0gZnVuY3Rpb24gKGUsIHNpemUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR0aGlzLmRyRmlsZWRGYWN0b3J5LnNpemUgPSBzaXplO1xuXHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UuY3JlYXRlTmV3QXJyKHNpemUpO1xuXHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UucmVzZXQoKTtcblx0fTtcblxuXHRtYWluQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGh0dHAnLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckdGltZW91dCcsICdkckZpbGVkRmFjdG9yeScsICdkckZpZWxkU2VydmljZSddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnZHJDZWxsJywgWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuXHRcdGZ1bmN0aW9uIGRyQ2VsbExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdGltZW91dCkge31cblxuXHRcdHJldHVybiB7XG5cdFx0XHRsaW5rOiBkckNlbGxMaW5rLFxuXHRcdFx0cmVzdHJpY3Q6ICdBRUMnLFxuXHRcdFx0c2NvcGU6IHt9LFxuXHRcdFx0dGVtcGxhdGU6ICR0ZW1wbGF0ZUNhY2hlLmdldCgnZHJDZWxsL2RyQ2VsbC5odG1sJyksXG5cdFx0XHRjb250cm9sbGVyOiBkckNlbGxDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnYycsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdHR5cGU6ICdAPycsXG5cdFx0XHRcdHN0YXRlOiAnQD8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuXG5cdHZhciBkckNlbGxDdHJsID0gZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyQ2VsbEN0cmwoJHNjb3BlLCAkdGltZW91dCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIGRyQ2VsbEN0cmwpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvdCwINCy0YzRjtGF0LUsINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCIGNzcy3QutC70LDRgdGB0Ysg0LTQu9GPINGC0LjQv9CwINC4INGB0L7RgdGC0L7Rj9C90LjRjyDRj9GH0LXQudC60LhcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhkckNlbGxDdHJsLCBbe1xuXHRcdFx0a2V5OiAncmV0dXJuQ2VsbENsYXNzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiByZXR1cm5DZWxsQ2xhc3MoKSB7XG5cdFx0XHRcdHZhciB0eXBlID0gJ2NlbGxfdHlwZS0nICsgKHRoaXMudHlwZSB8fCAnc3F1YXJlJyk7XG5cdFx0XHRcdHZhciBzdGF0ZSA9ICdjZWxsX3N0YXRlLScgKyAodGhpcy5zdGF0ZSB8fCAnZGVmYXVsdCcpO1xuXG5cdFx0XHRcdHJldHVybiBbdHlwZSwgc3RhdGVdO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBkckNlbGxDdHJsO1xuXHR9KCk7XG5cblx0ZHJDZWxsQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHRpbWVvdXQnXTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ2RyRmllbGQnLCBbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG5cdFx0ZnVuY3Rpb24gZHJGaWVsZExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdGltZW91dCkge31cblxuXHRcdHJldHVybiB7XG5cdFx0XHRsaW5rOiBkckZpZWxkTGluayxcblx0XHRcdHJlc3RyaWN0OiAnQUVDJyxcblx0XHRcdHNjb3BlOiB7fSxcblx0XHRcdHRlbXBsYXRlOiAkdGVtcGxhdGVDYWNoZS5nZXQoJ2RyRmllbGQvZHJGaWVsZC5odG1sJyksXG5cdFx0XHRjb250cm9sbGVyOiBkckZpZWxkQ3RybCxcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NmJyxcblx0XHRcdGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0XHRcdFx0Y2VsbENsaWNrOiAnPT8nLFxuXHRcdFx0XHRzaXplOiAnPT8nLFxuXHRcdFx0XHRjdHg6ICc9Pydcblx0XHRcdH1cblx0XHR9O1xuXHR9XSk7XG5cblx0dmFyIGRyRmllbGRDdHJsID0gZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyRmllbGRDdHJsKGRyRmllbGRTZXJ2aWNlLCBkckZpbGVkRmFjdG9yeSwgJHNjb3BlLCAkdGltZW91dCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIGRyRmllbGRDdHJsKTtcblxuXHRcdFx0dGhpcy5kckZpZWxkU2VydmljZSA9IGRyRmllbGRTZXJ2aWNlO1xuXHRcdFx0dGhpcy5kckZpbGVkRmFjdG9yeSA9IGRyRmlsZWRGYWN0b3J5O1xuXHRcdFx0aWYgKHRoaXMuc2l6ZSkgdGhpcy5kckZpbGVkRmFjdG9yeS5zaXplID0gdGhpcy5zaXplO1xuXHRcdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0XHR0aGlzLiR0aW1lb3V0ID0gJHRpbWVvdXQ7XG5cblx0XHRcdHRoaXMuaW5pdCgpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQn9GA0Lgg0LjQvdGG0LjQsNC70LjQt9Cw0YbQuNC4INGB0L7Qt9C00LDQtdC8INC80LDRgdGB0LjQslxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKGRyRmllbGRDdHJsLCBbe1xuXHRcdFx0a2V5OiAnaW5pdCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcblx0XHRcdFx0dGhpcy5jZWxscyA9IHRoaXMuZHJGaWVsZFNlcnZpY2UuY3JlYXRlTmV3QXJyKHRoaXMuc2l6ZSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICog0JrQu9C40Log0L/QviDRj9GH0LXQudC60LVcbiAgICAqID09INGB0L7QsdGL0YLQuNC1LCDRj9GH0LXQudC60LAsINC40L3QtNC10LrRgSDQsiDQvNCw0YHRgdC40LLQtSA9PVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdjZWxsQ0xpY2snLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGNlbGxDTGljayhlLCBjZWxsLCBpZHgpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRcdGlmIChjZWxsLnN0YXRlID09PSAnZGVmYXVsdCcpIHtcblx0XHRcdFx0XHQvLyDQmtC70LjQuiDQv9C+INGP0YfQtdC50LrQtSDRgSDQtNC10YTQvtC70YLQvdGL0Lwg0YHRgtCw0YLRg9GB0L7QvC4g0JTQtdC70LDQtdC8INC10ZEg0LDQutGC0LjQstC90L7QuSDQuCDQstGL0LTQtdC70Y/QtdC8INC/0LDRgdGB0LjQstC+0Lwg0LHQu9C40LbQsNC50YjQuNC1INGP0YfQtdC50LrQuFxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jZWxscy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jZWxsc1tpXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHR9dGhpcy5hY3RpdmVDZWxsID0gY2VsbDtcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGwuc3RhdGUgPSAnYWN0aXZlJztcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGxJZHggPSBpZHg7XG5cdFx0XHRcdFx0dGhpcy5kckZpZWxkU2VydmljZS5tYXJrQ2xvc2VzdENlbGwoaWR4LCAncGFzc2l2ZScpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGNlbGwuc3RhdGUgPT09ICdwYXNzaXZlJykge1xuXHRcdFx0XHRcdC8vINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1INGBINC/0LDRgdGB0LjQstC90YvQvCDRgdGC0LDRgtGD0YHQvtC8XG5cdFx0XHRcdFx0dGhpcy5kckZpZWxkU2VydmljZS5yZXBsYWNlRWxlbWVudHModGhpcy5hY3RpdmVDZWxsSWR4LCBpZHgpO1xuXHRcdFx0XHRcdHRoaXMuJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy5kckZpZWxkU2VydmljZVxuXHRcdFx0XHRcdFx0Ly8gVE9ETzog0L/QviDRgtCw0LnQvNCw0YPRgtGDINGA0LXQsNC70LjQt9C+0LLQsNGC0Ywg0YHQu9GD0LTQtdGO0YnQtdC1INC/0L7QstC10LTQtdC90LjQtTog0L/QtdGA0LXRidC10L3QvdGL0Lkg0LDQutGC0LjQstC90YvQuSDRjdC70LXQvNC10L3RgiDQvtGB0YLQsNGR0YLRgdGPINCw0LrRgtC40LLQvdGL0Lwg0L3QsCDQvdC+0LLQvtC8INC80LXRgdGC0LVcblx0XHRcdFx0XHRcdC8vIFRPRE86INCy0YvQtNC10LvQuNGC0Ywg0L3QvtCy0YvQtSDQv9Cw0YHRgdC40LLQvdGL0LUg0Y3Qu9C10LzQtdC90YLRi1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoY2VsbC5zdGF0ZSA9PT0gJ2FjdGl2ZScpIHtcblx0XHRcdFx0XHQvLyDQmtC70LjQuiDQv9C+INGP0YfQtdC50LrQtSDRgSDQsNC60YLQuNCy0L3Ri9C8INGB0YLQsNGC0YPRgdC+0LwuINCh0L3QuNC80LDQtdC8INCw0LrRgtC40LLQvdC+0YHRgtGMINGBINC90LXRkSDQuCDQsdC70LjQttCw0LnRiNC40YVcblx0XHRcdFx0XHRjZWxsLnN0YXRlID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGxJZHggPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0dGhpcy5kckZpZWxkU2VydmljZS5tYXJrQ2xvc2VzdENlbGwoaWR4LCAnZGVmYXVsdCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIGRyRmllbGRDdHJsO1xuXHR9KCk7XG5cblx0ZHJGaWVsZEN0cmwuJGluamVjdCA9IFsnZHJGaWVsZFNlcnZpY2UnLCAnZHJGaWxlZEZhY3RvcnknLCAnJHNjb3BlJywgJyR0aW1lb3V0J107XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuc2VydmljZSgnZHJGaWVsZFNlcnZpY2UnLCBbJ2RyRmlsZWRGYWN0b3J5JywgJyR0aW1lb3V0JywgZnVuY3Rpb24gKGRyRmlsZWRGYWN0b3J5LCAkdGltZW91dCkge1xuXHRcdC8qKlxuICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IHByaXZhdGUgbWV0aG9kcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgKi9cblx0XHR2YXIgX3NlbGYgPSB0aGlzO1xuXHRcdHRoaXMubWF0cml4TW9kZWwgPSBbXTtcblx0XHR2YXIgX21tID0gdGhpcy5tYXRyaXhNb2RlbDtcblx0XHR0aGlzLnBvaW50cyA9IHtcblx0XHRcdGxhc3REZWw6IFtdLFxuXHRcdFx0bGFzdFBvaW50czogMCxcblx0XHRcdGFsbFBvaW50czogMFxuXHRcdH07XG5cblx0XHR0aGlzLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy5wb2ludHMubGFzdERlbC5sZW5ndGggPSAwO1xuXHRcdFx0dGhpcy5wb2ludHMubGFzdFBvaW50cyA9IDA7XG5cdFx0XHR0aGlzLnBvaW50cy5hbGxQb2ludHMgPSAwO1xuXHRcdH07XG5cblx0XHQvKipcbiAgICog0JLQvtC30LLRgNCw0YnQsNC10Lwg0YDQsNC90LTQvtC80L3Ri9C5INGN0LvQtdC80LXQvdGCINC80LDRgdGB0LjQstCwXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJldHVyblJhbmRFbGVtZW50KGFycikge1xuXHRcdFx0dmFyIGlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFyci5sZW5ndGgpO1xuXHRcdFx0cmV0dXJuIGFycltpZHhdO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQktC+0LfQstGA0LDRidCw0LXQvCDRgNCw0L3QtNC+0LzQvdGL0Lkg0Y3Qu9C10LzQtdC90YIg0LzQsNGB0YHQuNCy0LAsINC40YHQutC70Y7Rh9Cw0Y8g0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LIg0YTRg9C90LrRhtC40Y5cbiAgICovXG5cdFx0ZnVuY3Rpb24gcmV0dXJuQW5vdGhlclR5cGUocmVwZWF0VHlwZXMpIHtcblx0XHRcdHZhciBuZXdBcnIgPSBhbmd1bGFyLmNvcHkoZHJGaWxlZEZhY3RvcnkudHlwZXMpO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJlcGVhdFR5cGVzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbmV3QXJyLmxlbmd0aDsgaiArPSAxKSB7XG5cdFx0XHRcdFx0aWYgKHJlcGVhdFR5cGVzW2ldID09PSBuZXdBcnJbal0pIG5ld0Fyci5zcGxpY2UoaiwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJldHVyblJhbmRFbGVtZW50KG5ld0Fycik7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCk0YPQvdC60YbQuNGPINC/0YDQvtGB0YLQsNCy0LvRj9C10YIg0Y3Qu9C10LzQtdC90YLRi9C8INC80LDRgdGB0LjQstCwINC60L7QvtGA0LTQuNC90LDRgtGLICjQv9C+0LvRjyBcImNvbFwiLCBcInJvd1wiKSDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YJcbiAgICog0LLRgtC+0YDQvtCz0L4g0L/QsNGA0LDQvNC10YLRgNCwIHNpemUgKNGI0LjRgNC40L3QsCDQvNCw0YHRgdC40LLQsClcbiAgICovXG5cdFx0ZnVuY3Rpb24gc2V0Q29vcmRzVG9FbGVtZW50cygpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgX21tLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdF9tbVtpXS5jb2wgPSBpICUgX3NlbGYuc2l6ZTtcblx0XHRcdFx0X21tW2ldLnJvdyA9IE1hdGguZmxvb3IoaSAvIF9zZWxmLnNpemUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0LjQvdC40LzQsNC10YIg0LzQsNGB0YHQuNCyLCDQsiDQutC+0YLQvtGA0YvQuSDQtNC+0LHQsNCy0LvRj9C10YIg0L3QvtCy0YvQuSDRjdC70LXQvNC10L3Rgi5cbiAgICog0J/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4INCy0YvQv9C+0LvQvdGP0LXRgiDQtNCy0LUg0L/RgNC+0LLQtdGA0LrQuDpcbiAgICogLSDQtdGB0LvQuCDRgtC40L/RiyDQtNCy0YPRhSDQv9GA0LXQtNGL0LTRg9GJ0LjRhSDQvtCx0YrQtdC60YIg0YDQsNCy0L3RiyDRgtC10LrRg9GJ0LXQvNGDINGB0LPQtdC90LXRgNC40YDQvtCy0LDQvdC90L7QvNGDINGC0LjQv9GDLCDRgtC+INCz0LXQvdC10YDQuNGA0YPQtdC8INC90L7QstGL0LlcbiAgICogLSDQtdGB0LvQuCDRgtC40L/RiyDQtNCy0YPRhSDQvtCx0YrQtdC60YLQvtCyINC90LDQtCDRgtC10LrRg9C30LjQvCDRgNCw0LLQvdGLINGC0LXQutGD0YnQtdC80YMg0YHQs9C10L3QtdGA0LjRgNC+0LLQsNC90L3QvtC80YMg0YLQuNC/0YMsINGC0L4g0LPQtdC90LXRgNC40YDRg9C10Lwg0L3QvtCy0YvQuVxuICAgKi9cblx0XHRmdW5jdGlvbiByZXR1cm5UeXBlRm9yTmV3RWxlbWVudChpZHgpIHtcblx0XHRcdC8vINCf0YDQvtCy0LXRgNC60Lgg0L3QsCDQs9C+0YDQuNC30L7QvdGC0LDQu9GM0L3Ri9C1INC4INCy0LXRgNGC0LjQutCw0LvRjNC90YvQtSDRgdC+0LLQv9Cw0LTQtdC90LjRjyDQv9GA0Lgg0LPQtdC90LXRgNCw0YbQuNC4XG5cdFx0XHR2YXIgcmVwZWF0VHlwZXMgPSBjaGVja0R1cGUoaWR4KTtcblxuXHRcdFx0dmFyIHR5cGUgPSByZXBlYXRUeXBlcy5sZW5ndGggPyByZXR1cm5Bbm90aGVyVHlwZShyZXBlYXRUeXBlcykgOiByZXR1cm5SYW5kRWxlbWVudChkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdHJldHVybiB0eXBlO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQn9GA0L7QstC10YDQutCwINC90LAg0L/QvtCy0YLQvtGA0LXQvdC40LVcbiAgICovXG5cdFx0ZnVuY3Rpb24gY2hlY2tEdXBlKGlkeCkge1xuXHRcdFx0dmFyIHMgPSBfc2VsZi5zaXplO1xuXHRcdFx0dmFyIHJlc3VsdCA9IFtdO1xuXG5cdFx0XHR2YXIgY29sSWR4ID0gX21tLmxlbmd0aCAlIHM7XG5cdFx0XHRpZiAoY29sSWR4ID4gMSkge1xuXHRcdFx0XHRpZiAoX21tW19tbS5sZW5ndGggLSAyXS50eXBlID09PSBfbW1bX21tLmxlbmd0aCAtIDFdLnR5cGUpIHtcblx0XHRcdFx0XHRyZXN1bHQucHVzaChfbW1bX21tLmxlbmd0aCAtIDFdLnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhciByb3dJZHggPSBNYXRoLmZsb29yKF9tbS5sZW5ndGggLyBzKTtcblx0XHRcdGlmIChyb3dJZHggPiAxKSB7XG5cdFx0XHRcdGlmIChfbW1bX21tLmxlbmd0aCAtIHNdLnR5cGUgPT09IF9tbVtfbW0ubGVuZ3RoIC0gcyAqIDJdLnR5cGUpIHtcblx0XHRcdFx0XHRyZXN1bHQucHVzaChfbW1bX21tLmxlbmd0aCAtIHNdLnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vINCV0YHQu9C4INC80LjQvdC40LzRg9C8INGC0YDQtdGC0LjQuSDRjdC70LXQvNC10L3RgiDQsiDRgdGC0YDQvtC60LVcblx0XHRcdGlmIChpZHggLSBNYXRoLmZsb29yKGlkeCAvIHMpICogcyA+IDEpIHtcblx0XHRcdFx0Ly/QldGB0LvQuCDQv9GA0LXQtNGL0LTRg9GJ0LjQtSDQtNCy0LAg0Y3Qu9C10LzQtdC90YLQsCDQsiDRgdGC0YDQvtC60LUg0YHRg9GJ0LXRgdGC0LLRg9GO0YIg0Lgg0LjRhSDRgtC40L/RiyDRgdC+0LLQv9Cw0LTQsNGO0YIsINGC0L4g0LjRgdC60LvRjtGH0LDQtdC8INGC0LjQv1xuXHRcdFx0XHRpZiAoX21tW2lkeCAtIDFdICYmIF9tbVtpZHggLSAyXSAmJiBfbW1baWR4IC0gMV0udHlwZSA9PT0gX21tW2lkeCAtIDJdLnR5cGUpIHJlc3VsdC5wdXNoKF9tbVtpZHggLSAxXS50eXBlKTtcblx0XHRcdH1cblx0XHRcdC8vINCV0YHQu9C4INC30LAg0L3QuNC8INC10YHRgtGMINC80LjQvdC40LzRg9C8INC00LLQsCDRjdC70LXQvNC10L3RgtCwINCyINGB0YLRgNC+0LrQtVxuXHRcdFx0aWYgKE1hdGguY2VpbChpZHggLyBzKSAqIHMgLSBpZHggPiAxKSB7XG5cdFx0XHRcdC8v0JXRgdC70Lgg0YHQu9C10LTRg9GO0YnQuNC1INC00LLQsCDRjdC70LXQvNC10L3RgtCwINCyINGB0YLRgNC+0LrQtSDRgdGD0YnQtdGB0YLQstGD0Y7RgiDQuCDQuNGFINGC0LjQv9GLINGB0L7QstC/0LDQtNCw0Y7Rgiwg0YLQviDQuNGB0LrQu9GO0YfQsNC10Lwg0YLQuNC/XG5cdFx0XHRcdGlmIChfbW1baWR4ICsgMV0gJiYgX21tW2lkeCArIDJdICYmIF9tbVtpZHggKyAxXS50eXBlID09PSBfbW1baWR4ICsgMl0udHlwZSkgcmVzdWx0LnB1c2goX21tW2lkeCArIDFdLnR5cGUpO1xuXHRcdFx0fVxuXHRcdFx0Ly8g0JXRgdC70Lgg0YHQstC10YDRhdGDINC90LDQtCDQvdC40Lwg0LXRgdGC0Ywg0LzQuNC90LjQvNGD0Lwg0LTQstCwINGN0LvQtdC80LXQvdGC0LAg0LIg0YHRgtC+0LvQsdGG0LVcblx0XHRcdGlmIChNYXRoLmNlaWwoaWR4IC8gcykgPiAyKSB7XG5cdFx0XHRcdC8v0JXRgdC70Lgg0LTQstCwINGN0LvQtdC80LXQvdGC0LAg0YHQstC10YDRhdGDINCyINGB0YLQvtC70LHRhtC1INGB0YPRidC10YHRgtCy0YPRjtGCINC4INC40YUg0YLQuNC/0Ysg0YHQvtCy0L/QsNC00LDRjtGCLCDRgtC+INC40YHQutC70Y7Rh9Cw0LXQvCDRgtC40L9cblx0XHRcdFx0aWYgKF9tbVtpZHggLSBzXSAmJiBfbW1baWR4IC0gcyAqIDJdICYmIF9tbVtpZHggLSBzXS50eXBlID09PSBfbW1baWR4IC0gcyAqIDJdLnR5cGUpIHJlc3VsdC5wdXNoKF9tbVtpZHggLSBzXS50eXBlKTtcblx0XHRcdH1cblx0XHRcdC8vINCV0YHQu9C4INGB0L3QuNC30YMg0L/QvtC0INC90LjQvCDQtdGB0YLRjCDQvNC40L3QuNC80YPQvCDQtNCy0LAg0Y3Qu9C10LzQtdC90YLQsCDQsiDRgdGC0L7Qu9Cx0YbQtVxuXHRcdFx0aWYgKHMgLSBNYXRoLmNlaWwoaWR4IC8gcykgPiAyKSB7XG5cdFx0XHRcdC8v0JXRgdC70Lgg0LTQstCwINGN0LvQtdC80LXQvdGC0LAg0YHQvdC40LfRgyDQsiDRgdGC0L7Qu9Cx0YbQtSDRgdGD0YnQtdGB0YLQstGD0Y7RgiDQuCDQuNGFINGC0LjQv9GLINGB0L7QstC/0LDQtNCw0Y7Rgiwg0YLQviDQuNGB0LrQu9GO0YfQsNC10Lwg0YLQuNC/XG5cdFx0XHRcdGlmIChfbW1baWR4ICsgc10gJiYgX21tW2lkeCArIHMgKiAyXSAmJiBfbW1baWR4ICsgc10udHlwZSA9PT0gX21tW2lkeCArIHMgKiAyXS50eXBlKSByZXN1bHQucHVzaChfbW1baWR4ICsgc10udHlwZSk7XG5cdFx0XHR9XG5cdFx0XHQvLyDQldGB0LvQuCDQvNC40L3QuNC80YPQvCDQstGC0L7RgNC+0Lkg0Lgg0LzQuNC90LjQvNGD0Lwg0L/RgNC10LTQv9C+0YHQu9C10LTQvdC40Lkg0Y3Qu9C10LzQtdC90YJcblx0XHRcdGlmIChpZHggLSBNYXRoLmZsb29yKGlkeCAvIHMpICogcyA+IDAgJiYgTWF0aC5jZWlsKGlkeCAvIHMpICogcyAtIGlkeCA+IDApIHtcblx0XHRcdFx0Ly8g0JXRgdC70Lgg0YLQuNC/0Ysg0Y3Qu9C10LzQtdC90YLQvtCyINC/0LXRgNC10LQg0L3QuNC8INC4INC30LAg0L3QuNC8INGB0L7QstC/0LDQtNCw0Y7RglxuXHRcdFx0XHRpZiAoX21tW2lkeCAtIDFdICYmIF9tbVtpZHggKyAxXSAmJiBfbW1baWR4IC0gMV0udHlwZSA9PT0gX21tW2lkeCArIDFdLnR5cGUpIHJlc3VsdC5wdXNoKF9tbVtpZHggLSAxXS50eXBlKTtcblx0XHRcdH1cblx0XHRcdC8vINCV0YHQu9C4INC90LDQtCDQvdC40Lwg0Lgg0L/QvtC0INC90LjQvCDQtdGB0YLRjCDRjdC70LXQvNC10L3RgtGLXG5cdFx0XHRpZiAoTWF0aC5jZWlsKGlkeCAvIHMpID4gMSAmJiBzIC0gTWF0aC5jZWlsKGlkeCAvIHMpID4gMSkge1xuXHRcdFx0XHQvLyDQldGB0LvQuCDRgtC40L/RiyDRjdC70LXQvNC10L3RgtC+0LIg0L/QvtC0INC90LjQvCDQuCDQvdCw0LQg0L3QuNC8INGB0L7QstC/0LDQtNCw0Y7RglxuXHRcdFx0XHRpZiAoX21tW2lkeCAtIHNdICYmIF9tbVtpZHggKyBzXSAmJiBfbW1baWR4IC0gc10udHlwZSA9PT0gX21tW2lkeCArIHNdLnR5cGUpIHJlc3VsdC5wdXNoKF9tbVtpZHggLSBzXS50eXBlKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0KTRg9C90LrRhtC40Y8g0L/RgNC+0LLQtdGA0Y/QtdGCINC90LAg0LPQvtGA0LjQt9C+0L3RgtCw0LvRjNC90YvQtSDRgdC+0LLQv9Cw0LTQtdC90LjRj1xuICAgKi9cblx0XHRmdW5jdGlvbiBjb3VudFJlcGVhdEluUm93KHJlc3VsdCkge1xuXHRcdFx0dmFyIHNpemUgPSBfc2VsZi5zaXplO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IF9tbS5sZW5ndGg7IGkgKz0gc2l6ZSkge1xuXHRcdFx0XHR2YXIgZGVsSWR4QXJyID0gW2ldLFxuXHRcdFx0XHQgICAgY3VycmVudFR5cGUgPSBfbW1baV0udHlwZTtcblxuXHRcdFx0XHRuZXh0OiBmb3IgKHZhciBqID0gMTsgaiA8IHNpemU7IGogKz0gMSkge1xuXHRcdFx0XHRcdGlmIChfbW1baSArIGpdLnR5cGUgPT09ICdlbXB0eScgfHwgY3VycmVudFR5cGUgIT09IF9tbVtpICsgal0udHlwZSkge1xuXHRcdFx0XHRcdFx0aWYgKGRlbElkeEFyci5sZW5ndGggPiAyKSBicmVhaztcblx0XHRcdFx0XHRcdGRlbElkeEFyci5sZW5ndGggPSAwO1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLnB1c2goaSArIGopO1xuXHRcdFx0XHRcdFx0Y3VycmVudFR5cGUgPSBfbW1baSArIGpdLnR5cGU7XG5cdFx0XHRcdFx0XHRjb250aW51ZSBuZXh0O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIucHVzaChpICsgaik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChkZWxJZHhBcnIubGVuZ3RoID4gMikge1xuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0XHRcdGxlbmd0aDogZGVsSWR4QXJyLmxlbmd0aCxcblx0XHRcdFx0XHRcdHR5cGU6IGN1cnJlbnRUeXBlLFxuXHRcdFx0XHRcdFx0aWR4QXJyOiBhbmd1bGFyLmNvcHkoZGVsSWR4QXJyKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGRlbElkeEFyci5sZW5ndGggPSAwO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0L7QstC10YDRj9C10YIg0L3QsCDQstC10YDRgtC40LrQsNC70YzQvdGL0LUg0YHQvtCy0L/QsNC00LXQvdC40Y9cbiAgICovXG5cdFx0ZnVuY3Rpb24gY291bnRSZXBlYXRJbkNvbChyZXN1bHQpIHtcblx0XHRcdHZhciBzaXplID0gX3NlbGYuc2l6ZTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpICs9IDEpIHtcblx0XHRcdFx0dmFyIGRlbElkeEFyciA9IFtpXSxcblx0XHRcdFx0ICAgIGN1cnJlbnRUeXBlID0gX21tW2ldLnR5cGU7XG5cblx0XHRcdFx0bmV4dDogZm9yICh2YXIgaiA9IDE7IGogPCBzaXplOyBqICs9IDEpIHtcblx0XHRcdFx0XHRpZiAoX21tW2kgKyBqICogc2l6ZV0udHlwZSA9PT0gJ2VtcHR5JyB8fCBjdXJyZW50VHlwZSAhPT0gX21tW2kgKyBqICogc2l6ZV0udHlwZSkge1xuXHRcdFx0XHRcdFx0aWYgKGRlbElkeEFyci5sZW5ndGggPiAyKSBicmVhaztcblx0XHRcdFx0XHRcdGRlbElkeEFyci5sZW5ndGggPSAwO1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLnB1c2goaSArIGogKiBzaXplKTtcblx0XHRcdFx0XHRcdGN1cnJlbnRUeXBlID0gX21tW2kgKyBqICogc2l6ZV0udHlwZTtcblx0XHRcdFx0XHRcdGNvbnRpbnVlIG5leHQ7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGRlbElkeEFyci5wdXNoKGkgKyBqICogc2l6ZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChkZWxJZHhBcnIubGVuZ3RoID4gMikge1xuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0XHRcdGxlbmd0aDogZGVsSWR4QXJyLmxlbmd0aCxcblx0XHRcdFx0XHRcdHR5cGU6IGN1cnJlbnRUeXBlLFxuXHRcdFx0XHRcdFx0aWR4QXJyOiBhbmd1bGFyLmNvcHkoZGVsSWR4QXJyKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGRlbElkeEFyci5sZW5ndGggPSAwO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IHB1YmxpYyBtZXRob2RzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAqL1xuXG5cdFx0LyoqXG4gICAqINCc0LXRgtC+0LQg0YHQtdGA0LLQuNGB0LAg0LLQvtC30LLRgNCw0YnQsNC10YIg0L3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0LTQu9C40L3QvtC5IHNpemUqc2l6ZVxuICAgKi9cblx0XHR0aGlzLmNyZWF0ZU5ld0FyciA9IGZ1bmN0aW9uIChzaXplKSB7XG5cdFx0XHRfbW0ubGVuZ3RoID0gMDtcblx0XHRcdHRoaXMuc2l6ZSA9IHNpemUgfHwgZHJGaWxlZEZhY3Rvcnkuc2l6ZTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzaXplICogc2l6ZTsgaSsrKSB7XG5cdFx0XHRcdHZhciB0eXBlID0gcmV0dXJuVHlwZUZvck5ld0VsZW1lbnQoKTtcblx0XHRcdFx0X21tLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBpLFxuXHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0c3RhdGU6ICdkZWZhdWx0J1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0c2V0Q29vcmRzVG9FbGVtZW50cygpO1xuXG5cdFx0XHRyZXR1cm4gX21tO1xuXHRcdH07XG5cblx0XHQvKipcbiAgICog0JfQsNC00LDQtdC8INGB0L7RgdGC0L7Rj9C90LjQtSDQsdC70LjQttCw0LnRiNC40Lwg0Y3Qu9C10LzQtdC90YLQsNC8INC+0YIg0LLRi9C00LXQu9C10L3QvdC+0LPQvlxuICAgKi9cblx0XHR0aGlzLm1hcmtDbG9zZXN0Q2VsbCA9IGZ1bmN0aW9uIChpZHgsIHN0YXRlKSB7XG5cdFx0XHR2YXIgc2l6ZSA9IF9zZWxmLnNpemU7XG5cblx0XHRcdGlmIChfbW1baWR4IC0gc2l6ZV0pIF9tbVtpZHggLSBzaXplXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKF9tbVtpZHggKyBzaXplXSkgX21tW2lkeCArIHNpemVdLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRpZiAoX21tW2lkeCAtIDFdKSBfbW1baWR4IC0gMV0uc3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChfbW1baWR4ICsgMV0pIF9tbVtpZHggKyAxXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdH07XG5cblx0XHQvKipcbiAgICog0JzQtdC90Y/QtdC8INC80LXRgdGC0LDQvNC4INGP0YfQtdC50LrQuC4g0JDQu9Cz0L7RgNC40YLQvDpcbiAgICogLSDRgdC90LDRh9Cw0LvQsCDQvNC10L3Rj9C10Lwg0L/QsNGA0LDQvNC10L3RgtGA0YsgY29sL3JvdyAo0LTQu9GPINCw0L3QuNC80LDRhtC4KS5cbiAgICogLSDQv9C+0YHQu9C1INC/0L4g0YLQsNC50LzQsNGD0YLRgyDQvNC10L3Rj9C10Lwg0LTQsNC90L3Ri9C1INC+0LHRitC10LrRgtC+0LIg0LIg0YHQsNC80L7QvCDQvNCw0YHRgdC40LLQtSAo0YTQuNCz0YPRgNGDKVxuICAgKi9cblx0XHR0aGlzLnJlcGxhY2VFbGVtZW50cyA9IGZ1bmN0aW9uIChpZHgxLCBpZHgyKSB7XG5cdFx0XHR2YXIgdGVtcCA9IHtcblx0XHRcdFx0Y29sMTogX21tW2lkeDFdLmNvbCxcblx0XHRcdFx0cm93MTogX21tW2lkeDFdLnJvdyxcblx0XHRcdFx0Y29sMjogX21tW2lkeDJdLmNvbCxcblx0XHRcdFx0cm93MjogX21tW2lkeDJdLnJvd1xuXHRcdFx0fTtcblxuXHRcdFx0X21tW2lkeDFdLmNvbCA9IHRlbXAuY29sMjtcblx0XHRcdF9tbVtpZHgxXS5yb3cgPSB0ZW1wLnJvdzI7XG5cblx0XHRcdF9tbVtpZHgyXS5jb2wgPSB0ZW1wLmNvbDE7XG5cdFx0XHRfbW1baWR4Ml0ucm93ID0gdGVtcC5yb3cxO1xuXG5cdFx0XHRfbW0uc29ydChzb3J0QXJyQnlSb3dDb2wpO1xuXG5cdFx0XHRyZWN1ckRlbGV0ZUVsKCk7XG5cblx0XHRcdC8vICR0aW1lb3V0KCgpPT57XG5cdFx0XHQvLyBcdF9tbS5zb3J0KHNvcnRBcnJCeVJvd0NvbCk7XG5cdFx0XHQvL1xuXHRcdFx0Ly8gXHRyZWN1ckRlbGV0ZUVsKCk7XG5cdFx0XHQvLyB9LCAyMDApO1xuXG5cdFx0XHQvLyBnZW5lcmF0ZU5ld0VsKCk7XG5cblx0XHRcdC8vcmVjdXJEZWxldGVFbCgpOyAvLyDQstGA0LXQvNC10L3QvdGL0Lkg0YXQsNC6XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQk9C10L3QtdGA0LjRgNGD0LXQvCDQvdC+0LLRi9C1INGN0LvQtdC80LXQvdGC0YtcbiAgICovXG5cdFx0ZnVuY3Rpb24gZ2VuZXJhdGVOZXdFbCgpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgX21tLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdGlmIChfbW1baV0udHlwZSA9PT0gJ2VtcHR5JykgX21tW2ldLnR5cGUgPSByZXR1cm5UeXBlRm9yTmV3RWxlbWVudChpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICog0J/RgNC+0LLQtdGA0Y/QtdC8INC90LAg0L7QsdGK0LXQutGC0Ysg0L7QtNC40L3QsNC60L7QstC+0LPQviDRgtC40L/QsCDQsiDRgdGC0YDQvtC60LDRhVxuICAgKi9cblx0XHRmdW5jdGlvbiByZWN1ckRlbGV0ZUVsKCkge1xuXHRcdFx0dmFyIHJlc3VsdCA9IFtdO1xuXG5cdFx0XHRjb3VudFJlcGVhdEluUm93KHJlc3VsdCk7XG5cdFx0XHRjb3VudFJlcGVhdEluQ29sKHJlc3VsdCk7XG5cblx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgX21tLmxlbmd0aDsgaiArPSAxKSB7XG5cdFx0XHRcdF9tbVtqXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdH1pZiAoIXJlc3VsdC5sZW5ndGgpIHtcblx0XHRcdFx0dmFyIG1hcmtlciA9IGZhbHNlO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IF9tbS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRcdGlmIChfbW1baV0udHlwZSA9PT0gJ2VtcHR5Jykge1xuXHRcdFx0XHRcdFx0bWFya2VyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobWFya2VyKSB7XG5cdFx0XHRcdFx0Z2VuZXJhdGVOZXdFbCgpO1xuXHRcdFx0XHRcdHJlY3VyRGVsZXRlRWwoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0bWFya0RlbGV0ZUVsKHJlc3VsdCk7XG5cblx0XHRcdFx0Y2FsY3VsYXRlUG9pbnRzSW5mbyhyZXN1bHQpO1xuXG5cdFx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRfc2VsZi5kZWxldGVFbGVtZW50cyhyZXN1bHQpO1xuXG5cdFx0XHRcdFx0X3NlbGYubW92ZVRvcEVsKCk7XG5cblx0XHRcdFx0XHRfbW0uc29ydChzb3J0QXJyQnlSb3dDb2wpO1xuXG5cdFx0XHRcdFx0cmVjdXJEZWxldGVFbCgpO1xuXHRcdFx0XHR9LCA1MDApO1xuXHRcdFx0fSwgMjUwKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBtYXJrRGVsZXRlRWwocmVzdWx0KSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHR2YXIgb2JqID0gcmVzdWx0W2ldO1xuXHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IG9iai5pZHhBcnIubGVuZ3RoOyBqICs9IDEpIHtcblx0XHRcdFx0XHRfbW1bb2JqLmlkeEFycltqXV0uc3RhdGUgPSAnZGVsZXRlJztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNhbGN1bGF0ZVBvaW50c0luZm8ocmVzdWx0KSB7XG5cdFx0XHRfc2VsZi5wb2ludHMubGFzdERlbC5sZW5ndGggPSAwO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0dmFyIHR5cGUgPSByZXN1bHRbaV0udHlwZTtcblx0XHRcdFx0dmFyIHBvaW50cyA9IGRyRmlsZWRGYWN0b3J5LnBvaW50c01hcFt0eXBlXSAqIHJlc3VsdFtpXS5sZW5ndGg7XG5cdFx0XHRcdF9zZWxmLnBvaW50cy5sYXN0UG9pbnRzID0gcG9pbnRzO1xuXHRcdFx0XHRfc2VsZi5wb2ludHMuYWxsUG9pbnRzICs9IHBvaW50cztcblx0XHRcdFx0X3NlbGYucG9pbnRzLmxhc3REZWwucHVzaChyZXN1bHRbaV0ubGVuZ3RoICsgJyAnICsgdHlwZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCj0LTQsNC70Y/QtdC8INC+0LHRitC10LrRgtGLINC+0LTQuNC90LDQutC+0LLQvtCz0L4g0YLQuNC/0LAsINC10YHQu9C4INC40YUg0LHQvtC70YzRiNC1INGC0YDRkdGFINCyINGB0YLRgNC+0LrQtSDQuNC70Lgg0LIg0LrQvtC70L7QvdC60LVcbiAgICovXG5cdFx0dGhpcy5kZWxldGVFbGVtZW50cyA9IGZ1bmN0aW9uIChkZWxBcnIpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGVsQXJyLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdHZhciBsaW5lID0gZGVsQXJyW2ldO1xuXG5cdFx0XHRcdC8vINGD0LTQsNC70Y/QtdC80YvQvCDRj9GH0LXQudC60LDQvCDQv9GA0LjRgdCy0LDQuNCy0LDQtdC8INGC0LjQvyBcImVtcHR5XCJcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBsaW5lLmlkeEFyci5sZW5ndGg7IGogKz0gMSkge1xuXHRcdFx0XHRcdF9tbVtsaW5lLmlkeEFycltqXV0udHlwZSA9ICdlbXB0eSc7XG5cdFx0XHRcdH0gLy8g0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0LjQvCDRgdGC0LDRgtGD0YEgXCJkZWZhdWx0XCJcblx0XHRcdFx0Zm9yICh2YXIgX2ogPSAwOyBfaiA8IF9tbS5sZW5ndGg7IF9qICs9IDEpIHtcblx0XHRcdFx0XHRfbW1bX2pdLnN0YXRlID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQldGB0LvQuCDQvdCw0LQg0L/Rg9GB0YLRi9C80Lgg0LzQtdGB0YLQsNC80Lgg0L7RgdGC0LDQu9C40YHRjCDRhNC40LPRg9GA0YsgLSDQvtC/0YPRgdC60LDQtdC8INC40YVcbiAgICovXG5cdFx0dGhpcy5tb3ZlVG9wRWwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvLyDQnNCw0YHRgdC40LIsINC60L7RgtC+0YDRi9C5INGF0YDQsNC90LjRgiDQuNC90LTQtdC60YHRiyDRgSDQv9GD0YHRgtGL0LzQuCDRjdC70LXQvNC10L3RgtCw0LzQuFxuXHRcdFx0dmFyIHNpemUgPSBkckZpbGVkRmFjdG9yeS5zaXplO1xuXG5cdFx0XHRuZXh0OiBmb3IgKHZhciBjb3VudCA9IDAsIGkgPSAwLCBlbXB0eUNvdW50ID0gMCwgZW1wdHlTdGFydElkeDsgaSA8IF9tbS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRpZiAoaSA+IDAgJiYgaSAlIHNpemUgPT09IDApIHtcblx0XHRcdFx0XHRlbXB0eVN0YXJ0SWR4ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGVtcHR5Q291bnQgPSAwO1xuXHRcdFx0XHRcdGNvdW50Kys7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgcm93SWR4ID0gaSAlIHNpemUgKiBzaXplICsgY291bnQ7XG5cblx0XHRcdFx0aWYgKF9tbVtyb3dJZHhdLnR5cGUgPT09ICdlbXB0eScpIHtcblx0XHRcdFx0XHRpZiAoIWVtcHR5U3RhcnRJZHgpIGVtcHR5U3RhcnRJZHggPSByb3dJZHg7XG5cdFx0XHRcdFx0ZW1wdHlDb3VudCsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8g0J/RgNC+0LLQtdGA0LrQsCDQvdCwINC/0L7RgdC70LXQtNC90LjQuSDRjdC70LXQvNC10L3RgiDQsiDRgdGC0L7Qu9Cx0YbQtVxuXHRcdFx0XHRpZiAoaSA+IDAgJiYgKGkgKyAxKSAlIHNpemUgPT09IDAgJiYgZW1wdHlDb3VudCA+IDApIHtcblx0XHRcdFx0XHRtb3ZlRWxlbWVudHMoZW1wdHlTdGFydElkeCwgZW1wdHlDb3VudCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0ZnVuY3Rpb24gbW92ZUVsZW1lbnRzKGVtcHR5U3RhcnRJZHgsIGVtcHR5Q291bnQpIHtcblx0XHRcdHZhciBzaXplID0gZHJGaWxlZEZhY3Rvcnkuc2l6ZTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKCfQoNCw0LHQvtGC0LDQtdC8INGB0L4g0YHRgtC+0LvQsdGG0L7QvCAnLCBjb3VudCk7XG5cdFx0XHR2YXIgY291bnRPZk1vdmFibGVFbCA9IE1hdGguZmxvb3IoZW1wdHlTdGFydElkeCAvIHNpemUpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coJ9Cf0LXRgNC10LTQstC40LPQsNC10LwgJywgY291bnRPZk1vdmFibGVFbCwgJyDQtdC70LXQvNC10L3RgtC+0LIg0LIg0YHRgtC+0LHQu9GG0LUgJywgY291bnQpO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMCwgYyA9IGVtcHR5U3RhcnRJZHg7IGkgPCBlbXB0eUNvdW50OyBpICs9IDEpIHtcblx0XHRcdFx0X21tW2NdLnJvdyAtPSBjb3VudE9mTW92YWJsZUVsO1xuXHRcdFx0XHRjICs9IHNpemU7XG5cdFx0XHR9XG5cdFx0XHRmb3IgKHZhciBfaSA9IDAsIF9jID0gZW1wdHlTdGFydElkeDsgX2kgPCBjb3VudE9mTW92YWJsZUVsOyBfaSArPSAxKSB7XG5cdFx0XHRcdF9jIC09IHNpemU7XG5cdFx0XHRcdF9tbVtfY10ucm93ICs9IGVtcHR5Q291bnQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKCfQk9C10L3QtdGA0LjRgNGD0LXQvCAnLCBlbXB0eUNvdW50LCAnINC90L7QstGL0YUg0Y3Qu9C10LzQtdC90YLQvtCyINCyINGB0YLQvtCx0LvRhtC1ICcsIGNvdW50KTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0KHQvtGA0YLQuNGA0L7QstC60LAg0LzQsNGB0YHQuNCy0LAg0L/QviDQt9C90LDRh9C10L3QuNGPIG9iai5yb3cg0Lggb2JqLmNvbCDRjdC70LXQvNC10L3RgtC+0LIuINCY0YHQv9C+0LvRjNC30YPQtdGC0YHRjyDQv9C+0YHQu9C1INC/0LXRgNC10YHRgtCw0L3QvtCy0L7QuiDQuCDRg9C00LDQu9C10L3QuNC5XG4gICAqICjQtNC70Y8g0YHQuNC90YXRgNC+0L3QuNC30LDRhtC40Lgg0LLRjNGO0YXQuCDQuCDQvNC+0LTQtdC70LgsINGCLtC6LiDQvdCwINCy0YzRjtGF0LUg0L/RgNC4INC/0LXRgNC10LzQtdGJ0LXQvdC40Lgg0LzRiyDQvdC1INC80LXQvdGP0LvQuCDQvNC+0LTQtdC70YwpXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHNvcnRBcnJCeVJvd0NvbChhLCBiKSB7XG5cdFx0XHRpZiAoYS5yb3cgIT09IGIucm93KSB7XG5cdFx0XHRcdHJldHVybiBhLnJvdyAtIGIucm93O1xuXHRcdFx0fSBlbHNlIGlmIChhLnJvdyA9PT0gYi5yb3cpIHtcblx0XHRcdFx0cmV0dXJuIGEuY29sIC0gYi5jb2w7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnZHJGaWxlZEZhY3RvcnknLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHR5cGVzID0gWydzcXVhcmUnLCAnY2lyY2xlJywgJ3RyaWFuZ2xlJ107XG5cblx0XHR2YXIgc3RhdGVzID0gWydkZWZhdWx0JywgJ2FjdGl2ZScsICdwYXNzaXZlJywgJ25vdGUnXTtcblxuXHRcdHZhciBwb2ludHNNYXAgPSB7XG5cdFx0XHRzcXVhcmU6IDEwLFxuXHRcdFx0dHJpYW5nbGU6IDIwLFxuXHRcdFx0Y2lyY2xlOiAzMFxuXHRcdH07XG5cblx0XHR2YXIgc2l6ZSA9IDU7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZXM6IHR5cGVzLFxuXHRcdFx0c3RhdGVzOiBzdGF0ZXMsXG5cdFx0XHRzaXplOiBzaXplLFxuXHRcdFx0cG9pbnRzTWFwOiBwb2ludHNNYXBcblx0XHR9O1xuXHR9KTtcbn0pKCk7Il19
