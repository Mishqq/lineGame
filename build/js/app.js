"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"])}(),angular.module("app").run(["$templateCache",function(e){e.put("drCell/drCell.html",'<div class="cell" ng-class="c.returnCellClass()">\n\t<div class="cell__fig"></div>\n</div>\n'),e.put("drField/drField.html",'<ul class="cell-list">\n\t<li class="cell-list__item"\n\t\tng-repeat="(idx, cell) in cf.cells"\n\t\tng-style="{\'left\': cell.col*60 + \'px\', \'top\': cell.row*60 + \'px\'}"\n\t\tng-click="cf.cellCLick($event, cell, idx)">\n\n\t\t<dr-cell type="{{cell.type}}" state="{{cell.state}}"></dr-cell>\n\n\t</li>\n</ul>')}]),function(){function e(e,t,l,n,r){this.$scope=e,this.$http=t,this.$state=l,this.cellState="square",this.init()}angular.module("app").controller("mainCtrl",e),e.prototype.init=function(){},e.$inject=["$scope","$http","$state","$stateParams","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}();!function(){angular.module("app").directive("drCell",["$templateCache",function(t){function l(e,t,l,n){}return{link:l,restrict:"AEC",scope:{},template:t.get("drCell/drCell.html"),controller:e,controllerAs:"c",bindToController:{type:"@?",state:"@?"}}}]);var e=function(){function e(t,l){_classCallCheck(this,e)}return _createClass(e,[{key:"returnCellClass",value:function(){var e="cell_type-"+(this.type||"square"),t="cell_state-"+(this.state||"default");return[e,t]}}]),e}();e.$inject=["$scope","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}();!function(){angular.module("app").directive("drField",["$templateCache",function(t){function l(e,t,l,n){}return{link:l,restrict:"AEC",scope:{},template:t.get("drField/drField.html"),controller:e,controllerAs:"cf",bindToController:{cellClick:"=?",size:"=?",ctx:"=?"}}}]);var e=function(){function e(t,l,n){_classCallCheck(this,e),this.drFieldService=t,this.size&&(this.drFieldService.size=this.size),this.$scope=l,this.$timeout=n,this.init()}return _createClass(e,[{key:"init",value:function(){this.cells=this.drFieldService.createNewArr(this.size)}},{key:"cellCLick",value:function(e,t,l){var n=this;if(e.preventDefault(),e.stopPropagation(),"default"===t.state){for(var r=0;r<this.cells.length;r+=1)this.cells[r].state="default";this.activeCell=t,this.activeCell.state="active",this.activeCellIdx=l,this.drFieldService.markClosestCell(this.cells,this.size,l,"passive")}else"passive"===t.state?(this.drFieldService.replaceElements(this.cells,this.activeCellIdx,l),this.$timeout(function(){for(var e=0;e<n.cells.length;e+=1)n.cells[e].state="default"},200)):"active"===t.state&&(t.state="default",this.activeCell=void 0,this.activeCellIdx=void 0,this.drFieldService.markClosestCell(this.cells,this.size,l,"default"))}}]),e}();e.$inject=["drFieldService","$scope","$timeout"]}(),function(){angular.module("app").service("drFieldService",["drFiledFactory","$timeout",function(e,t){function l(e){var t=Math.floor(Math.random()*e.length);return e[t]}function n(t){for(var n=angular.copy(e.types),r=0;r<t.length;r+=1)for(var i=0;i<n.length;i+=1)t[r]===n[i]&&n.splice(i,1);return l(n)}function r(e,t){for(var l=0;l<e.length;l+=1)e[l].col=l%t,e[l].row=Math.floor(l/t)}function i(t,r){var i=l(e.types),s=[];a(t,r,s),c(t,r,s),s.length&&(i=n(s)),t.push({type:i,state:"default"})}function a(e,t,l){var n=e.length%t;n>1&&e[e.length-2].type===e[e.length-1].type&&l.push(e[e.length-1].type)}function c(e,t,l){var n=Math.floor(e.length/t);n>1&&e[e.length-t].type===e[e.length-2*t].type&&l.push(e[e.length-t].type)}function s(e,t,l){for(var n=0;n<e.length;n+=1){for(var r=n%l,i=1,a=e[n].type,c=1;c<l-r&&e[n+c].type===a;c+=1)i++;if(i>2){for(var s=[],o=1;o<=i;o+=1)s.push(n+o);t.push({length:i,type:a,idxArr:s}),n+=i-1,i=0}else i=0}}function o(e,t,l){for(var n=0,r=0;r<e.length;r+=l){var i=Math.floor(r/l),a=1;e[r].type;console.log("---=== i ===---",r);for(var c=0;c<l-i;c+=1);a=0,Math.floor(r/l)+1===l&&(n++,r=n-l)}}this.createNewArr=function(e){for(var t=[],l=0;l<e*e;l++)i(t,e);return r(t,e),t},this.markClosestCell=function(e,t,l,n){e[l-t]&&(e[l-t].state=n),e[l+t]&&(e[l+t].state=n),e[l-1]&&(e[l-1].state=n),e[l+1]&&(e[l+1].state=n)},this.replaceElements=function(e,l,n){var r=this,i={col:e[l].col,row:e[l].row,type:e[l].type,state:e[l].state},a={col:e[n].col,row:e[n].row,type:e[n].type,state:e[n].state};e[l].col=a.col,e[l].row=a.row,e[n].col=i.col,e[n].row=i.row,t(function(){var t=angular.copy(e[l]);e[l]=e[n],e[n]=t,r.checkRowElements(e)},200)},this.checkRowElements=function(t){var l=[],n=e.size;s(t,l,n),o(t,l,n),console.log("---=== result ===---",l)}}])}(),function(){angular.module("app").factory("drFiledFactory",function(){var e=["square","circle","triangle"],t=["default","active","passive","note"],l=9;return{types:e,states:t,size:l}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsIiRzdGF0ZSIsIiRzdGF0ZVBhcmFtcyIsIiR0aW1lb3V0IiwidGhpcyIsImNlbGxTdGF0ZSIsImluaXQiLCJjb250cm9sbGVyIiwicHJvdG90eXBlIiwiJGluamVjdCIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJkaXJlY3RpdmUiLCJkckNlbGxMaW5rIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJsaW5rIiwicmVzdHJpY3QiLCJzY29wZSIsInRlbXBsYXRlIiwiZ2V0IiwiZHJDZWxsQ3RybCIsImNvbnRyb2xsZXJBcyIsImJpbmRUb0NvbnRyb2xsZXIiLCJ0eXBlIiwic3RhdGUiLCJ2YWx1ZSIsImRyRmllbGRMaW5rIiwiZHJGaWVsZEN0cmwiLCJjZWxsQ2xpY2siLCJzaXplIiwiY3R4IiwiZHJGaWVsZFNlcnZpY2UiLCJjZWxscyIsImNyZWF0ZU5ld0FyciIsImUiLCJjZWxsIiwiaWR4IiwiX3RoaXMiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsImFjdGl2ZUNlbGwiLCJhY3RpdmVDZWxsSWR4IiwibWFya0Nsb3Nlc3RDZWxsIiwicmVwbGFjZUVsZW1lbnRzIiwiX2kiLCJ1bmRlZmluZWQiLCJzZXJ2aWNlIiwiZHJGaWxlZEZhY3RvcnkiLCJyZXR1cm5SYW5kRWxlbWVudCIsImFyciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJldHVybkFub3RoZXJUeXBlIiwicmVwZWF0VHlwZXMiLCJuZXdBcnIiLCJjb3B5IiwidHlwZXMiLCJqIiwic3BsaWNlIiwic2V0Q29vcmRzVG9FbGVtZW50cyIsImNvbCIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJjaGVja0hSZXAiLCJjaGVja1ZSZXAiLCJwdXNoIiwiY29sSWR4Iiwicm93SWR4IiwiY291bnRSZXBlYXRJblJvdyIsInJlc3VsdCIsImNvdW50SW5Sb3ciLCJjdXJyZW50VHlwZSIsInRlbXBBcnIiLCJzIiwiaWR4QXJyIiwiY291bnRSZXBlYXRJbkNvbCIsImNvdW50IiwiY291bnRJbkNvbCIsImNvbnNvbGUiLCJsb2ciLCJpZHgxIiwiaWR4MiIsImVsZW0xIiwiZWxlbTIiLCJjb3B5RWwiLCJjaGVja1Jvd0VsZW1lbnRzIiwiZmFjdG9yeSIsInN0YXRlcyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFvQ0EsU0FBU0EsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBaURoSCxRQUFTSCxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxzQ0FuRmhILFdBQ0NDLFFBQVFDLE9BQU8sT0FBUSxZQUFhLGFBQWMsYUFBYyxpQkFJakVELFFBQVFDLE9BQU8sT0FBT0MsS0FBSyxpQkFBa0IsU0FBVUMsR0FDckRBLEVBQWVDLElBQUkscUJBQXNCLGdHQUN6Q0QsRUFBZUMsSUFBSSx1QkFBd0IsK1RBSTdDLFdBS0MsUUFBU0MsR0FBU0MsRUFBUUMsRUFBT0MsRUFBUUMsRUFBY0MsR0FDdERDLEtBQUtMLE9BQVNBLEVBQ2RLLEtBQUtKLE1BQVFBLEVBQ2JJLEtBQUtILE9BQVNBLEVBRWRHLEtBQUtDLFVBQVksU0FFakJELEtBQUtFLE9BVE5iLFFBQVFDLE9BQU8sT0FBT2EsV0FBVyxXQUFZVCxHQVk3Q0EsRUFBU1UsVUFBVUYsS0FBTyxhQUUxQlIsRUFBU1csU0FBVyxTQUFV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QixXQUMvQyxHQUFJOUIsSUFBUyxTQUFVLFNBQVUsWUFFN0IrQixHQUFVLFVBQVcsU0FBVSxVQUFXLFFBRTFDM0QsRUFBTyxDQUVYLFFBQ0M0QixNQUFPQSxFQUNQK0IsT0FBUUEsRUFDUjNELEtBQU1BIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdBbmltYXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd1aS5yb3V0ZXInXSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdkckNlbGwvZHJDZWxsLmh0bWwnLCAnPGRpdiBjbGFzcz1cImNlbGxcIiBuZy1jbGFzcz1cImMucmV0dXJuQ2VsbENsYXNzKClcIj5cXG5cXHQ8ZGl2IGNsYXNzPVwiY2VsbF9fZmlnXCI+PC9kaXY+XFxuPC9kaXY+XFxuJyk7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZHJGaWVsZC9kckZpZWxkLmh0bWwnLCAnPHVsIGNsYXNzPVwiY2VsbC1saXN0XCI+XFxuXFx0PGxpIGNsYXNzPVwiY2VsbC1saXN0X19pdGVtXCJcXG5cXHRcXHRuZy1yZXBlYXQ9XCIoaWR4LCBjZWxsKSBpbiBjZi5jZWxsc1wiXFxuXFx0XFx0bmctc3R5bGU9XCJ7XFwnbGVmdFxcJzogY2VsbC5jb2wqNjAgKyBcXCdweFxcJywgXFwndG9wXFwnOiBjZWxsLnJvdyo2MCArIFxcJ3B4XFwnfVwiXFxuXFx0XFx0bmctY2xpY2s9XCJjZi5jZWxsQ0xpY2soJGV2ZW50LCBjZWxsLCBpZHgpXCI+XFxuXFxuXFx0XFx0PGRyLWNlbGwgdHlwZT1cInt7Y2VsbC50eXBlfX1cIiBzdGF0ZT1cInt7Y2VsbC5zdGF0ZX19XCI+PC9kci1jZWxsPlxcblxcblxcdDwvbGk+XFxuPC91bD4nKTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdtYWluQ3RybCcsIG1haW5DdHJsKTtcblxuXHRmdW5jdGlvbiBtYWluQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHRpbWVvdXQpIHtcblx0XHR0aGlzLiRzY29wZSA9ICRzY29wZTtcblx0XHR0aGlzLiRodHRwID0gJGh0dHA7XG5cdFx0dGhpcy4kc3RhdGUgPSAkc3RhdGU7XG5cblx0XHR0aGlzLmNlbGxTdGF0ZSA9ICdzcXVhcmUnO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRtYWluQ3RybC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHt9O1xuXG5cdG1haW5DdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaHR0cCcsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJyR0aW1lb3V0J107XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZGlyZWN0aXZlKCdkckNlbGwnLCBbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG5cdFx0ZnVuY3Rpb24gZHJDZWxsTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyQ2VsbExpbmssXG5cdFx0XHRyZXN0cmljdDogJ0FFQycsXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZTogJHRlbXBsYXRlQ2FjaGUuZ2V0KCdkckNlbGwvZHJDZWxsLmh0bWwnKSxcblx0XHRcdGNvbnRyb2xsZXI6IGRyQ2VsbEN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdjJyxcblx0XHRcdGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0XHRcdFx0dHlwZTogJ0A/Jyxcblx0XHRcdFx0c3RhdGU6ICdAPydcblx0XHRcdH1cblx0XHR9O1xuXHR9XSk7XG5cblx0dmFyIGRyQ2VsbEN0cmwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJDZWxsQ3RybCgkc2NvcGUsICR0aW1lb3V0KSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgZHJDZWxsQ3RybCk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCY0YHQv9C+0LvRjNC30YPQtdC8INC90LAg0LLRjNGO0YXQtSwg0LLQvtC30LLRgNCw0YnQsNC10YIgY3NzLdC60LvQsNGB0YHRiyDQtNC70Y8g0YLQuNC/0LAg0Lgg0YHQvtGB0YLQvtGP0L3QuNGPINGP0YfQtdC50LrQuFxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKGRyQ2VsbEN0cmwsIFt7XG5cdFx0XHRrZXk6ICdyZXR1cm5DZWxsQ2xhc3MnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHJldHVybkNlbGxDbGFzcygpIHtcblx0XHRcdFx0dmFyIHR5cGUgPSAnY2VsbF90eXBlLScgKyAodGhpcy50eXBlIHx8ICdzcXVhcmUnKTtcblx0XHRcdFx0dmFyIHN0YXRlID0gJ2NlbGxfc3RhdGUtJyArICh0aGlzLnN0YXRlIHx8ICdkZWZhdWx0Jyk7XG5cblx0XHRcdFx0cmV0dXJuIFt0eXBlLCBzdGF0ZV07XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIGRyQ2VsbEN0cmw7XG5cdH0oKTtcblxuXHRkckNlbGxDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckdGltZW91dCddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnZHJGaWVsZCcsIFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcblx0XHRmdW5jdGlvbiBkckZpZWxkTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyRmllbGRMaW5rLFxuXHRcdFx0cmVzdHJpY3Q6ICdBRUMnLFxuXHRcdFx0c2NvcGU6IHt9LFxuXHRcdFx0dGVtcGxhdGU6ICR0ZW1wbGF0ZUNhY2hlLmdldCgnZHJGaWVsZC9kckZpZWxkLmh0bWwnKSxcblx0XHRcdGNvbnRyb2xsZXI6IGRyRmllbGRDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnY2YnLFxuXHRcdFx0YmluZFRvQ29udHJvbGxlcjoge1xuXHRcdFx0XHRjZWxsQ2xpY2s6ICc9PycsXG5cdFx0XHRcdHNpemU6ICc9PycsXG5cdFx0XHRcdGN0eDogJz0/J1xuXHRcdFx0fVxuXHRcdH07XG5cdH1dKTtcblxuXHR2YXIgZHJGaWVsZEN0cmwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJGaWVsZEN0cmwoZHJGaWVsZFNlcnZpY2UsICRzY29wZSwgJHRpbWVvdXQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBkckZpZWxkQ3RybCk7XG5cblx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UgPSBkckZpZWxkU2VydmljZTtcblx0XHRcdGlmICh0aGlzLnNpemUpIHRoaXMuZHJGaWVsZFNlcnZpY2Uuc2l6ZSA9IHRoaXMuc2l6ZTtcblx0XHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdFx0dGhpcy4kdGltZW91dCA9ICR0aW1lb3V0O1xuXG5cdFx0XHR0aGlzLmluaXQoKTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0J/RgNC4INC40L3RhtC40LDQu9C40LfQsNGG0LjQuCDRgdC+0LfQtNCw0LXQvCDQvNCw0YHRgdC40LJcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhkckZpZWxkQ3RybCwgW3tcblx0XHRcdGtleTogJ2luaXQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdFx0XHRcdHRoaXMuY2VsbHMgPSB0aGlzLmRyRmllbGRTZXJ2aWNlLmNyZWF0ZU5ld0Fycih0aGlzLnNpemUpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1XG4gICAgKiA9PSDRgdC+0LHRi9GC0LjQtSwg0Y/Rh9C10LnQutCwLCDQuNC90LTQtdC60YEg0LIg0LzQsNGB0YHQuNCy0LUgPT1cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnY2VsbENMaWNrJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBjZWxsQ0xpY2soZSwgY2VsbCwgaWR4KSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRcdGlmIChjZWxsLnN0YXRlID09PSAnZGVmYXVsdCcpIHtcblx0XHRcdFx0XHQvLyDQmtC70LjQuiDQv9C+INGP0YfQtdC50LrQtSDRgSDQtNC10YTQvtC70YLQvdGL0Lwg0YHRgtCw0YLRg9GB0L7QvC4g0JTQtdC70LDQtdC8INC10ZEg0LDQutGC0LjQstC90L7QuSDQuCDQstGL0LTQtdC70Y/QtdC8INC/0LDRgdGB0LjQstC+0Lwg0LHQu9C40LbQsNC50YjQuNC1INGP0YfQtdC50LrQuFxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jZWxscy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jZWxsc1tpXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHR9dGhpcy5hY3RpdmVDZWxsID0gY2VsbDtcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGwuc3RhdGUgPSAnYWN0aXZlJztcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGxJZHggPSBpZHg7XG5cdFx0XHRcdFx0dGhpcy5kckZpZWxkU2VydmljZS5tYXJrQ2xvc2VzdENlbGwodGhpcy5jZWxscywgdGhpcy5zaXplLCBpZHgsICdwYXNzaXZlJyk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoY2VsbC5zdGF0ZSA9PT0gJ3Bhc3NpdmUnKSB7XG5cdFx0XHRcdFx0Ly8g0JrQu9C40Log0L/QviDRj9GH0LXQudC60LUg0YEg0L/QsNGB0YHQuNCy0L3Ri9C8INGB0YLQsNGC0YPRgdC+0Lxcblx0XHRcdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlLnJlcGxhY2VFbGVtZW50cyh0aGlzLmNlbGxzLCB0aGlzLmFjdGl2ZUNlbGxJZHgsIGlkeCk7XG5cdFx0XHRcdFx0dGhpcy4kdGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBfaSA9IDA7IF9pIDwgX3RoaXMuY2VsbHMubGVuZ3RoOyBfaSArPSAxKSB7XG5cdFx0XHRcdFx0XHRcdF90aGlzLmNlbGxzW19pXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHRcdH0gLy8gdGhpcy5hY3RpdmVDZWxsID0gY2VsbDtcblx0XHRcdFx0XHRcdC8vIHRoaXMuYWN0aXZlQ2VsbC5zdGF0ZSA9ICdhY3RpdmUnO1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy5hY3RpdmVDZWxsSWR4ID0gaWR4O1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy5kckZpZWxkU2VydmljZS5tYXJrQ2xvc2VzdENlbGwodGhpcy5jZWxscywgdGhpcy5zaXplLCBpZHgsICdwYXNzaXZlJyk7XG5cdFx0XHRcdFx0fSwgMjAwKTtcblx0XHRcdFx0fSBlbHNlIGlmIChjZWxsLnN0YXRlID09PSAnYWN0aXZlJykge1xuXHRcdFx0XHRcdC8vINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1INGBINCw0LrRgtC40LLQvdGL0Lwg0YHRgtCw0YLRg9GB0L7QvC4g0KHQvdC40LzQsNC10Lwg0LDQutGC0LjQstC90L7RgdGC0Ywg0YEg0L3QtdGRINC4INCx0LvQuNC20LDQudGI0LjRhVxuXHRcdFx0XHRcdGNlbGwuc3RhdGUgPSAnZGVmYXVsdCc7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbElkeCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlLm1hcmtDbG9zZXN0Q2VsbCh0aGlzLmNlbGxzLCB0aGlzLnNpemUsIGlkeCwgJ2RlZmF1bHQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBkckZpZWxkQ3RybDtcblx0fSgpO1xuXG5cdGRyRmllbGRDdHJsLiRpbmplY3QgPSBbJ2RyRmllbGRTZXJ2aWNlJywgJyRzY29wZScsICckdGltZW91dCddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLnNlcnZpY2UoJ2RyRmllbGRTZXJ2aWNlJywgWydkckZpbGVkRmFjdG9yeScsICckdGltZW91dCcsIGZ1bmN0aW9uIChkckZpbGVkRmFjdG9yeSwgJHRpbWVvdXQpIHtcblx0XHQvKipcbiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBwcml2YXRlIG1ldGhvZHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICovXG5cdFx0LyoqXG4gICAqINCS0L7Qt9Cy0YDQsNGJ0LDQtdC8INGA0LDQvdC00L7QvNC90YvQuSDRjdC70LXQvNC10L3RgiDQvNCw0YHRgdC40LLQsFxuICAgKi9cblx0XHRmdW5jdGlvbiByZXR1cm5SYW5kRWxlbWVudChhcnIpIHtcblx0XHRcdHZhciBpZHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhcnIubGVuZ3RoKTtcblx0XHRcdHJldHVybiBhcnJbaWR4XTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0JLQvtC30LLRgNCw0YnQsNC10Lwg0YDQsNC90LTQvtC80L3Ri9C5INGN0LvQtdC80LXQvdGCINC80LDRgdGB0LjQstCwLCDQuNGB0LrQu9GO0YfQsNGPINC/0LXRgNC10LTQsNC90L3Ri9C5INCyINGE0YPQvdC60YbQuNGOXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJldHVybkFub3RoZXJUeXBlKHJlcGVhdFR5cGVzKSB7XG5cdFx0XHR2YXIgbmV3QXJyID0gYW5ndWxhci5jb3B5KGRyRmlsZWRGYWN0b3J5LnR5cGVzKTtcblxuXHRcdFx0bmV4dDogZm9yICh2YXIgaSA9IDA7IGkgPCByZXBlYXRUeXBlcy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IG5ld0Fyci5sZW5ndGg7IGogKz0gMSkge1xuXHRcdFx0XHRcdGlmIChyZXBlYXRUeXBlc1tpXSA9PT0gbmV3QXJyW2pdKSBuZXdBcnIuc3BsaWNlKGosIDEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXR1cm5SYW5kRWxlbWVudChuZXdBcnIpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0L7RgdGC0LDQstC70Y/QtdGCINGN0LvQtdC80LXQvdGC0YvQvCDQvNCw0YHRgdC40LLQsCDQutC+0L7RgNC00LjQvdCw0YLRiyAo0L/QvtC70Y8gXCJjb2xcIiwgXCJyb3dcIikg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCXG4gICAqINCy0YLQvtGA0L7Qs9C+INC/0LDRgNCw0LzQtdGC0YDQsCBzaXplICjRiNC40YDQuNC90LAg0LzQsNGB0YHQuNCy0LApXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHNldENvb3Jkc1RvRWxlbWVudHMoYXJyLCBzaXplKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRhcnJbaV0uY29sID0gaSAlIHNpemU7XG5cdFx0XHRcdGFycltpXS5yb3cgPSBNYXRoLmZsb29yKGkgLyBzaXplKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICog0KTRg9C90LrRhtC40Y8g0L/RgNC40L3QuNC80LDQtdGCINC80LDRgdGB0LjQsiwg0LIg0LrQvtGC0L7RgNGL0Lkg0LTQvtCx0LDQstC70Y/QtdGCINC90L7QstGL0Lkg0Y3Qu9C10LzQtdC90YIuXG4gICAqINCf0YDQuCDQtNC+0LHQsNCy0LvQtdC90LjQuCDQstGL0L/QvtC70L3Rj9C10YIg0LTQstC1INC/0YDQvtCy0LXRgNC60Lg6XG4gICAqIC0g0LXRgdC70Lgg0YLQuNC/0Ysg0LTQstGD0YUg0L/RgNC10LTRi9C00YPRidC40YUg0L7QsdGK0LXQutGCINGA0LDQstC90Ysg0YLQtdC60YPRidC10LzRgyDRgdCz0LXQvdC10YDQuNGA0L7QstCw0L3QvdC+0LzRgyDRgtC40L/Rgywg0YLQviDQs9C10L3QtdGA0LjRgNGD0LXQvCDQvdC+0LLRi9C5XG4gICAqIC0g0LXRgdC70Lgg0YLQuNC/0Ysg0LTQstGD0YUg0L7QsdGK0LXQutGC0L7QsiDQvdCw0LQg0YLQtdC60YPQt9C40Lwg0YDQsNCy0L3RiyDRgtC10LrRg9GJ0LXQvNGDINGB0LPQtdC90LXRgNC40YDQvtCy0LDQvdC90L7QvNGDINGC0LjQv9GDLCDRgtC+INCz0LXQvdC10YDQuNGA0YPQtdC8INC90L7QstGL0LlcbiAgICogQHBhcmFtIGFyclxuICAgKi9cblx0XHRmdW5jdGlvbiBjcmVhdGVFbGVtZW50KGFyciwgc2l6ZSkge1xuXHRcdFx0dmFyIHR5cGUgPSByZXR1cm5SYW5kRWxlbWVudChkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdHZhciByZXBlYXRUeXBlcyA9IFtdO1xuXG5cdFx0XHQvLyDQn9GA0L7QstC10YDQutC4INC90LAg0LPQvtGA0LjQt9C+0L3RgtCw0LvRjNC90YvQtSDQuCDQstC10YDRgtC40LrQsNC70YzQvdGL0LUg0YHQvtCy0L/QsNC00LXQvdC40Y8g0L/RgNC4INCz0LXQvdC10YDQsNGG0LjQuFxuXHRcdFx0Y2hlY2tIUmVwKGFyciwgc2l6ZSwgcmVwZWF0VHlwZXMpO1xuXHRcdFx0Y2hlY2tWUmVwKGFyciwgc2l6ZSwgcmVwZWF0VHlwZXMpO1xuXG5cdFx0XHRpZiAocmVwZWF0VHlwZXMubGVuZ3RoKSB0eXBlID0gcmV0dXJuQW5vdGhlclR5cGUocmVwZWF0VHlwZXMpO1xuXG5cdFx0XHRhcnIucHVzaCh7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdHN0YXRlOiAnZGVmYXVsdCdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQn9GA0L7QstC10YDQutCwINC90LAg0LPQvtGA0LjQt9C+0L3RgtCw0LvRjNC90L7QtSDQv9C+0LLRgtC+0YDQtdC90LjQtVxuICAgKi9cblx0XHRmdW5jdGlvbiBjaGVja0hSZXAoYXJyLCBzaXplLCByZXBlYXRUeXBlcykge1xuXHRcdFx0dmFyIGNvbElkeCA9IGFyci5sZW5ndGggJSBzaXplO1xuXHRcdFx0aWYgKGNvbElkeCA+IDEpIHtcblx0XHRcdFx0aWYgKGFyclthcnIubGVuZ3RoIC0gMl0udHlwZSA9PT0gYXJyW2Fyci5sZW5ndGggLSAxXS50eXBlKSB7XG5cdFx0XHRcdFx0cmVwZWF0VHlwZXMucHVzaChhcnJbYXJyLmxlbmd0aCAtIDFdLnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCf0YDQvtCy0LXRgNC60LAg0L3QsCDQstC10YDRgtC40LrQsNC70YzQvdC+0LUg0L/QvtCy0YLQvtGA0LXQvdC40LVcbiAgICovXG5cdFx0ZnVuY3Rpb24gY2hlY2tWUmVwKGFyciwgc2l6ZSwgcmVwZWF0VHlwZXMpIHtcblx0XHRcdHZhciByb3dJZHggPSBNYXRoLmZsb29yKGFyci5sZW5ndGggLyBzaXplKTtcblx0XHRcdGlmIChyb3dJZHggPiAxKSB7XG5cdFx0XHRcdGlmIChhcnJbYXJyLmxlbmd0aCAtIHNpemVdLnR5cGUgPT09IGFyclthcnIubGVuZ3RoIC0gc2l6ZSAqIDJdLnR5cGUpIHtcblx0XHRcdFx0XHRyZXBlYXRUeXBlcy5wdXNoKGFyclthcnIubGVuZ3RoIC0gc2l6ZV0udHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBwdWJsaWMgbWV0aG9kcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgKi9cblxuXHRcdC8qKlxuICAgKiDQnNC10YLQvtC0INGB0LXRgNCy0LjRgdCwINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCINC90L7QstGL0Lkg0LzQsNGB0YHQuNCyINC00LvQuNC90L7QuSBzaXplKnNpemVcbiAgICovXG5cdFx0dGhpcy5jcmVhdGVOZXdBcnIgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXHRcdFx0dmFyIGFyciA9IFtdO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNpemUgKiBzaXplOyBpKyspIHtcblx0XHRcdFx0Y3JlYXRlRWxlbWVudChhcnIsIHNpemUpO1xuXHRcdFx0fXNldENvb3Jkc1RvRWxlbWVudHMoYXJyLCBzaXplKTtcblxuXHRcdFx0cmV0dXJuIGFycjtcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCX0LDQtNCw0LXQvCDRgdC+0YHRgtC+0Y/QvdC40LUg0LHQu9C40LbQsNC50YjQuNC8INGN0LvQtdC80LXQvdGC0LDQvCDQvtGCINCy0YvQtNC10LvQtdC90L3QvtCz0L5cbiAgICovXG5cdFx0dGhpcy5tYXJrQ2xvc2VzdENlbGwgPSBmdW5jdGlvbiAoYXJyLCBzaXplLCBpZHgsIHN0YXRlKSB7XG5cdFx0XHRpZiAoYXJyW2lkeCAtIHNpemVdKSBhcnJbaWR4IC0gc2l6ZV0uc3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChhcnJbaWR4ICsgc2l6ZV0pIGFycltpZHggKyBzaXplXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKGFycltpZHggLSAxXSkgYXJyW2lkeCAtIDFdLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRpZiAoYXJyW2lkeCArIDFdKSBhcnJbaWR4ICsgMV0uc3RhdGUgPSBzdGF0ZTtcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCc0LXQvdGP0LXQvCDQvNC10YHRgtCw0LzQuCDRj9GH0LXQudC60LguINCQ0LvQs9C+0YDQuNGC0Lw6XG4gICAqIC0g0YHQvdCw0YfQsNC70LAg0LzQtdC90Y/QtdC8INC/0LDRgNCw0LzQtdC90YLRgNGLIGNvbC9yb3cgKNC00LvRjyDQsNC90LjQvNCw0YbQuCkuXG4gICAqIC0g0L/QvtGB0LvQtSDQv9C+INGC0LDQudC80LDRg9GC0YMg0LzQtdC90Y/QtdC8INC00LDQvdC90YvQtSDQvtCx0YrQtdC60YLQvtCyINCyINGB0LDQvNC+0Lwg0LzQsNGB0YHQuNCy0LUgKNGE0LjQs9GD0YDRgylcbiAgICovXG5cdFx0dGhpcy5yZXBsYWNlRWxlbWVudHMgPSBmdW5jdGlvbiAoYXJyLCBpZHgxLCBpZHgyKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXG5cdFx0XHR2YXIgZWxlbTEgPSB7IGNvbDogYXJyW2lkeDFdLmNvbCwgcm93OiBhcnJbaWR4MV0ucm93LCB0eXBlOiBhcnJbaWR4MV0udHlwZSwgc3RhdGU6IGFycltpZHgxXS5zdGF0ZSB9O1xuXHRcdFx0dmFyIGVsZW0yID0geyBjb2w6IGFycltpZHgyXS5jb2wsIHJvdzogYXJyW2lkeDJdLnJvdywgdHlwZTogYXJyW2lkeDJdLnR5cGUsIHN0YXRlOiBhcnJbaWR4Ml0uc3RhdGUgfTtcblxuXHRcdFx0YXJyW2lkeDFdLmNvbCA9IGVsZW0yLmNvbDtcblx0XHRcdGFycltpZHgxXS5yb3cgPSBlbGVtMi5yb3c7XG5cblx0XHRcdGFycltpZHgyXS5jb2wgPSBlbGVtMS5jb2w7XG5cdFx0XHRhcnJbaWR4Ml0ucm93ID0gZWxlbTEucm93O1xuXG5cdFx0XHQvKipcbiAgICAqINCS0YDQtdC80Y8g0YLQsNC50LzQsNGD0YLQsCAtINCy0YDQtdC80Y8g0LDQvdC40LzQsNGG0LjQuCDQtNCy0LjQttC10L3QuNGPINGN0LvQtdC80LXQvdGC0L7QsiDQstC+INCy0YDQtdC80Y8g0YHQvNC10L3RiyDQv9C+0LfQuNGG0LjQuVxuICAgICovXG5cdFx0XHQkdGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHZhciBjb3B5RWwgPSBhbmd1bGFyLmNvcHkoYXJyW2lkeDFdKTtcblx0XHRcdFx0YXJyW2lkeDFdID0gYXJyW2lkeDJdO1xuXHRcdFx0XHRhcnJbaWR4Ml0gPSBjb3B5RWw7XG5cblx0XHRcdFx0X3RoaXMuY2hlY2tSb3dFbGVtZW50cyhhcnIpO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCj0LTQsNC70Y/QtdC8INC+0LHRitC10LrRgtGLINC+0LTQuNC90LDQutC+0LLQvtCz0L4g0YLQuNC/0LAsINC10YHQu9C4INC40YUg0LHQvtC70YzRiNC1INGC0YDRkdGFINCyINGB0YLRgNC+0LrQtSDQuNC70Lgg0LIg0LrQvtC70L7QvdC60LVcbiAgICovXG5cdFx0dGhpcy5jaGVja1Jvd0VsZW1lbnRzID0gZnVuY3Rpb24gKGFycikge1xuXHRcdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdFx0dmFyIHNpemUgPSBkckZpbGVkRmFjdG9yeS5zaXplO1xuXG5cdFx0XHQvLyBuZXh0OiBmb3IobGV0IGk9MDsgaTxhcnIubGVuZ3RoOyBpKz0xKXtcblx0XHRcdC8vIFx0bGV0IGNvbElkeCA9IGklc2l6ZTtcblx0XHRcdC8vIFx0bGV0IHJvd0lkeCA9IE1hdGguZmxvb3IoaS9zaXplKTtcblx0XHRcdC8vIFx0bGV0IGNvdW50SW5Sb3cgPSAxO1xuXHRcdFx0Ly8gXHRsZXQgY291bnRJbkNvbCA9IDE7XG5cdFx0XHQvLyBcdGxldCBjdXJyZW50VHlwZSA9IGFycltpXS50eXBlO1xuXHRcdFx0Ly9cblx0XHRcdC8vIFx0Zm9yKGxldCBqPTE7IGo8KHNpemUtY29sSWR4KTsgais9MSl7XG5cdFx0XHQvLyBcdFx0aWYoYXJyW2kral0udHlwZSAhPT0gY3VycmVudFR5cGUpIGJyZWFrO1xuXHRcdFx0Ly8gXHRcdGNvdW50SW5Sb3crKztcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gXHRpZihjb3VudEluUm93ID4gMikge1xuXHRcdFx0Ly8gXHRcdGxldCB0ZW1wQXJyID0gW107XG5cdFx0XHQvLyBcdFx0Zm9yKGxldCBzPTE7IHM8PWNvdW50SW5Sb3c7IHMrPTEpIHRlbXBBcnIucHVzaChpK3MpXG5cdFx0XHQvLyBcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0Ly8gXHRcdFx0bGVuZ3RoOiBjb3VudEluUm93LFxuXHRcdFx0Ly8gXHRcdFx0dHlwZTogY3VycmVudFR5cGUsXG5cdFx0XHQvLyBcdFx0XHRpZHhBcnI6IHRlbXBBcnJcblx0XHRcdC8vIFx0XHR9KTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly9cblx0XHRcdC8vIFx0Zm9yKGxldCBrPTE7IGs8KHNpemUtcm93SWR4KTsgays9MSl7XG5cdFx0XHQvLyBcdFx0aWYoYXJyW2krc2l6ZSprXS50eXBlICE9PSBjdXJyZW50VHlwZSkgYnJlYWs7XG5cdFx0XHQvLyBcdFx0Y291bnRJbkNvbCsrO1xuXHRcdFx0Ly8gXHR9XG5cdFx0XHQvLyBcdGlmKGNvdW50SW5Db2wgPiAyKSB7XG5cdFx0XHQvLyBcdFx0bGV0IHRlbXBBcnIgPSBbXTtcblx0XHRcdC8vIFx0XHRmb3IobGV0IHM9MDsgczxjb3VudEluQ29sOyBzKz0xKSB0ZW1wQXJyLnB1c2goaStzaXplKnMpXG5cdFx0XHQvLyBcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0Ly8gXHRcdFx0bGVuZ3RoOiBjb3VudEluQ29sLFxuXHRcdFx0Ly8gXHRcdFx0dHlwZTogY3VycmVudFR5cGUsXG5cdFx0XHQvLyBcdFx0XHRpZHhBcnI6IHRlbXBBcnJcblx0XHRcdC8vIFx0XHR9KTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly9cblx0XHRcdC8vIFx0Y291bnRJblJvdyA9IGNvdW50SW5Db2wgPSAwO1xuXHRcdFx0Ly8gfVxuXG5cdFx0XHRjb3VudFJlcGVhdEluUm93KGFyciwgcmVzdWx0LCBzaXplKTtcblx0XHRcdGNvdW50UmVwZWF0SW5Db2woYXJyLCByZXN1bHQsIHNpemUpO1xuXG5cdFx0XHRjb25zb2xlLmxvZygnLS0tPT09IHJlc3VsdCA9PT0tLS0nLCByZXN1bHQpO1xuXHRcdH07XG5cblx0XHRmdW5jdGlvbiBjb3VudFJlcGVhdEluUm93KGFyciwgcmVzdWx0LCBzaXplKSB7XG5cdFx0XHRuZXh0OiBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHR2YXIgY29sSWR4ID0gaSAlIHNpemU7XG5cdFx0XHRcdHZhciBjb3VudEluUm93ID0gMTtcblx0XHRcdFx0dmFyIGN1cnJlbnRUeXBlID0gYXJyW2ldLnR5cGU7XG5cblx0XHRcdFx0Zm9yICh2YXIgaiA9IDE7IGogPCBzaXplIC0gY29sSWR4OyBqICs9IDEpIHtcblx0XHRcdFx0XHRpZiAoYXJyW2kgKyBqXS50eXBlICE9PSBjdXJyZW50VHlwZSkgYnJlYWs7XG5cdFx0XHRcdFx0Y291bnRJblJvdysrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChjb3VudEluUm93ID4gMikge1xuXHRcdFx0XHRcdHZhciB0ZW1wQXJyID0gW107XG5cdFx0XHRcdFx0Zm9yICh2YXIgcyA9IDE7IHMgPD0gY291bnRJblJvdzsgcyArPSAxKSB7XG5cdFx0XHRcdFx0XHR0ZW1wQXJyLnB1c2goaSArIHMpO1xuXHRcdFx0XHRcdH1yZXN1bHQucHVzaCh7XG5cdFx0XHRcdFx0XHRsZW5ndGg6IGNvdW50SW5Sb3csXG5cdFx0XHRcdFx0XHR0eXBlOiBjdXJyZW50VHlwZSxcblx0XHRcdFx0XHRcdGlkeEFycjogdGVtcEFyclxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGkgKz0gY291bnRJblJvdyAtIDE7XG5cdFx0XHRcdFx0Y291bnRJblJvdyA9IDA7XG5cdFx0XHRcdFx0Y29udGludWUgbmV4dDtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb3VudEluUm93ID0gMDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjb3VudFJlcGVhdEluQ29sKGFyciwgcmVzdWx0LCBzaXplKSB7XG5cdFx0XHRuZXh0OiBmb3IgKHZhciBjb3VudCA9IDAsIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSArPSBzaXplKSB7XG5cdFx0XHRcdHZhciByb3dJZHggPSBNYXRoLmZsb29yKGkgLyBzaXplKTtcblx0XHRcdFx0dmFyIGNvdW50SW5Db2wgPSAxO1xuXHRcdFx0XHR2YXIgY3VycmVudFR5cGUgPSBhcnJbaV0udHlwZTtcblxuXHRcdFx0XHRjb25zb2xlLmxvZygnLS0tPT09IGkgPT09LS0tJywgaSk7XG5cblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBzaXplIC0gcm93SWR4OyBqICs9IDEpIHt9XG5cdFx0XHRcdC8vIGlmKGFycltpK3NpemUqal0udHlwZSAhPT0gY3VycmVudFR5cGUpIGJyZWFrO1xuXHRcdFx0XHQvLyBjb3VudEluQ29sKys7XG5cblx0XHRcdFx0Ly8gaWYoY291bnRJbkNvbCA+IDIpIGNvbnNvbGUubG9nKCctLS09PT0gY291bnRJbkNvbCA9PT0tLS0nLCBjb3VudEluQ29sKTtcblx0XHRcdFx0Ly8gaWYoY291bnRJbkNvbCA+IDIpIHtcblx0XHRcdFx0Ly8gXHRsZXQgdGVtcEFyciA9IFtdO1xuXHRcdFx0XHQvLyBcdGZvcihsZXQgcz0xOyBzPD1jb3VudEluQ29sOyBzKz0xKSB0ZW1wQXJyLnB1c2goaStzKVxuXHRcdFx0XHQvLyBcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0Ly8gXHRcdGxlbmd0aDogY291bnRJbkNvbCxcblx0XHRcdFx0Ly8gXHRcdHR5cGU6IGN1cnJlbnRUeXBlLFxuXHRcdFx0XHQvLyBcdFx0aWR4QXJyOiB0ZW1wQXJyXG5cdFx0XHRcdC8vIFx0fSk7XG5cdFx0XHRcdC8vIFx0aSs9IGNvdW50SW5Db2wtMTtcblx0XHRcdFx0Ly8gXHRjb3VudEluQ29sID0gMDtcblx0XHRcdFx0Ly8gXHRjb250aW51ZSBuZXh0O1xuXHRcdFx0XHQvLyB9XG5cdFx0XHRcdGNvdW50SW5Db2wgPSAwO1xuXG5cdFx0XHRcdC8vINCo0LDQs9Cw0LXQvCDQstC10YDRgtC40LrQsNC70YzQvdC+XG5cdFx0XHRcdGlmIChNYXRoLmZsb29yKGkgLyBzaXplKSArIDEgPT09IHNpemUpIHtcblx0XHRcdFx0XHRjb3VudCsrO1xuXHRcdFx0XHRcdGkgPSBjb3VudCAtIHNpemU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gbmV4dDogZm9yKGxldCBpPTA7IGk8YXJyLmxlbmd0aDsgaSs9MSl7XG5cdFx0XHQvLyBcdGxldCByb3dJZHggPSBNYXRoLmZsb29yKGkvc2l6ZSk7XG5cdFx0XHQvLyBcdGxldCBjb3VudEluQ29sID0gMTtcblx0XHRcdC8vIFx0bGV0IGN1cnJlbnRUeXBlID0gYXJyW2ldLnR5cGU7XG5cdFx0XHQvL1xuXHRcdFx0Ly8gXHRmb3IobGV0IGs9MTsgazwoc2l6ZS1yb3dJZHgpOyBrKz0xKXtcblx0XHRcdC8vIFx0XHRpZihhcnJbaStzaXplKmtdLnR5cGUgIT09IGN1cnJlbnRUeXBlKSBicmVhaztcblx0XHRcdC8vIFx0XHRjb3VudEluQ29sKys7XG5cdFx0XHQvLyBcdH1cblx0XHRcdC8vIFx0aWYoY291bnRJbkNvbCA+IDIpIHtcblx0XHRcdC8vIFx0XHRsZXQgdGVtcEFyciA9IFtdO1xuXHRcdFx0Ly8gXHRcdGZvcihsZXQgcz0wOyBzPGNvdW50SW5Db2w7IHMrPTEpIHRlbXBBcnIucHVzaChpK3NpemUqcylcblx0XHRcdC8vIFx0XHRyZXN1bHQucHVzaCh7XG5cdFx0XHQvLyBcdFx0XHRsZW5ndGg6IGNvdW50SW5Db2wsXG5cdFx0XHQvLyBcdFx0XHR0eXBlOiBjdXJyZW50VHlwZSxcblx0XHRcdC8vIFx0XHRcdGlkeEFycjogdGVtcEFyclxuXHRcdFx0Ly8gXHRcdH0pO1xuXHRcdFx0Ly8gXHR9XG5cdFx0XHQvLyBcdGNvdW50SW5Db2wgPSAwO1xuXHRcdFx0Ly8gfVxuXHRcdH1cblx0fV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2RyRmlsZWRGYWN0b3J5JywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciB0eXBlcyA9IFsnc3F1YXJlJywgJ2NpcmNsZScsICd0cmlhbmdsZSddO1xuXG5cdFx0dmFyIHN0YXRlcyA9IFsnZGVmYXVsdCcsICdhY3RpdmUnLCAncGFzc2l2ZScsICdub3RlJ107XG5cblx0XHR2YXIgc2l6ZSA9IDk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZXM6IHR5cGVzLFxuXHRcdFx0c3RhdGVzOiBzdGF0ZXMsXG5cdFx0XHRzaXplOiBzaXplXG5cdFx0fTtcblx0fSk7XG59KSgpOyJdfQ==
