"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"])}(),angular.module("app").run(["$templateCache",function(e){e.put("drCell/drCell.html",'<div class="cell" ng-class="c.returnCellClass()">\n\t<div class="cell__fig"></div>\n</div>\n'),e.put("drField/drField.html",'<ul class="cell-list">\n\t<li class="cell-list__item"\n\t\tng-repeat="(idx, cell) in cf.cells track by cell.id"\n\t\tng-style="{\'left\': cell.col*60 + \'px\', \'top\': cell.row*60 + \'px\'}"\n\t\tng-click="cf.cellCLick($event, cell, idx)">\n\n\t\t<dr-cell type="{{cell.type}}" state="{{cell.state}}"></dr-cell>\n\n\t</li>\n</ul>')}]),function(){function e(e,t,l,r,n){this.$scope=e,this.$http=t,this.$state=l,this.cellState="square",this.init()}angular.module("app").controller("mainCtrl",e),e.prototype.init=function(){},e.$inject=["$scope","$http","$state","$stateParams","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,l,r){return l&&e(t.prototype,l),r&&e(t,r),t}}();!function(){angular.module("app").directive("drCell",["$templateCache",function(t){function l(e,t,l,r){}return{link:l,restrict:"AEC",scope:{},template:t.get("drCell/drCell.html"),controller:e,controllerAs:"c",bindToController:{type:"@?",state:"@?"}}}]);var e=function(){function e(t,l){_classCallCheck(this,e)}return _createClass(e,[{key:"returnCellClass",value:function(){var e="cell_type-"+(this.type||"square"),t="cell_state-"+(this.state||"default");return[e,t]}}]),e}();e.$inject=["$scope","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,l,r){return l&&e(t.prototype,l),r&&e(t,r),t}}();!function(){angular.module("app").directive("drField",["$templateCache",function(t){function l(e,t,l,r){}return{link:l,restrict:"AEC",scope:{},template:t.get("drField/drField.html"),controller:e,controllerAs:"cf",bindToController:{cellClick:"=?",size:"=?",ctx:"=?"}}}]);var e=function(){function e(t,l,r,n){_classCallCheck(this,e),this.drFieldService=t,this.drFiledFactory=l,this.size&&(this.drFiledFactory.size=this.size),this.$scope=r,this.$timeout=n,this.init()}return _createClass(e,[{key:"init",value:function(){this.cells=this.drFieldService.createNewArr(this.size)}},{key:"cellCLick",value:function(e,t,l){if(e.preventDefault(),e.stopPropagation(),"default"===t.state){for(var r=0;r<this.cells.length;r+=1)this.cells[r].state="default";this.activeCell=t,this.activeCell.state="active",this.activeCellIdx=l,this.drFieldService.markClosestCell(l,"passive")}else if("passive"===t.state){this.drFieldService.replaceElements(this.activeCellIdx,l);for(var n=0;n<this.cells.length;n+=1)this.cells[n].state="default";this.$timeout(function(){},200)}else"active"===t.state&&(t.state="default",this.activeCell=void 0,this.activeCellIdx=void 0,this.drFieldService.markClosestCell(l,"default"))}}]),e}();e.$inject=["drFieldService","drFiledFactory","$scope","$timeout"]}(),function(){angular.module("app").service("drFieldService",["drFiledFactory","$timeout",function(e,t){function l(e){var t=Math.floor(Math.random()*e.length);return e[t]}function r(t){for(var r=angular.copy(e.types),n=0;n<t.length;n+=1)for(var i=0;i<r.length;i+=1)t[n]===r[i]&&r.splice(i,1);return l(r)}function n(){for(var e=0;e<d.length;e+=1)d[e].col=e%p.size,d[e].row=Math.floor(e/p.size)}function i(t){var n=l(e.types),i=[];a(i),o(i),i.length&&(n=r(i)),d.push({id:t,type:n,state:"default"})}function a(e){var t=p.size,l=d.length%t;l>1&&d[d.length-2].type===d[d.length-1].type&&e.push(d[d.length-1].type)}function o(e){var t=p.size,l=Math.floor(d.length/t);l>1&&d[d.length-t].type===d[d.length-2*t].type&&e.push(d[d.length-t].type)}function s(e){for(var t=p.size,l=0;l<d.length;l+=t){for(var r=[l],n=d[l].type,i=1;i<t;i+=1)if("empty"!==d[l+i].type&&n===d[l+i].type)r.push(l+i);else{if(r.length>2)break;r.length=0,r.push(l+i),n=d[l+i].type}r.length>2&&e.push({length:r.length,type:n,idxArr:angular.copy(r)}),r.length=0}}function c(e){for(var t=p.size,l=0;l<t;l+=1){for(var r=[l],n=d[l].type,i=1;i<t;i+=1)if("empty"!==d[l+i*t].type&&n===d[l+i*t].type)r.push(l+i*t);else{if(r.length>2)break;r.length=0,r.push(l+i*t),n=d[l+i*t].type}r.length>2&&e.push({length:r.length,type:n,idxArr:angular.copy(r)}),r.length=0}}function u(){}function u(){var e=[];return s(e),c(e),!!e.length&&(p.deleteElements(e),p.moveTopEl(),d.sort(f),void u())}function h(t,l){for(var r=e.size,n=Math.floor(t/r),i=0,a=t;i<l;i+=1)d[a].row-=n,a+=r;for(var o=0,s=t;o<n;o+=1)s-=r,d[s].row+=l}function f(e,t){return e.row!==t.row?e.row-t.row:e.row===t.row?e.col-t.col:void 0}var p=this;this.matrixModel=[];var d=this.matrixModel;this.createNewArr=function(t){d.length=0,this.size=t||e.size;for(var l=0;l<t*t;l++)i(l);return n(),d},this.markClosestCell=function(e,t){var l=p.size;d[e-l]&&(d[e-l].state=t),d[e+l]&&(d[e+l].state=t),d[e-1]&&(d[e-1].state=t),d[e+1]&&(d[e+1].state=t)},this.replaceElements=function(e,t){var l={col1:d[e].col,row1:d[e].row,col2:d[t].col,row2:d[t].row};d[e].col=l.col2,d[e].row=l.row2,d[t].col=l.col1,d[t].row=l.row1,d.sort(f),u()},this.deleteElements=function(e){for(var t=0;t<e.length;t+=1){for(var l=e[t],r=0;r<l.idxArr.length;r+=1)d[l.idxArr[r]].type="empty";for(var n=0;n<d.length;n+=1)d[n].state="default"}},this.moveTopEl=function(){for(var t,l=e.size,r=0,n=0,i=0;n<d.length;n+=1){n>0&&n%l===0&&(t=void 0,i=0,r++);var a=n%l*l+r;"empty"===d[a].type&&(t||(t=a),i++),n>0&&(n+1)%l===0&&i>0&&h(t,i)}}}])}(),function(){angular.module("app").factory("drFiledFactory",function(){var e=["square","circle","triangle"],t=["default","active","passive","note"],l=9;return{types:e,states:t,size:l}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsIiRzdGF0ZSIsIiRzdGF0ZVBhcmFtcyIsIiR0aW1lb3V0IiwidGhpcyIsImNlbGxTdGF0ZSIsImluaXQiLCJjb250cm9sbGVyIiwicHJvdG90eXBlIiwiJGluamVjdCIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJkaXJlY3RpdmUiLCJkckNlbGxMaW5rIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJsaW5rIiwicmVzdHJpY3QiLCJzY29wZSIsInRlbXBsYXRlIiwiZ2V0IiwiZHJDZWxsQ3RybCIsImNvbnRyb2xsZXJBcyIsImJpbmRUb0NvbnRyb2xsZXIiLCJ0eXBlIiwic3RhdGUiLCJ2YWx1ZSIsImRyRmllbGRMaW5rIiwiZHJGaWVsZEN0cmwiLCJjZWxsQ2xpY2siLCJzaXplIiwiY3R4IiwiZHJGaWVsZFNlcnZpY2UiLCJkckZpbGVkRmFjdG9yeSIsImNlbGxzIiwiY3JlYXRlTmV3QXJyIiwiZSIsImNlbGwiLCJpZHgiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsImFjdGl2ZUNlbGwiLCJhY3RpdmVDZWxsSWR4IiwibWFya0Nsb3Nlc3RDZWxsIiwicmVwbGFjZUVsZW1lbnRzIiwiX2kiLCJ1bmRlZmluZWQiLCJzZXJ2aWNlIiwicmV0dXJuUmFuZEVsZW1lbnQiLCJhcnIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyZXR1cm5Bbm90aGVyVHlwZSIsInJlcGVhdFR5cGVzIiwibmV3QXJyIiwiY29weSIsInR5cGVzIiwiaiIsInNwbGljZSIsInNldENvb3Jkc1RvRWxlbWVudHMiLCJfbW0iLCJjb2wiLCJfc2VsZiIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJjaGVja0hSZXAiLCJjaGVja1ZSZXAiLCJwdXNoIiwiaWQiLCJzIiwiY29sSWR4Iiwicm93SWR4IiwiY291bnRSZXBlYXRJblJvdyIsInJlc3VsdCIsImRlbElkeEFyciIsImN1cnJlbnRUeXBlIiwiaWR4QXJyIiwiY291bnRSZXBlYXRJbkNvbCIsInJlY3VyRGVsZXRlRWwiLCJkZWxldGVFbGVtZW50cyIsIm1vdmVUb3BFbCIsInNvcnQiLCJzb3J0QXJyQnlSb3dDb2wiLCJtb3ZlRWxlbWVudHMiLCJlbXB0eVN0YXJ0SWR4IiwiZW1wdHlDb3VudCIsImNvdW50T2ZNb3ZhYmxlRWwiLCJjIiwiX2MiLCJhIiwiYiIsIm1hdHJpeE1vZGVsIiwiaWR4MSIsImlkeDIiLCJ0ZW1wIiwiY29sMSIsInJvdzEiLCJjb2wyIiwicm93MiIsImRlbEFyciIsImxpbmUiLCJfaiIsImNvdW50IiwiZmFjdG9yeSIsInN0YXRlcyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFvQ0EsU0FBU0EsaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBaURoSCxRQUFTSCxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxzQ0FuRmhILFdBQ0NDLFFBQVFDLE9BQU8sT0FBUSxZQUFhLGFBQWMsYUFBYyxpQkFJakVELFFBQVFDLE9BQU8sT0FBT0MsS0FBSyxpQkFBa0IsU0FBVUMsR0FDckRBLEVBQWVDLElBQUkscUJBQXNCLGdHQUN6Q0QsRUFBZUMsSUFBSSx1QkFBd0IsZ1ZBSTdDLFdBS0MsUUFBU0MsR0FBU0MsRUFBUUMsRUFBT0MsRUFBUUMsRUFBY0MsR0FDdERDLEtBQUtMLE9BQVNB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QUN2Q3pDLEVBQUl5QyxHQUFJN0UsTUFBUSxZQVFuQmxDLEtBQUswRixVQUFZLFdBSVYsSUFBSyxHQUFzQ0ksR0FGN0N2RCxFQUFPRyxFQUFlSCxLQUVYeUUsRUFBUSxFQUFHdEcsRUFBSSxFQUFHcUYsRUFBYSxFQUFrQnJGLEVBQUk0RCxFQUFJM0QsT0FBUUQsR0FBSyxFQUFHLENBQ25GQSxFQUFJLEdBQUtBLEVBQUk2QixJQUFTLElBQ3pCdUQsRUFBZ0J2QyxPQUNoQndDLEVBQWEsRUFDYmlCLElBR0QsSUFBSS9CLEdBQVN2RSxFQUFJNkIsRUFBT0EsRUFBT3lFLENBRU4sV0FBckIxQyxFQUFJVyxHQUFRaEQsT0FDVjZELElBQWVBLEVBQWdCYixHQUNwQ2MsS0FJR3JGLEVBQUksSUFBTUEsRUFBSSxHQUFLNkIsSUFBUyxHQUFLd0QsRUFBYSxHQUNqREYsRUFBYUMsRUFBZUMsV0FzQ2pDLFdBQ0MxRyxRQUFRQyxPQUFPLE9BQU8ySCxRQUFRLGlCQUFrQixXQUMvQyxHQUFJL0MsSUFBUyxTQUFVLFNBQVUsWUFFN0JnRCxHQUFVLFVBQVcsU0FBVSxVQUFXLFFBRTFDM0UsRUFBTyxDQUVYLFFBQ0MyQixNQUFPQSxFQUNQZ0QsT0FBUUEsRUFDUjNFLEtBQU1BIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdBbmltYXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd1aS5yb3V0ZXInXSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJykucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdkckNlbGwvZHJDZWxsLmh0bWwnLCAnPGRpdiBjbGFzcz1cImNlbGxcIiBuZy1jbGFzcz1cImMucmV0dXJuQ2VsbENsYXNzKClcIj5cXG5cXHQ8ZGl2IGNsYXNzPVwiY2VsbF9fZmlnXCI+PC9kaXY+XFxuPC9kaXY+XFxuJyk7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZHJGaWVsZC9kckZpZWxkLmh0bWwnLCAnPHVsIGNsYXNzPVwiY2VsbC1saXN0XCI+XFxuXFx0PGxpIGNsYXNzPVwiY2VsbC1saXN0X19pdGVtXCJcXG5cXHRcXHRuZy1yZXBlYXQ9XCIoaWR4LCBjZWxsKSBpbiBjZi5jZWxscyB0cmFjayBieSBjZWxsLmlkXCJcXG5cXHRcXHRuZy1zdHlsZT1cIntcXCdsZWZ0XFwnOiBjZWxsLmNvbCo2MCArIFxcJ3B4XFwnLCBcXCd0b3BcXCc6IGNlbGwucm93KjYwICsgXFwncHhcXCd9XCJcXG5cXHRcXHRuZy1jbGljaz1cImNmLmNlbGxDTGljaygkZXZlbnQsIGNlbGwsIGlkeClcIj5cXG5cXG5cXHRcXHQ8ZHItY2VsbCB0eXBlPVwie3tjZWxsLnR5cGV9fVwiIHN0YXRlPVwie3tjZWxsLnN0YXRlfX1cIj48L2RyLWNlbGw+XFxuXFxuXFx0PC9saT5cXG48L3VsPicpO1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgbWFpbkN0cmwpO1xuXG5cdGZ1bmN0aW9uIG1haW5DdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkdGltZW91dCkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdHRoaXMuJGh0dHAgPSAkaHR0cDtcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcblxuXHRcdHRoaXMuY2VsbFN0YXRlID0gJ3NxdWFyZSc7XG5cblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdG1haW5DdHJsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge307XG5cblx0bWFpbkN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRodHRwJywgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnJHRpbWVvdXQnXTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ2RyQ2VsbCcsIFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcblx0XHRmdW5jdGlvbiBkckNlbGxMaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJHRpbWVvdXQpIHt9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0bGluazogZHJDZWxsTGluayxcblx0XHRcdHJlc3RyaWN0OiAnQUVDJyxcblx0XHRcdHNjb3BlOiB7fSxcblx0XHRcdHRlbXBsYXRlOiAkdGVtcGxhdGVDYWNoZS5nZXQoJ2RyQ2VsbC9kckNlbGwuaHRtbCcpLFxuXHRcdFx0Y29udHJvbGxlcjogZHJDZWxsQ3RybCxcblx0XHRcdGNvbnRyb2xsZXJBczogJ2MnLFxuXHRcdFx0YmluZFRvQ29udHJvbGxlcjoge1xuXHRcdFx0XHR0eXBlOiAnQD8nLFxuXHRcdFx0XHRzdGF0ZTogJ0A/J1xuXHRcdFx0fVxuXHRcdH07XG5cdH1dKTtcblxuXHR2YXIgZHJDZWxsQ3RybCA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBkckNlbGxDdHJsKCRzY29wZSwgJHRpbWVvdXQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBkckNlbGxDdHJsKTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0JjRgdC/0L7Qu9GM0LfRg9C10Lwg0L3QsCDQstGM0Y7RhdC1LCDQstC+0LfQstGA0LDRidCw0LXRgiBjc3Mt0LrQu9Cw0YHRgdGLINC00LvRjyDRgtC40L/QsCDQuCDRgdC+0YHRgtC+0Y/QvdC40Y8g0Y/Rh9C10LnQutC4XG4gICAqL1xuXG5cblx0XHRfY3JlYXRlQ2xhc3MoZHJDZWxsQ3RybCwgW3tcblx0XHRcdGtleTogJ3JldHVybkNlbGxDbGFzcycsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gcmV0dXJuQ2VsbENsYXNzKCkge1xuXHRcdFx0XHR2YXIgdHlwZSA9ICdjZWxsX3R5cGUtJyArICh0aGlzLnR5cGUgfHwgJ3NxdWFyZScpO1xuXHRcdFx0XHR2YXIgc3RhdGUgPSAnY2VsbF9zdGF0ZS0nICsgKHRoaXMuc3RhdGUgfHwgJ2RlZmF1bHQnKTtcblxuXHRcdFx0XHRyZXR1cm4gW3R5cGUsIHN0YXRlXTtcblx0XHRcdH1cblx0XHR9XSk7XG5cblx0XHRyZXR1cm4gZHJDZWxsQ3RybDtcblx0fSgpO1xuXG5cdGRyQ2VsbEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyR0aW1lb3V0J107XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZGlyZWN0aXZlKCdkckZpZWxkJywgWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuXHRcdGZ1bmN0aW9uIGRyRmllbGRMaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJHRpbWVvdXQpIHt9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0bGluazogZHJGaWVsZExpbmssXG5cdFx0XHRyZXN0cmljdDogJ0FFQycsXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZTogJHRlbXBsYXRlQ2FjaGUuZ2V0KCdkckZpZWxkL2RyRmllbGQuaHRtbCcpLFxuXHRcdFx0Y29udHJvbGxlcjogZHJGaWVsZEN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdjZicsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdGNlbGxDbGljazogJz0/Jyxcblx0XHRcdFx0c2l6ZTogJz0/Jyxcblx0XHRcdFx0Y3R4OiAnPT8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuXG5cdHZhciBkckZpZWxkQ3RybCA9IGZ1bmN0aW9uICgpIHtcblx0XHRmdW5jdGlvbiBkckZpZWxkQ3RybChkckZpZWxkU2VydmljZSwgZHJGaWxlZEZhY3RvcnksICRzY29wZSwgJHRpbWVvdXQpIHtcblx0XHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBkckZpZWxkQ3RybCk7XG5cblx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UgPSBkckZpZWxkU2VydmljZTtcblx0XHRcdHRoaXMuZHJGaWxlZEZhY3RvcnkgPSBkckZpbGVkRmFjdG9yeTtcblx0XHRcdGlmICh0aGlzLnNpemUpIHRoaXMuZHJGaWxlZEZhY3Rvcnkuc2l6ZSA9IHRoaXMuc2l6ZTtcblx0XHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdFx0dGhpcy4kdGltZW91dCA9ICR0aW1lb3V0O1xuXG5cdFx0XHR0aGlzLmluaXQoKTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0J/RgNC4INC40L3RhtC40LDQu9C40LfQsNGG0LjQuCDRgdC+0LfQtNCw0LXQvCDQvNCw0YHRgdC40LJcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhkckZpZWxkQ3RybCwgW3tcblx0XHRcdGtleTogJ2luaXQnLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdFx0XHRcdHRoaXMuY2VsbHMgPSB0aGlzLmRyRmllbGRTZXJ2aWNlLmNyZWF0ZU5ld0Fycih0aGlzLnNpemUpO1xuXHRcdFx0fVxuXG5cdFx0XHQvKipcbiAgICAqINCa0LvQuNC6INC/0L4g0Y/Rh9C10LnQutC1XG4gICAgKiA9PSDRgdC+0LHRi9GC0LjQtSwg0Y/Rh9C10LnQutCwLCDQuNC90LTQtdC60YEg0LIg0LzQsNGB0YHQuNCy0LUgPT1cbiAgICAqL1xuXG5cdFx0fSwge1xuXHRcdFx0a2V5OiAnY2VsbENMaWNrJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiBjZWxsQ0xpY2soZSwgY2VsbCwgaWR4KSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdFx0XHRpZiAoY2VsbC5zdGF0ZSA9PT0gJ2RlZmF1bHQnKSB7XG5cdFx0XHRcdFx0Ly8g0JrQu9C40Log0L/QviDRj9GH0LXQudC60LUg0YEg0LTQtdGE0L7Qu9GC0L3Ri9C8INGB0YLQsNGC0YPRgdC+0LwuINCU0LXQu9Cw0LXQvCDQtdGRINCw0LrRgtC40LLQvdC+0Lkg0Lgg0LLRi9C00LXQu9GP0LXQvCDQv9Cw0YHRgdC40LLQvtC8INCx0LvQuNC20LDQudGI0LjQtSDRj9GH0LXQudC60Lhcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2VsbHMubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2VsbHNbaV0uc3RhdGUgPSAnZGVmYXVsdCc7XG5cdFx0XHRcdFx0fXRoaXMuYWN0aXZlQ2VsbCA9IGNlbGw7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsLnN0YXRlID0gJ2FjdGl2ZSc7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsSWR4ID0gaWR4O1xuXHRcdFx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UubWFya0Nsb3Nlc3RDZWxsKGlkeCwgJ3Bhc3NpdmUnKTtcblx0XHRcdFx0fSBlbHNlIGlmIChjZWxsLnN0YXRlID09PSAncGFzc2l2ZScpIHtcblx0XHRcdFx0XHQvLyDQmtC70LjQuiDQv9C+INGP0YfQtdC50LrQtSDRgSDQv9Cw0YHRgdC40LLQvdGL0Lwg0YHRgtCw0YLRg9GB0L7QvFxuXHRcdFx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UucmVwbGFjZUVsZW1lbnRzKHRoaXMuYWN0aXZlQ2VsbElkeCwgaWR4KTtcblx0XHRcdFx0XHRmb3IgKHZhciBfaSA9IDA7IF9pIDwgdGhpcy5jZWxscy5sZW5ndGg7IF9pICs9IDEpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2VsbHNbX2ldLnN0YXRlID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRcdH10aGlzLiR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdC8vIHRoaXMuZHJGaWVsZFNlcnZpY2Vcblx0XHRcdFx0XHRcdC8vIFRPRE86INC/0L4g0YLQsNC50LzQsNGD0YLRgyDRgNC10LDQu9C40LfQvtCy0LDRgtGMINGB0LvRg9C00LXRjtGJ0LXQtSDQv9C+0LLQtdC00LXQvdC40LU6INC/0LXRgNC10YnQtdC90L3Ri9C5INCw0LrRgtC40LLQvdGL0Lkg0Y3Qu9C10LzQtdC90YIg0L7RgdGC0LDRkdGC0YHRjyDQsNC60YLQuNCy0L3Ri9C8INC90LAg0L3QvtCy0L7QvCDQvNC10YHRgtC1XG5cdFx0XHRcdFx0XHQvLyBUT0RPOiDQstGL0LTQtdC70LjRgtGMINC90L7QstGL0LUg0L/QsNGB0YHQuNCy0L3Ri9C1INGN0LvQtdC80LXQvdGC0Ytcblx0XHRcdFx0XHR9LCAyMDApO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGNlbGwuc3RhdGUgPT09ICdhY3RpdmUnKSB7XG5cdFx0XHRcdFx0Ly8g0JrQu9C40Log0L/QviDRj9GH0LXQudC60LUg0YEg0LDQutGC0LjQstC90YvQvCDRgdGC0LDRgtGD0YHQvtC8LiDQodC90LjQvNCw0LXQvCDQsNC60YLQuNCy0L3QvtGB0YLRjCDRgSDQvdC10ZEg0Lgg0LHQu9C40LbQsNC50YjQuNGFXG5cdFx0XHRcdFx0Y2VsbC5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGwgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsSWR4ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UubWFya0Nsb3Nlc3RDZWxsKGlkeCwgJ2RlZmF1bHQnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBkckZpZWxkQ3RybDtcblx0fSgpO1xuXG5cdGRyRmllbGRDdHJsLiRpbmplY3QgPSBbJ2RyRmllbGRTZXJ2aWNlJywgJ2RyRmlsZWRGYWN0b3J5JywgJyRzY29wZScsICckdGltZW91dCddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLnNlcnZpY2UoJ2RyRmllbGRTZXJ2aWNlJywgWydkckZpbGVkRmFjdG9yeScsICckdGltZW91dCcsIGZ1bmN0aW9uIChkckZpbGVkRmFjdG9yeSwgJHRpbWVvdXQpIHtcblx0XHQvKipcbiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBwcml2YXRlIG1ldGhvZHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICovXG5cdFx0dmFyIF9zZWxmID0gdGhpcztcblx0XHR0aGlzLm1hdHJpeE1vZGVsID0gW107XG5cdFx0dmFyIF9tbSA9IHRoaXMubWF0cml4TW9kZWw7XG5cblx0XHQvKipcbiAgICog0JLQvtC30LLRgNCw0YnQsNC10Lwg0YDQsNC90LTQvtC80L3Ri9C5INGN0LvQtdC80LXQvdGCINC80LDRgdGB0LjQstCwXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJldHVyblJhbmRFbGVtZW50KGFycikge1xuXHRcdFx0dmFyIGlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFyci5sZW5ndGgpO1xuXHRcdFx0cmV0dXJuIGFycltpZHhdO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQktC+0LfQstGA0LDRidCw0LXQvCDRgNCw0L3QtNC+0LzQvdGL0Lkg0Y3Qu9C10LzQtdC90YIg0LzQsNGB0YHQuNCy0LAsINC40YHQutC70Y7Rh9Cw0Y8g0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LIg0YTRg9C90LrRhtC40Y5cbiAgICovXG5cdFx0ZnVuY3Rpb24gcmV0dXJuQW5vdGhlclR5cGUocmVwZWF0VHlwZXMpIHtcblx0XHRcdHZhciBuZXdBcnIgPSBhbmd1bGFyLmNvcHkoZHJGaWxlZEZhY3RvcnkudHlwZXMpO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJlcGVhdFR5cGVzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbmV3QXJyLmxlbmd0aDsgaiArPSAxKSB7XG5cdFx0XHRcdFx0aWYgKHJlcGVhdFR5cGVzW2ldID09PSBuZXdBcnJbal0pIG5ld0Fyci5zcGxpY2UoaiwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJldHVyblJhbmRFbGVtZW50KG5ld0Fycik7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCk0YPQvdC60YbQuNGPINC/0YDQvtGB0YLQsNCy0LvRj9C10YIg0Y3Qu9C10LzQtdC90YLRi9C8INC80LDRgdGB0LjQstCwINC60L7QvtGA0LTQuNC90LDRgtGLICjQv9C+0LvRjyBcImNvbFwiLCBcInJvd1wiKSDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YJcbiAgICog0LLRgtC+0YDQvtCz0L4g0L/QsNGA0LDQvNC10YLRgNCwIHNpemUgKNGI0LjRgNC40L3QsCDQvNCw0YHRgdC40LLQsClcbiAgICovXG5cdFx0ZnVuY3Rpb24gc2V0Q29vcmRzVG9FbGVtZW50cygpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgX21tLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdF9tbVtpXS5jb2wgPSBpICUgX3NlbGYuc2l6ZTtcblx0XHRcdFx0X21tW2ldLnJvdyA9IE1hdGguZmxvb3IoaSAvIF9zZWxmLnNpemUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0LjQvdC40LzQsNC10YIg0LzQsNGB0YHQuNCyLCDQsiDQutC+0YLQvtGA0YvQuSDQtNC+0LHQsNCy0LvRj9C10YIg0L3QvtCy0YvQuSDRjdC70LXQvNC10L3Rgi5cbiAgICog0J/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4INCy0YvQv9C+0LvQvdGP0LXRgiDQtNCy0LUg0L/RgNC+0LLQtdGA0LrQuDpcbiAgICogLSDQtdGB0LvQuCDRgtC40L/RiyDQtNCy0YPRhSDQv9GA0LXQtNGL0LTRg9GJ0LjRhSDQvtCx0YrQtdC60YIg0YDQsNCy0L3RiyDRgtC10LrRg9GJ0LXQvNGDINGB0LPQtdC90LXRgNC40YDQvtCy0LDQvdC90L7QvNGDINGC0LjQv9GDLCDRgtC+INCz0LXQvdC10YDQuNGA0YPQtdC8INC90L7QstGL0LlcbiAgICogLSDQtdGB0LvQuCDRgtC40L/RiyDQtNCy0YPRhSDQvtCx0YrQtdC60YLQvtCyINC90LDQtCDRgtC10LrRg9C30LjQvCDRgNCw0LLQvdGLINGC0LXQutGD0YnQtdC80YMg0YHQs9C10L3QtdGA0LjRgNC+0LLQsNC90L3QvtC80YMg0YLQuNC/0YMsINGC0L4g0LPQtdC90LXRgNC40YDRg9C10Lwg0L3QvtCy0YvQuVxuICAgKi9cblx0XHRmdW5jdGlvbiBjcmVhdGVFbGVtZW50KGlkeCkge1xuXHRcdFx0dmFyIHR5cGUgPSByZXR1cm5SYW5kRWxlbWVudChkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdHZhciByZXBlYXRUeXBlcyA9IFtdO1xuXG5cdFx0XHQvLyDQn9GA0L7QstC10YDQutC4INC90LAg0LPQvtGA0LjQt9C+0L3RgtCw0LvRjNC90YvQtSDQuCDQstC10YDRgtC40LrQsNC70YzQvdGL0LUg0YHQvtCy0L/QsNC00LXQvdC40Y8g0L/RgNC4INCz0LXQvdC10YDQsNGG0LjQuFxuXHRcdFx0Y2hlY2tIUmVwKHJlcGVhdFR5cGVzKTtcblx0XHRcdGNoZWNrVlJlcChyZXBlYXRUeXBlcyk7XG5cblx0XHRcdGlmIChyZXBlYXRUeXBlcy5sZW5ndGgpIHR5cGUgPSByZXR1cm5Bbm90aGVyVHlwZShyZXBlYXRUeXBlcyk7XG5cblx0XHRcdF9tbS5wdXNoKHtcblx0XHRcdFx0aWQ6IGlkeCxcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0c3RhdGU6ICdkZWZhdWx0J1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCf0YDQvtCy0LXRgNC60LAg0L3QsCDQs9C+0YDQuNC30L7QvdGC0LDQu9GM0L3QvtC1INC/0L7QstGC0L7RgNC10L3QuNC1XG4gICAqL1xuXHRcdGZ1bmN0aW9uIGNoZWNrSFJlcChyZXBlYXRUeXBlcykge1xuXHRcdFx0dmFyIHMgPSBfc2VsZi5zaXplO1xuXHRcdFx0dmFyIGNvbElkeCA9IF9tbS5sZW5ndGggJSBzO1xuXHRcdFx0aWYgKGNvbElkeCA+IDEpIHtcblx0XHRcdFx0aWYgKF9tbVtfbW0ubGVuZ3RoIC0gMl0udHlwZSA9PT0gX21tW19tbS5sZW5ndGggLSAxXS50eXBlKSB7XG5cdFx0XHRcdFx0cmVwZWF0VHlwZXMucHVzaChfbW1bX21tLmxlbmd0aCAtIDFdLnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCf0YDQvtCy0LXRgNC60LAg0L3QsCDQstC10YDRgtC40LrQsNC70YzQvdC+0LUg0L/QvtCy0YLQvtGA0LXQvdC40LVcbiAgICovXG5cdFx0ZnVuY3Rpb24gY2hlY2tWUmVwKHJlcGVhdFR5cGVzKSB7XG5cdFx0XHR2YXIgcyA9IF9zZWxmLnNpemU7XG5cdFx0XHR2YXIgcm93SWR4ID0gTWF0aC5mbG9vcihfbW0ubGVuZ3RoIC8gcyk7XG5cdFx0XHRpZiAocm93SWR4ID4gMSkge1xuXHRcdFx0XHRpZiAoX21tW19tbS5sZW5ndGggLSBzXS50eXBlID09PSBfbW1bX21tLmxlbmd0aCAtIHMgKiAyXS50eXBlKSB7XG5cdFx0XHRcdFx0cmVwZWF0VHlwZXMucHVzaChfbW1bX21tLmxlbmd0aCAtIHNdLnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCk0YPQvdC60YbQuNGPINC/0YDQvtCy0LXRgNGP0LXRgiDQvdCwINCz0L7RgNC40LfQvtC90YLQsNC70YzQvdGL0LUg0YHQvtCy0L/QsNC00LXQvdC40Y9cbiAgICovXG5cdFx0ZnVuY3Rpb24gY291bnRSZXBlYXRJblJvdyhyZXN1bHQpIHtcblx0XHRcdHZhciBzaXplID0gX3NlbGYuc2l6ZTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfbW0ubGVuZ3RoOyBpICs9IHNpemUpIHtcblx0XHRcdFx0dmFyIGRlbElkeEFyciA9IFtpXSxcblx0XHRcdFx0ICAgIGN1cnJlbnRUeXBlID0gX21tW2ldLnR5cGU7XG5cblx0XHRcdFx0bmV4dDogZm9yICh2YXIgaiA9IDE7IGogPCBzaXplOyBqICs9IDEpIHtcblx0XHRcdFx0XHRpZiAoX21tW2kgKyBqXS50eXBlID09PSAnZW1wdHknIHx8IGN1cnJlbnRUeXBlICE9PSBfbW1baSArIGpdLnR5cGUpIHtcblx0XHRcdFx0XHRcdGlmIChkZWxJZHhBcnIubGVuZ3RoID4gMikgYnJlYWs7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIubGVuZ3RoID0gMDtcblx0XHRcdFx0XHRcdGRlbElkeEFyci5wdXNoKGkgKyBqKTtcblx0XHRcdFx0XHRcdGN1cnJlbnRUeXBlID0gX21tW2kgKyBqXS50eXBlO1xuXHRcdFx0XHRcdFx0Y29udGludWUgbmV4dDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZGVsSWR4QXJyLnB1c2goaSArIGopO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZGVsSWR4QXJyLmxlbmd0aCA+IDIpIHtcblx0XHRcdFx0XHRyZXN1bHQucHVzaCh7XG5cdFx0XHRcdFx0XHRsZW5ndGg6IGRlbElkeEFyci5sZW5ndGgsXG5cdFx0XHRcdFx0XHR0eXBlOiBjdXJyZW50VHlwZSxcblx0XHRcdFx0XHRcdGlkeEFycjogYW5ndWxhci5jb3B5KGRlbElkeEFycilcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkZWxJZHhBcnIubGVuZ3RoID0gMDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICog0KTRg9C90LrRhtC40Y8g0L/RgNC+0LLQtdGA0Y/QtdGCINC90LAg0LLQtdGA0YLQuNC60LDQu9GM0L3Ri9C1INGB0L7QstC/0LDQtNC10L3QuNGPXG4gICAqL1xuXHRcdGZ1bmN0aW9uIGNvdW50UmVwZWF0SW5Db2wocmVzdWx0KSB7XG5cdFx0XHR2YXIgc2l6ZSA9IF9zZWxmLnNpemU7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSArPSAxKSB7XG5cdFx0XHRcdHZhciBkZWxJZHhBcnIgPSBbaV0sXG5cdFx0XHRcdCAgICBjdXJyZW50VHlwZSA9IF9tbVtpXS50eXBlO1xuXG5cdFx0XHRcdG5leHQ6IGZvciAodmFyIGogPSAxOyBqIDwgc2l6ZTsgaiArPSAxKSB7XG5cdFx0XHRcdFx0aWYgKF9tbVtpICsgaiAqIHNpemVdLnR5cGUgPT09ICdlbXB0eScgfHwgY3VycmVudFR5cGUgIT09IF9tbVtpICsgaiAqIHNpemVdLnR5cGUpIHtcblx0XHRcdFx0XHRcdGlmIChkZWxJZHhBcnIubGVuZ3RoID4gMikgYnJlYWs7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIubGVuZ3RoID0gMDtcblx0XHRcdFx0XHRcdGRlbElkeEFyci5wdXNoKGkgKyBqICogc2l6ZSk7XG5cdFx0XHRcdFx0XHRjdXJyZW50VHlwZSA9IF9tbVtpICsgaiAqIHNpemVdLnR5cGU7XG5cdFx0XHRcdFx0XHRjb250aW51ZSBuZXh0O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRkZWxJZHhBcnIucHVzaChpICsgaiAqIHNpemUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZGVsSWR4QXJyLmxlbmd0aCA+IDIpIHtcblx0XHRcdFx0XHRyZXN1bHQucHVzaCh7XG5cdFx0XHRcdFx0XHRsZW5ndGg6IGRlbElkeEFyci5sZW5ndGgsXG5cdFx0XHRcdFx0XHR0eXBlOiBjdXJyZW50VHlwZSxcblx0XHRcdFx0XHRcdGlkeEFycjogYW5ndWxhci5jb3B5KGRlbElkeEFycilcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRkZWxJZHhBcnIubGVuZ3RoID0gMDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBwdWJsaWMgbWV0aG9kcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgKi9cblxuXHRcdC8qKlxuICAgKiDQnNC10YLQvtC0INGB0LXRgNCy0LjRgdCwINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCINC90L7QstGL0Lkg0LzQsNGB0YHQuNCyINC00LvQuNC90L7QuSBzaXplKnNpemVcbiAgICovXG5cdFx0dGhpcy5jcmVhdGVOZXdBcnIgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXHRcdFx0X21tLmxlbmd0aCA9IDA7XG5cdFx0XHR0aGlzLnNpemUgPSBzaXplIHx8IGRyRmlsZWRGYWN0b3J5LnNpemU7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZSAqIHNpemU7IGkrKykge1xuXHRcdFx0XHRjcmVhdGVFbGVtZW50KGkpO1xuXHRcdFx0fXNldENvb3Jkc1RvRWxlbWVudHMoKTtcblxuXHRcdFx0cmV0dXJuIF9tbTtcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCX0LDQtNCw0LXQvCDRgdC+0YHRgtC+0Y/QvdC40LUg0LHQu9C40LbQsNC50YjQuNC8INGN0LvQtdC80LXQvdGC0LDQvCDQvtGCINCy0YvQtNC10LvQtdC90L3QvtCz0L5cbiAgICovXG5cdFx0dGhpcy5tYXJrQ2xvc2VzdENlbGwgPSBmdW5jdGlvbiAoaWR4LCBzdGF0ZSkge1xuXHRcdFx0dmFyIHNpemUgPSBfc2VsZi5zaXplO1xuXG5cdFx0XHRpZiAoX21tW2lkeCAtIHNpemVdKSBfbW1baWR4IC0gc2l6ZV0uc3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChfbW1baWR4ICsgc2l6ZV0pIF9tbVtpZHggKyBzaXplXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKF9tbVtpZHggLSAxXSkgX21tW2lkeCAtIDFdLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRpZiAoX21tW2lkeCArIDFdKSBfbW1baWR4ICsgMV0uc3RhdGUgPSBzdGF0ZTtcblx0XHR9O1xuXG5cdFx0LyoqXG4gICAqINCc0LXQvdGP0LXQvCDQvNC10YHRgtCw0LzQuCDRj9GH0LXQudC60LguINCQ0LvQs9C+0YDQuNGC0Lw6XG4gICAqIC0g0YHQvdCw0YfQsNC70LAg0LzQtdC90Y/QtdC8INC/0LDRgNCw0LzQtdC90YLRgNGLIGNvbC9yb3cgKNC00LvRjyDQsNC90LjQvNCw0YbQuCkuXG4gICAqIC0g0L/QvtGB0LvQtSDQv9C+INGC0LDQudC80LDRg9GC0YMg0LzQtdC90Y/QtdC8INC00LDQvdC90YvQtSDQvtCx0YrQtdC60YLQvtCyINCyINGB0LDQvNC+0Lwg0LzQsNGB0YHQuNCy0LUgKNGE0LjQs9GD0YDRgylcbiAgICovXG5cdFx0dGhpcy5yZXBsYWNlRWxlbWVudHMgPSBmdW5jdGlvbiAoaWR4MSwgaWR4Mikge1xuXHRcdFx0dmFyIHRlbXAgPSB7XG5cdFx0XHRcdGNvbDE6IF9tbVtpZHgxXS5jb2wsXG5cdFx0XHRcdHJvdzE6IF9tbVtpZHgxXS5yb3csXG5cdFx0XHRcdGNvbDI6IF9tbVtpZHgyXS5jb2wsXG5cdFx0XHRcdHJvdzI6IF9tbVtpZHgyXS5yb3dcblx0XHRcdH07XG5cblx0XHRcdF9tbVtpZHgxXS5jb2wgPSB0ZW1wLmNvbDI7XG5cdFx0XHRfbW1baWR4MV0ucm93ID0gdGVtcC5yb3cyO1xuXG5cdFx0XHRfbW1baWR4Ml0uY29sID0gdGVtcC5jb2wxO1xuXHRcdFx0X21tW2lkeDJdLnJvdyA9IHRlbXAucm93MTtcblxuXHRcdFx0X21tLnNvcnQoc29ydEFyckJ5Um93Q29sKTtcblxuXHRcdFx0cmVjdXJEZWxldGVFbCgpO1xuXHRcdH07XG5cblx0XHRmdW5jdGlvbiByZWN1ckRlbGV0ZUVsKCkge31cblxuXHRcdC8qKlxuICAgKiDQn9GA0L7QstC10YDRj9C10Lwg0L3QsCDQvtCx0YrQtdC60YLRiyDQvtC00LjQvdCw0LrQvtCy0L7Qs9C+INGC0LjQv9CwINCyINGB0YLRgNC+0LrQsNGFXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJlY3VyRGVsZXRlRWwoKSB7XG5cdFx0XHR2YXIgcmVzdWx0ID0gW107XG5cblx0XHRcdGNvdW50UmVwZWF0SW5Sb3cocmVzdWx0KTtcblx0XHRcdGNvdW50UmVwZWF0SW5Db2wocmVzdWx0KTtcblxuXHRcdFx0aWYgKCFyZXN1bHQubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0XHRcdF9zZWxmLmRlbGV0ZUVsZW1lbnRzKHJlc3VsdCk7XG5cblx0XHRcdF9zZWxmLm1vdmVUb3BFbCgpO1xuXG5cdFx0XHRfbW0uc29ydChzb3J0QXJyQnlSb3dDb2wpO1xuXG5cdFx0XHRyZWN1ckRlbGV0ZUVsKCk7XG5cdFx0fVxuXG5cdFx0LyoqXG4gICAqINCj0LTQsNC70Y/QtdC8INC+0LHRitC10LrRgtGLINC+0LTQuNC90LDQutC+0LLQvtCz0L4g0YLQuNC/0LAsINC10YHQu9C4INC40YUg0LHQvtC70YzRiNC1INGC0YDRkdGFINCyINGB0YLRgNC+0LrQtSDQuNC70Lgg0LIg0LrQvtC70L7QvdC60LVcbiAgICovXG5cdFx0dGhpcy5kZWxldGVFbGVtZW50cyA9IGZ1bmN0aW9uIChkZWxBcnIpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGVsQXJyLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdHZhciBsaW5lID0gZGVsQXJyW2ldO1xuXG5cdFx0XHRcdC8vINGD0LTQsNC70Y/QtdC80YvQvCDRj9GH0LXQudC60LDQvCDQv9GA0LjRgdCy0LDQuNCy0LDQtdC8INGC0LjQvyBcImVtcHR5XCJcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBsaW5lLmlkeEFyci5sZW5ndGg7IGogKz0gMSkge1xuXHRcdFx0XHRcdF9tbVtsaW5lLmlkeEFycltqXV0udHlwZSA9ICdlbXB0eSc7XG5cdFx0XHRcdH0gLy8g0KPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0LjQvCDRgdGC0LDRgtGD0YEgXCJkZWZhdWx0XCJcblx0XHRcdFx0Zm9yICh2YXIgX2ogPSAwOyBfaiA8IF9tbS5sZW5ndGg7IF9qICs9IDEpIHtcblx0XHRcdFx0XHRfbW1bX2pdLnN0YXRlID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8qKlxuICAgKiDQldGB0LvQuCDQvdCw0LQg0L/Rg9GB0YLRi9C80Lgg0LzQtdGB0YLQsNC80Lgg0L7RgdGC0LDQu9C40YHRjCDRhNC40LPRg9GA0YsgLSDQvtC/0YPRgdC60LDQtdC8INC40YVcbiAgICovXG5cdFx0dGhpcy5tb3ZlVG9wRWwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvLyDQnNCw0YHRgdC40LIsINC60L7RgtC+0YDRi9C5INGF0YDQsNC90LjRgiDQuNC90LTQtdC60YHRiyDRgSDQv9GD0YHRgtGL0LzQuCDRjdC70LXQvNC10L3RgtCw0LzQuFxuXHRcdFx0dmFyIHNpemUgPSBkckZpbGVkRmFjdG9yeS5zaXplO1xuXG5cdFx0XHRuZXh0OiBmb3IgKHZhciBjb3VudCA9IDAsIGkgPSAwLCBlbXB0eUNvdW50ID0gMCwgZW1wdHlTdGFydElkeDsgaSA8IF9tbS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRpZiAoaSA+IDAgJiYgaSAlIHNpemUgPT09IDApIHtcblx0XHRcdFx0XHRlbXB0eVN0YXJ0SWR4ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGVtcHR5Q291bnQgPSAwO1xuXHRcdFx0XHRcdGNvdW50Kys7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgcm93SWR4ID0gaSAlIHNpemUgKiBzaXplICsgY291bnQ7XG5cblx0XHRcdFx0aWYgKF9tbVtyb3dJZHhdLnR5cGUgPT09ICdlbXB0eScpIHtcblx0XHRcdFx0XHRpZiAoIWVtcHR5U3RhcnRJZHgpIGVtcHR5U3RhcnRJZHggPSByb3dJZHg7XG5cdFx0XHRcdFx0ZW1wdHlDb3VudCsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8g0J/RgNC+0LLQtdGA0LrQsCDQvdCwINC/0L7RgdC70LXQtNC90LjQuSDRjdC70LXQvNC10L3RgiDQsiDRgdGC0L7Qu9Cx0YbQtVxuXHRcdFx0XHRpZiAoaSA+IDAgJiYgKGkgKyAxKSAlIHNpemUgPT09IDAgJiYgZW1wdHlDb3VudCA+IDApIHtcblx0XHRcdFx0XHRtb3ZlRWxlbWVudHMoZW1wdHlTdGFydElkeCwgZW1wdHlDb3VudCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0ZnVuY3Rpb24gbW92ZUVsZW1lbnRzKGVtcHR5U3RhcnRJZHgsIGVtcHR5Q291bnQpIHtcblx0XHRcdHZhciBzaXplID0gZHJGaWxlZEZhY3Rvcnkuc2l6ZTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKCfQoNCw0LHQvtGC0LDQtdC8INGB0L4g0YHRgtC+0LvQsdGG0L7QvCAnLCBjb3VudCk7XG5cdFx0XHR2YXIgY291bnRPZk1vdmFibGVFbCA9IE1hdGguZmxvb3IoZW1wdHlTdGFydElkeCAvIHNpemUpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coJ9Cf0LXRgNC10LTQstC40LPQsNC10LwgJywgY291bnRPZk1vdmFibGVFbCwgJyDQtdC70LXQvNC10L3RgtC+0LIg0LIg0YHRgtC+0LHQu9GG0LUgJywgY291bnQpO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMCwgYyA9IGVtcHR5U3RhcnRJZHg7IGkgPCBlbXB0eUNvdW50OyBpICs9IDEpIHtcblx0XHRcdFx0X21tW2NdLnJvdyAtPSBjb3VudE9mTW92YWJsZUVsO1xuXHRcdFx0XHRjICs9IHNpemU7XG5cdFx0XHR9XG5cdFx0XHRmb3IgKHZhciBfaSA9IDAsIF9jID0gZW1wdHlTdGFydElkeDsgX2kgPCBjb3VudE9mTW92YWJsZUVsOyBfaSArPSAxKSB7XG5cdFx0XHRcdF9jIC09IHNpemU7XG5cdFx0XHRcdF9tbVtfY10ucm93ICs9IGVtcHR5Q291bnQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKCfQk9C10L3QtdGA0LjRgNGD0LXQvCAnLCBlbXB0eUNvdW50LCAnINC90L7QstGL0YUg0Y3Qu9C10LzQtdC90YLQvtCyINCyINGB0YLQvtCx0LvRhtC1ICcsIGNvdW50KTtcblx0XHR9XG5cblx0XHQvKipcbiAgICog0KHQvtGA0YLQuNGA0L7QstC60LAg0LzQsNGB0YHQuNCy0LAg0L/QviDQt9C90LDRh9C10L3QuNGPIG9iai5yb3cg0Lggb2JqLmNvbCDRjdC70LXQvNC10L3RgtC+0LIuINCY0YHQv9C+0LvRjNC30YPQtdGC0YHRjyDQv9C+0YHQu9C1INC/0LXRgNC10YHRgtCw0L3QvtCy0L7QuiDQuCDRg9C00LDQu9C10L3QuNC5XG4gICAqICjQtNC70Y8g0YHQuNC90YXRgNC+0L3QuNC30LDRhtC40Lgg0LLRjNGO0YXQuCDQuCDQvNC+0LTQtdC70LgsINGCLtC6LiDQvdCwINCy0YzRjtGF0LUg0L/RgNC4INC/0LXRgNC10LzQtdGJ0LXQvdC40Lgg0LzRiyDQvdC1INC80LXQvdGP0LvQuCDQvNC+0LTQtdC70YwpXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHNvcnRBcnJCeVJvd0NvbChhLCBiKSB7XG5cdFx0XHRpZiAoYS5yb3cgIT09IGIucm93KSB7XG5cdFx0XHRcdHJldHVybiBhLnJvdyAtIGIucm93O1xuXHRcdFx0fSBlbHNlIGlmIChhLnJvdyA9PT0gYi5yb3cpIHtcblx0XHRcdFx0cmV0dXJuIGEuY29sIC0gYi5jb2w7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnZHJGaWxlZEZhY3RvcnknLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHR5cGVzID0gWydzcXVhcmUnLCAnY2lyY2xlJywgJ3RyaWFuZ2xlJ107XG5cblx0XHR2YXIgc3RhdGVzID0gWydkZWZhdWx0JywgJ2FjdGl2ZScsICdwYXNzaXZlJywgJ25vdGUnXTtcblxuXHRcdHZhciBzaXplID0gOTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHR0eXBlczogdHlwZXMsXG5cdFx0XHRzdGF0ZXM6IHN0YXRlcyxcblx0XHRcdHNpemU6IHNpemVcblx0XHR9O1xuXHR9KTtcbn0pKCk7Il19
