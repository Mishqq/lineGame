"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router"])}(),angular.module("app").run(["$templateCache",function(e){e.put("drCell/drCell.html",'<div class="cell" ng-class="c.returnCellClass()">\n\t<div class="cell__fig"></div>\n</div>\n'),e.put("drField/drField.html",'<ul class="cell-list">\n\t<li class="cell-list__item"\n\t\tng-repeat="(idx, cell) in cf.cells"\n\t\tng-style="{\'left\': cell.col*60 + \'px\', \'top\': cell.row*60 + \'px\'}"\n\t\tng-click="cf.cellCLick($event, cell, idx)">\n\n\t\t<dr-cell type="{{cell.type}}" state="{{cell.state}}"></dr-cell>\n\n\t</li>\n</ul>')}]),function(){function e(e,t,l,n,i){this.$scope=e,this.$http=t,this.$state=l,this.cellState="square",this.init()}angular.module("app").controller("mainCtrl",e),e.prototype.init=function(){},e.$inject=["$scope","$http","$state","$stateParams","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}();!function(){angular.module("app").directive("drCell",["$templateCache",function(t){function l(e,t,l,n){}return{link:l,restrict:"AEC",scope:{},template:t.get("drCell/drCell.html"),controller:e,controllerAs:"c",bindToController:{type:"@?",state:"@?"}}}]);var e=function(){function e(t,l){_classCallCheck(this,e)}return _createClass(e,[{key:"returnCellClass",value:function(){var e="cell_type-"+(this.type||"square"),t="cell_state-"+(this.state||"default");return[e,t]}}]),e}();e.$inject=["$scope","$timeout"]}();var _createClass=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}();!function(){angular.module("app").directive("drField",["$templateCache",function(t){function l(e,t,l,n){}return{link:l,restrict:"AEC",scope:{},template:t.get("drField/drField.html"),controller:e,controllerAs:"cf",bindToController:{cellClick:"=?",size:"=?",ctx:"=?"}}}]);var e=function(){function e(t){_classCallCheck(this,e),this.drFieldService=t,this.init()}return _createClass(e,[{key:"init",value:function(){this.cells=this.drFieldService.createNewArr(this.size)}},{key:"cellCLick",value:function(e,t,l){e.preventDefault(),e.stopPropagation(),this.activeCell||(this.activeCell=t);var n=void 0,i=void 0;if("passive"===t.state){var r={col:this.activeCell.col,row:this.activeCell.row},a={col:t.col,row:t.row};return this.activeCell.col=a.col,this.activeCell.row=a.row,t.col=r.col,void(t.row=r.row)}if(this.activeCell==this.cells[l])this.activeCell.state="active"===this.activeCell.state?"default":"active",i="active"===this.activeCell.state;else{for(var c=0;c<this.cells.length;c+=1)this.cells[c].state="default";t.state="active",i="active"===t.state}n=i?"passive":"default",this.drFieldService.markClosestCell(this.cells,this.size,l,n),this.activeCell=t}}]),e}();e.$inject=["drFieldService"]}(),function(){angular.module("app").service("drFieldService",["drFiledFactory",function(e){function t(e){var t=Math.floor(Math.random()*e.length);return e[t]}function l(l){for(var n=angular.copy(e.types),i=0;i<n.length;i+=1)n[i]===l&&n.splice(i,1);return t(n)}function n(e,t){for(var l=0;l<e.length;l+=1)e[l].col=l%t,e[l].row=Math.floor(l/t)}function i(n,i){var r=t(e.types);n[n.length-1]&&n[n.length-2]&&n[n.length-1].type===r&&n[n.length-2].type===r?r=l(r):n[n.length-i]&&n[n.length-2*i]&&n[n.length-i].type===r&&n[n.length-2*i].type===r&&(r=l(r)),n.push({type:r,state:"default"})}this.createNewArr=function(e){for(var t=[],l=0;l<e*e;l++)i(t,e);return n(t,e),t},this.markClosestCell=function(e,t,l,n){e[l-t]&&(e[l-t].state=n),e[l+t]&&(e[l+t].state=n),e[l-1]&&(e[l-1].state=n),e[l+1]&&(e[l+1].state=n)}}])}(),function(){angular.module("app").factory("drFiledFactory",function(){var e=["square","circle","triangle"],t=["default","active","passive","note"];return{types:e,states:t}})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwibWFpbkN0cmwiLCIkc2NvcGUiLCIkaHR0cCIsIiRzdGF0ZSIsIiRzdGF0ZVBhcmFtcyIsIiR0aW1lb3V0IiwidGhpcyIsImNlbGxTdGF0ZSIsImluaXQiLCJjb250cm9sbGVyIiwicHJvdG90eXBlIiwiJGluamVjdCIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJkaXJlY3RpdmUiLCJkckNlbGxMaW5rIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCJsaW5rIiwicmVzdHJpY3QiLCJzY29wZSIsInRlbXBsYXRlIiwiZ2V0IiwiZHJDZWxsQ3RybCIsImNvbnRyb2xsZXJBcyIsImJpbmRUb0NvbnRyb2xsZXIiLCJ0eXBlIiwic3RhdGUiLCJ2YWx1ZSIsImRyRmllbGRMaW5rIiwiZHJGaWVsZEN0cmwiLCJjZWxsQ2xpY2siLCJzaXplIiwiY3R4IiwiZHJGaWVsZFNlcnZpY2UiLCJjZWxscyIsImNyZWF0ZU5ld0FyciIsImUiLCJjZWxsIiwiaWR4IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJhY3RpdmVDZWxsIiwiY3VycmVudFN0YXRlIiwiY29vcmRzXzEiLCJjb2wiLCJyb3ciLCJjb29yZHNfMiIsIm1hcmtDbG9zZXN0Q2VsbCIsInNlcnZpY2UiLCJkckZpbGVkRmFjdG9yeSIsInJldHVyblJhbmRFbGVtZW50IiwiYXJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmV0dXJuQW5vdGhlclR5cGUiLCJuZXdBcnIiLCJjb3B5IiwidHlwZXMiLCJzcGxpY2UiLCJzZXRDb29yZHNUb0VsZW1lbnRzIiwiY3JlYXRlRWxlbWVudCIsInB1c2giLCJmYWN0b3J5Iiwic3RhdGVzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQW9DQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FpRGhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHNDQW5GaEgsV0FDQ0MsUUFBUUMsT0FBTyxPQUFRLFlBQWEsYUFBYyxhQUFjLGlCQUlqRUQsUUFBUUMsT0FBTyxPQUFPQyxLQUFLLGlCQUFrQixTQUFVQyxHQUNyREEsRUFBZUMsSUFBSSxxQkFBc0IsZ0dBQ3pDRCxFQUFlQyxJQUFJLHVCQUF3QiwrVEFJN0MsV0FLQyxRQUFTQyxHQUFTQyxFQUFRQyxFQUFPQyxFQUFRQyxFQUFjQyxHQUN0REMsS0FBS0wsT0FBU0EsRUFDZEssS0FBS0osTUFBUUEsRUFDYkksS0FBS0gsT0FBU0EsRUFFZEcsS0FBS0MsVUFBWSxTQUVqQkQsS0FBS0UsT0FUTmIsUUFBUUMsT0FBTyxPQUFPYSxXQUFXLFdBQVlULEdBWTdDQSxFQUFTVSxVQUFVRixLQUFPLGFBRTFCUixFQUFTVyxTQUFXLFNBQVUsUUFBUyxTQUFVLGVBQWdCLGNBSWxFLElBQUlDLGNBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFBT0QsRUFBV0UsY0FBZSxFQUFVLFNBQVdGLEtBQVlBLEVBQVdHLFVBQVcsR0FBTUMsT0FBT0MsZUFBZVQsRUFBUUksRUFBV00sSUFBS04sSUFBaUIsTUFBTyxVQUFVekIsRUFBYWdDLEVBQVlDLEdB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UyxHQUFHc0IsT0FBU0EsRUFDbkhBLEVBQU84QixFQUFrQjlCLEdBQ2YwQixFQUFJQSxFQUFJaEQsT0FBUzRCLElBQVNvQixFQUFJQSxFQUFJaEQsT0FBZ0IsRUFBUDRCLElBQWFvQixFQUFJQSxFQUFJaEQsT0FBUzRCLEdBQU1OLE9BQVNBLEdBQVEwQixFQUFJQSxFQUFJaEQsT0FBZ0IsRUFBUDRCLEdBQVVOLE9BQVNBLElBQzlJQSxFQUFPOEIsRUFBa0I5QixJQUcxQjBCLEVBQUlXLE1BQ0hyQyxLQUFNQSxFQUNOQyxNQUFPLFlBT1RsQyxLQUFLMkMsYUFBZSxTQUFVSixHQUc3QixJQUFLLEdBRkRvQixNQUVLakQsRUFBSSxFQUFHQSxFQUFJNkIsRUFBT0EsRUFBTTdCLElBQ2hDMkQsRUFBY1YsRUFBS3BCLEVBS3BCLE9BRkE2QixHQUFvQlQsRUFBS3BCLEdBRWxCb0IsR0FHUjNELEtBQUt1RCxnQkFBa0IsU0FBVUksRUFBS3BCLEVBQU1PLEVBQUtaLEdBQzVDeUIsRUFBSWIsRUFBTVAsS0FBT29CLEVBQUliLEVBQU1QLEdBQU1MLE1BQVFBLEdBQ3pDeUIsRUFBSWIsRUFBTVAsS0FBT29CLEVBQUliLEVBQU1QLEdBQU1MLE1BQVFBLEdBQ3pDeUIsRUFBSWIsRUFBTSxLQUFJYSxFQUFJYixFQUFNLEdBQUdaLE1BQVFBLEdBQ25DeUIsRUFBSWIsRUFBTSxLQUFJYSxFQUFJYixFQUFNLEdBQUdaLE1BQVFBLFVBTTFDLFdBQ0M3QyxRQUFRQyxPQUFPLE9BQU9pRixRQUFRLGlCQUFrQixXQUMvQyxHQUFJTCxJQUFTLFNBQVUsU0FBVSxZQUU3Qk0sR0FBVSxVQUFXLFNBQVUsVUFBVyxPQUU5QyxRQUNDTixNQUFPQSxFQUNQTSxPQUFRQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nQW5pbWF0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnLCAndWkucm91dGVyJ10pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnZHJDZWxsL2RyQ2VsbC5odG1sJywgJzxkaXYgY2xhc3M9XCJjZWxsXCIgbmctY2xhc3M9XCJjLnJldHVybkNlbGxDbGFzcygpXCI+XFxuXFx0PGRpdiBjbGFzcz1cImNlbGxfX2ZpZ1wiPjwvZGl2PlxcbjwvZGl2PlxcbicpO1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJ2RyRmllbGQvZHJGaWVsZC5odG1sJywgJzx1bCBjbGFzcz1cImNlbGwtbGlzdFwiPlxcblxcdDxsaSBjbGFzcz1cImNlbGwtbGlzdF9faXRlbVwiXFxuXFx0XFx0bmctcmVwZWF0PVwiKGlkeCwgY2VsbCkgaW4gY2YuY2VsbHNcIlxcblxcdFxcdG5nLXN0eWxlPVwie1xcJ2xlZnRcXCc6IGNlbGwuY29sKjYwICsgXFwncHhcXCcsIFxcJ3RvcFxcJzogY2VsbC5yb3cqNjAgKyBcXCdweFxcJ31cIlxcblxcdFxcdG5nLWNsaWNrPVwiY2YuY2VsbENMaWNrKCRldmVudCwgY2VsbCwgaWR4KVwiPlxcblxcblxcdFxcdDxkci1jZWxsIHR5cGU9XCJ7e2NlbGwudHlwZX19XCIgc3RhdGU9XCJ7e2NlbGwuc3RhdGV9fVwiPjwvZHItY2VsbD5cXG5cXG5cXHQ8L2xpPlxcbjwvdWw+Jyk7XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignbWFpbkN0cmwnLCBtYWluQ3RybCk7XG5cblx0ZnVuY3Rpb24gbWFpbkN0cmwoJHNjb3BlLCAkaHR0cCwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICR0aW1lb3V0KSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuXG5cdFx0dGhpcy5jZWxsU3RhdGUgPSAnc3F1YXJlJztcblxuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7fTtcblxuXHRtYWluQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGh0dHAnLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsICckdGltZW91dCddO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZSgnZHJDZWxsJywgWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xuXHRcdGZ1bmN0aW9uIGRyQ2VsbExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdGltZW91dCkge31cblxuXHRcdHJldHVybiB7XG5cdFx0XHRsaW5rOiBkckNlbGxMaW5rLFxuXHRcdFx0cmVzdHJpY3Q6ICdBRUMnLFxuXHRcdFx0c2NvcGU6IHt9LFxuXHRcdFx0dGVtcGxhdGU6ICR0ZW1wbGF0ZUNhY2hlLmdldCgnZHJDZWxsL2RyQ2VsbC5odG1sJyksXG5cdFx0XHRjb250cm9sbGVyOiBkckNlbGxDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnYycsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdHR5cGU6ICdAPycsXG5cdFx0XHRcdHN0YXRlOiAnQD8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuXG5cdHZhciBkckNlbGxDdHJsID0gZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyQ2VsbEN0cmwoJHNjb3BlLCAkdGltZW91dCkge1xuXHRcdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIGRyQ2VsbEN0cmwpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvdCwINCy0YzRjtGF0LUsINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCIGNzcy3QutC70LDRgdGB0Ysg0LTQu9GPINGC0LjQv9CwINC4INGB0L7RgdGC0L7Rj9C90LjRjyDRj9GH0LXQudC60LhcbiAgICovXG5cblxuXHRcdF9jcmVhdGVDbGFzcyhkckNlbGxDdHJsLCBbe1xuXHRcdFx0a2V5OiAncmV0dXJuQ2VsbENsYXNzJyxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiByZXR1cm5DZWxsQ2xhc3MoKSB7XG5cdFx0XHRcdHZhciB0eXBlID0gJ2NlbGxfdHlwZS0nICsgKHRoaXMudHlwZSB8fCAnc3F1YXJlJyk7XG5cdFx0XHRcdHZhciBzdGF0ZSA9ICdjZWxsX3N0YXRlLScgKyAodGhpcy5zdGF0ZSB8fCAnZGVmYXVsdCcpO1xuXG5cdFx0XHRcdHJldHVybiBbdHlwZSwgc3RhdGVdO1xuXHRcdFx0fVxuXHRcdH1dKTtcblxuXHRcdHJldHVybiBkckNlbGxDdHJsO1xuXHR9KCk7XG5cblx0ZHJDZWxsQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHRpbWVvdXQnXTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ2RyRmllbGQnLCBbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XG5cdFx0ZnVuY3Rpb24gZHJGaWVsZExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdGltZW91dCkge31cblxuXHRcdHJldHVybiB7XG5cdFx0XHRsaW5rOiBkckZpZWxkTGluayxcblx0XHRcdHJlc3RyaWN0OiAnQUVDJyxcblx0XHRcdHNjb3BlOiB7fSxcblx0XHRcdHRlbXBsYXRlOiAkdGVtcGxhdGVDYWNoZS5nZXQoJ2RyRmllbGQvZHJGaWVsZC5odG1sJyksXG5cdFx0XHRjb250cm9sbGVyOiBkckZpZWxkQ3RybCxcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NmJyxcblx0XHRcdGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0XHRcdFx0Y2VsbENsaWNrOiAnPT8nLFxuXHRcdFx0XHRzaXplOiAnPT8nLFxuXHRcdFx0XHRjdHg6ICc9Pydcblx0XHRcdH1cblx0XHR9O1xuXHR9XSk7XG5cblx0dmFyIGRyRmllbGRDdHJsID0gZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyRmllbGRDdHJsKGRyRmllbGRTZXJ2aWNlKSB7XG5cdFx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgZHJGaWVsZEN0cmwpO1xuXG5cdFx0XHR0aGlzLmRyRmllbGRTZXJ2aWNlID0gZHJGaWVsZFNlcnZpY2U7XG5cblx0XHRcdHRoaXMuaW5pdCgpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQn9GA0Lgg0LjQvdGG0LjQsNC70LjQt9Cw0YbQuNC4INGB0L7Qt9C00LDQtdC8INC80LDRgdGB0LjQslxuICAgKi9cblxuXG5cdFx0X2NyZWF0ZUNsYXNzKGRyRmllbGRDdHJsLCBbe1xuXHRcdFx0a2V5OiAnaW5pdCcsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcblx0XHRcdFx0dGhpcy5jZWxscyA9IHRoaXMuZHJGaWVsZFNlcnZpY2UuY3JlYXRlTmV3QXJyKHRoaXMuc2l6ZSk7XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuICAgICog0JrQu9C40Log0L/QviDRj9GH0LXQudC60LVcbiAgICAqID09INGB0L7QsdGL0YLQuNC1LCDRj9GH0LXQudC60LAsINC40L3QtNC10LrRgSDQsiDQvNCw0YHRgdC40LLQtSA9PVxuICAgICovXG5cblx0XHR9LCB7XG5cdFx0XHRrZXk6ICdjZWxsQ0xpY2snLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIGNlbGxDTGljayhlLCBjZWxsLCBpZHgpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRcdGlmICghdGhpcy5hY3RpdmVDZWxsKSB0aGlzLmFjdGl2ZUNlbGwgPSBjZWxsO1xuXG5cdFx0XHRcdHZhciBzdGF0ZSA9IHZvaWQgMCxcblx0XHRcdFx0ICAgIGN1cnJlbnRTdGF0ZSA9IHZvaWQgMDtcblxuXHRcdFx0XHRpZiAoY2VsbC5zdGF0ZSA9PT0gJ3Bhc3NpdmUnKSB7XG5cdFx0XHRcdFx0dmFyIGNvb3Jkc18xID0geyBjb2w6IHRoaXMuYWN0aXZlQ2VsbC5jb2wsIHJvdzogdGhpcy5hY3RpdmVDZWxsLnJvdyB9O1xuXHRcdFx0XHRcdHZhciBjb29yZHNfMiA9IHsgY29sOiBjZWxsLmNvbCwgcm93OiBjZWxsLnJvdyB9O1xuXG5cdFx0XHRcdFx0dGhpcy5hY3RpdmVDZWxsLmNvbCA9IGNvb3Jkc18yLmNvbDtcblx0XHRcdFx0XHR0aGlzLmFjdGl2ZUNlbGwucm93ID0gY29vcmRzXzIucm93O1xuXG5cdFx0XHRcdFx0Y2VsbC5jb2wgPSBjb29yZHNfMS5jb2w7XG5cdFx0XHRcdFx0Y2VsbC5yb3cgPSBjb29yZHNfMS5yb3c7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHRoaXMuYWN0aXZlQ2VsbCA9PSB0aGlzLmNlbGxzW2lkeF0pIHtcblx0XHRcdFx0XHQvLyDQmtC70LjQuiDQv9C+INGC0L7QuSDQttC1INGP0YfQtdC50LrQtSwg0LzQtdC90Y/QtdC8INGB0L7RgdGC0L7Rj9C90LjQtSDQvdCwINC/0YDQvtGC0LjQstC+0L/QvtC70L7QttC90L7QtVxuXHRcdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbC5zdGF0ZSA9IHRoaXMuYWN0aXZlQ2VsbC5zdGF0ZSA9PT0gJ2FjdGl2ZScgPyAnZGVmYXVsdCcgOiAnYWN0aXZlJztcblx0XHRcdFx0XHRjdXJyZW50U3RhdGUgPSB0aGlzLmFjdGl2ZUNlbGwuc3RhdGUgPT09ICdhY3RpdmUnO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vINCa0LvQuNC6INC/0L4g0LTRgNGD0LPQvtC5INGP0YfQtdC50LrQtVxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jZWxscy5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jZWxsc1tpXS5zdGF0ZSA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHR9Y2VsbC5zdGF0ZSA9ICdhY3RpdmUnO1xuXHRcdFx0XHRcdGN1cnJlbnRTdGF0ZSA9IGNlbGwuc3RhdGUgPT09ICdhY3RpdmUnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c3RhdGUgPSBjdXJyZW50U3RhdGUgPyAncGFzc2l2ZScgOiAnZGVmYXVsdCc7XG5cdFx0XHRcdHRoaXMuZHJGaWVsZFNlcnZpY2UubWFya0Nsb3Nlc3RDZWxsKHRoaXMuY2VsbHMsIHRoaXMuc2l6ZSwgaWR4LCBzdGF0ZSk7XG5cdFx0XHRcdHRoaXMuYWN0aXZlQ2VsbCA9IGNlbGw7XG5cdFx0XHR9XG5cdFx0fV0pO1xuXG5cdFx0cmV0dXJuIGRyRmllbGRDdHJsO1xuXHR9KCk7XG5cblx0ZHJGaWVsZEN0cmwuJGluamVjdCA9IFsnZHJGaWVsZFNlcnZpY2UnXTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5zZXJ2aWNlKCdkckZpZWxkU2VydmljZScsIFsnZHJGaWxlZEZhY3RvcnknLCBmdW5jdGlvbiAoZHJGaWxlZEZhY3RvcnkpIHtcblx0XHQvKipcbiAgICog0JLQvtC30LLRgNCw0YnQsNC10Lwg0YDQsNC90LTQvtC80L3Ri9C5INGN0LvQtdC80LXQvdGCINC80LDRgdGB0LjQstCwXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHJldHVyblJhbmRFbGVtZW50KGFycikge1xuXHRcdFx0dmFyIGlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFyci5sZW5ndGgpO1xuXHRcdFx0cmV0dXJuIGFycltpZHhdO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQktC+0LfQstGA0LDRidCw0LXQvCDRgNCw0L3QtNC+0LzQvdGL0Lkg0Y3Qu9C10LzQtdC90YIg0LzQsNGB0YHQuNCy0LAsINC40YHQutC70Y7Rh9Cw0Y8g0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LIg0YTRg9C90LrRhtC40Y5cbiAgICovXG5cdFx0ZnVuY3Rpb24gcmV0dXJuQW5vdGhlclR5cGUodHlwZSkge1xuXHRcdFx0dmFyIG5ld0FyciA9IGFuZ3VsYXIuY29weShkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbmV3QXJyLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdGlmIChuZXdBcnJbaV0gPT09IHR5cGUpIG5ld0Fyci5zcGxpY2UoaSwgMSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXR1cm5SYW5kRWxlbWVudChuZXdBcnIpO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQpNGD0L3QutGG0LjRjyDQv9GA0L7RgdGC0LDQstC70Y/QtdGCINGN0LvQtdC80LXQvdGC0YvQvCDQvNCw0YHRgdC40LLQsCDQutC+0L7RgNC00LjQvdCw0YLRiyAo0L/QvtC70Y8gXCJjb2xcIiwgXCJyb3dcIikg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCXG4gICAqINCy0YLQvtGA0L7Qs9C+INC/0LDRgNCw0LzQtdGC0YDQsCBzaXplICjRiNC40YDQuNC90LAg0LzQsNGB0YHQuNCy0LApXG4gICAqL1xuXHRcdGZ1bmN0aW9uIHNldENvb3Jkc1RvRWxlbWVudHMoYXJyLCBzaXplKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRhcnJbaV0uY29sID0gaSAlIHNpemU7XG5cdFx0XHRcdGFycltpXS5yb3cgPSBNYXRoLmZsb29yKGkgLyBzaXplKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvKipcbiAgICog0KTRg9C90LrRhtC40Y8g0L/RgNC40L3QuNC80LDQtdGCINC80LDRgdGB0LjQsiwg0LIg0LrQvtGC0L7RgNGL0Lkg0LTQvtCx0LDQstC70Y/QtdGCINC90L7QstGL0Lkg0Y3Qu9C10LzQtdC90YIuXG4gICAqINCf0YDQuCDQtNC+0LHQsNCy0LvQtdC90LjQuCDQstGL0L/QvtC70L3Rj9C10YIg0LTQstC1INC/0YDQvtCy0LXRgNC60Lg6XG4gICAqIC0g0LXRgdC70Lgg0YLQuNC/0Ysg0LTQstGD0YUg0L/RgNC10LTRi9C00YPRidC40YUg0L7QsdGK0LXQutGCINGA0LDQstC90Ysg0YLQtdC60YPRidC10LzRgyDRgdCz0LXQvdC10YDQuNGA0L7QstCw0L3QvdC+0LzRgyDRgtC40L/Rgywg0YLQviDQs9C10L3QtdGA0LjRgNGD0LXQvCDQvdC+0LLRi9C5XG4gICAqIC0g0LXRgdC70Lgg0YLQuNC/0Ysg0LTQstGD0YUg0L7QsdGK0LXQutGC0L7QsiDQvdCw0LQg0YLQtdC60YPQt9C40Lwg0YDQsNCy0L3RiyDRgtC10LrRg9GJ0LXQvNGDINGB0LPQtdC90LXRgNC40YDQvtCy0LDQvdC90L7QvNGDINGC0LjQv9GDLCDRgtC+INCz0LXQvdC10YDQuNGA0YPQtdC8INC90L7QstGL0LlcbiAgICogQHBhcmFtIGFyclxuICAgKi9cblx0XHRmdW5jdGlvbiBjcmVhdGVFbGVtZW50KGFyciwgc2l6ZSkge1xuXHRcdFx0dmFyIHR5cGUgPSByZXR1cm5SYW5kRWxlbWVudChkckZpbGVkRmFjdG9yeS50eXBlcyk7XG5cblx0XHRcdGlmIChhcnJbYXJyLmxlbmd0aCAtIDFdICYmIGFyclthcnIubGVuZ3RoIC0gMl0gJiYgYXJyW2Fyci5sZW5ndGggLSAxXS50eXBlID09PSB0eXBlICYmIGFyclthcnIubGVuZ3RoIC0gMl0udHlwZSA9PT0gdHlwZSkge1xuXHRcdFx0XHR0eXBlID0gcmV0dXJuQW5vdGhlclR5cGUodHlwZSk7XG5cdFx0XHR9IGVsc2UgaWYgKGFyclthcnIubGVuZ3RoIC0gc2l6ZV0gJiYgYXJyW2Fyci5sZW5ndGggLSBzaXplICogMl0gJiYgYXJyW2Fyci5sZW5ndGggLSBzaXplXS50eXBlID09PSB0eXBlICYmIGFyclthcnIubGVuZ3RoIC0gc2l6ZSAqIDJdLnR5cGUgPT09IHR5cGUpIHtcblx0XHRcdFx0dHlwZSA9IHJldHVybkFub3RoZXJUeXBlKHR5cGUpO1xuXHRcdFx0fVxuXG5cdFx0XHRhcnIucHVzaCh7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdHN0YXRlOiAnZGVmYXVsdCdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qKlxuICAgKiDQnNC10YLQvtC0INGB0LXRgNCy0LjRgdCwINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCINC90L7QstGL0Lkg0LzQsNGB0YHQuNCyINC00LvQuNC90L7QuSBzaXplKnNpemVcbiAgICovXG5cdFx0dGhpcy5jcmVhdGVOZXdBcnIgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXHRcdFx0dmFyIGFyciA9IFtdO1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNpemUgKiBzaXplOyBpKyspIHtcblx0XHRcdFx0Y3JlYXRlRWxlbWVudChhcnIsIHNpemUpO1xuXHRcdFx0fVxuXG5cdFx0XHRzZXRDb29yZHNUb0VsZW1lbnRzKGFyciwgc2l6ZSk7XG5cblx0XHRcdHJldHVybiBhcnI7XG5cdFx0fTtcblxuXHRcdHRoaXMubWFya0Nsb3Nlc3RDZWxsID0gZnVuY3Rpb24gKGFyciwgc2l6ZSwgaWR4LCBzdGF0ZSkge1xuXHRcdFx0aWYgKGFycltpZHggLSBzaXplXSkgYXJyW2lkeCAtIHNpemVdLnN0YXRlID0gc3RhdGU7XG5cdFx0XHRpZiAoYXJyW2lkeCArIHNpemVdKSBhcnJbaWR4ICsgc2l6ZV0uc3RhdGUgPSBzdGF0ZTtcblx0XHRcdGlmIChhcnJbaWR4IC0gMV0pIGFycltpZHggLSAxXS5zdGF0ZSA9IHN0YXRlO1xuXHRcdFx0aWYgKGFycltpZHggKyAxXSkgYXJyW2lkeCArIDFdLnN0YXRlID0gc3RhdGU7XG5cdFx0fTtcblx0fV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2RyRmlsZWRGYWN0b3J5JywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciB0eXBlcyA9IFsnc3F1YXJlJywgJ2NpcmNsZScsICd0cmlhbmdsZSddO1xuXG5cdFx0dmFyIHN0YXRlcyA9IFsnZGVmYXVsdCcsICdhY3RpdmUnLCAncGFzc2l2ZScsICdub3RlJ107XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZXM6IHR5cGVzLFxuXHRcdFx0c3RhdGVzOiBzdGF0ZXNcblx0XHR9O1xuXHR9KTtcbn0pKCk7Il19
